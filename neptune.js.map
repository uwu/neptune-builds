{"version":3,"file":"neptune.js","sources":["../node_modules/.pnpm/spitroast@1.4.3/node_modules/spitroast/dist/esm/shared.js","../node_modules/.pnpm/spitroast@1.4.3/node_modules/spitroast/dist/esm/unpatch.js","../node_modules/.pnpm/spitroast@1.4.3/node_modules/spitroast/dist/esm/getPatchFunc.js","../node_modules/.pnpm/spitroast@1.4.3/node_modules/spitroast/dist/esm/hook.js","../node_modules/.pnpm/spitroast@1.4.3/node_modules/spitroast/dist/esm/index.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/methods/is_server.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/symbols.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/utils.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/objects/callable.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/constants.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/lazy.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/objects/owner.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/objects/superroot.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/context.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/batch.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/is_observable_frozen.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/is_untracked.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/objects/scheduler.sync.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/objects/observable.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/objects/observables.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/objects/observer.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/objects/memo.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/memo.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/boolean.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/cleanup.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/objects/context.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/context.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/disposed.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/objects/scheduler.async.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/objects/effect.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/effect.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/resolve.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/objects/root.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/for.cache.keyed.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/is_observable.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/get.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/objects/suspense.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/suspense.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/for.cache.unkeyed.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/is_store.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/untrack.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/warmup.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/switch.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/ternary.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/is_batching.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/observable.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/is_observable_writable.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/target.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/readonly.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/root.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/selector.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/store.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/suspended.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/tick.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/try_catch.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/untracked.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/with.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/constants.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/methods/wrap_element.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/utils/creators.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/utils/lang.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_resolved.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_event_listener.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_abort_controller.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_abort_signal.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_scheduler.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_animation_frame.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_animation_loop.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/components/suspense.context.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/components/suspense.manager.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_render_effect.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_resource.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_fetch.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_idle_callback.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_idle_loop.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_interval.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_promise.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_timeout.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_cheap_disposed.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_microtask.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/utils/classlist.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/utils/diff.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/utils/fragment.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/utils/resolvers.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/utils/setters.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/methods/create_element.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/components/dynamic.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/components/error_boundary.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/components/for.js","../node_modules/.pnpm/oby@14.3.0/node_modules/oby/dist/methods/for.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/components/fragment.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_guarded.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/components/if.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/components/keep_alive.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/methods/render.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/components/portal.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/components/suspense.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/components/switch.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/components/ternary.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/jsx/runtime.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/methods/create_directive.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/methods/hmr.js","../node_modules/.pnpm/htm@3.1.1/node_modules/htm/dist/htm.module.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/methods/html.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/methods/lazy.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/methods/render_to_string.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/methods/template.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/methods/create_context.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/methods/h.js","../node_modules/.pnpm/voby@0.54.0/node_modules/voby/dist/hooks/use_context.js","../src/ui/components.js","../node_modules/.pnpm/idb-keyval@6.2.1/node_modules/idb-keyval/dist/index.js","../src/api/utils.js","../node_modules/.pnpm/es-module-lexer@1.3.0/node_modules/es-module-lexer/dist/lexer.js","../node_modules/.pnpm/@uwu+quartz@1.3.7/node_modules/@uwu/quartz/index.js","../node_modules/.pnpm/quartz-plugin-url-import@1.0.1/node_modules/quartz-plugin-url-import/index.js","../src/api/plugins.js","../src/api/intercept.js","../src/api/observe.js","../src/api/registerRoute.js","../src/api/registerTab.js","../src/api/hookContextMenu.js","../src/api/showModal.js","../src/windowObject.js","../src/handleExfiltrations.js","../src/styles.js","../src/ui/pluginsTab.js","../src/ui/settings.js","../src/index.js"],"sourcesContent":["// we use this array multiple times\nexport const patchTypes = [\"a\", \"b\", \"i\"];\nexport const patchedObjects = new Map();\n","import { patchedObjects, patchTypes } from \"./shared.js\";\nexport function unpatch(funcParent, funcName, hookId, type) {\n    const patchedObject = patchedObjects.get(funcParent);\n    const patch = patchedObject?.[funcName];\n    if (!patch?.[type].has(hookId))\n        return false;\n    patch[type].delete(hookId);\n    // If there are no more hooks for every type, remove the patch\n    if (patchTypes.every((t) => patch[t].size === 0)) {\n        // reflect defineproperty is like object defineproperty\n        // but instead of erroring it returns if it worked or not.\n        // this is more easily minifiable, hence its use. -- sink\n        const success = Reflect.defineProperty(funcParent, funcName, {\n            value: patch.o,\n            writable: true,\n            configurable: true,\n        });\n        if (!success)\n            funcParent[funcName] = patch.o;\n        delete patchedObject[funcName];\n    }\n    if (Object.keys(patchedObject).length == 0)\n        patchedObjects.delete(funcParent);\n    return true;\n}\nexport function unpatchAll() {\n    for (const [parentObject, patchedObject] of patchedObjects.entries())\n        for (const funcName in patchedObject)\n            for (const hookType of patchTypes)\n                for (const hookId of patchedObject[funcName]?.[hookType].keys() ?? [])\n                    unpatch(parentObject, funcName, hookId, hookType);\n}\n","// curried - getPatchFunc(\"before\")(...)\n// allows us to apply an argument while leaving the rest open much cleaner.\n// functional programming strikes again! -- sink\nimport hook from \"./hook.js\";\nimport { patchedObjects } from \"./shared.js\";\nimport { unpatch } from \"./unpatch.js\";\n// creates a hook if needed, else just adds one to the patches array\nexport default (patchType) => (funcName, funcParent, callback, oneTime = false) => {\n    if (typeof funcParent[funcName] !== \"function\")\n        throw new Error(`${funcName} is not a function in ${funcParent.constructor.name}`);\n    if (!patchedObjects.has(funcParent))\n        patchedObjects.set(funcParent, {});\n    const parentInjections = patchedObjects.get(funcParent);\n    if (!parentInjections[funcName]) {\n        const origFunc = funcParent[funcName];\n        // note to future me optimising for size: extracting new Map() to a func increases size --sink\n        parentInjections[funcName] = {\n            o: origFunc,\n            b: new Map(),\n            i: new Map(),\n            a: new Map(),\n        };\n        const runHook = (ctxt, args, construct) => {\n            const ret = hook(funcName, funcParent, args, ctxt, construct);\n            if (oneTime)\n                unpatchThisPatch();\n            return ret;\n        };\n        const replaceProxy = new Proxy(origFunc, {\n            apply: (_, ctxt, args) => runHook(ctxt, args, false),\n            construct: (_, args) => runHook(origFunc, args, true),\n            get: (target, prop, receiver) => prop == \"toString\"\n                ? origFunc.toString.bind(origFunc)\n                : Reflect.get(target, prop, receiver),\n        });\n        // this works around breaking some async find implementation which listens for assigns via proxy\n        // see comment in unpatch.ts\n        const success = Reflect.defineProperty(funcParent, funcName, {\n            value: replaceProxy,\n            configurable: true,\n            writable: true,\n        });\n        if (!success)\n            funcParent[funcName] = replaceProxy;\n    }\n    const hookId = Symbol();\n    const unpatchThisPatch = () => unpatch(funcParent, funcName, hookId, patchType);\n    parentInjections[funcName][patchType].set(hookId, callback);\n    return unpatchThisPatch;\n};\n","// calls relevant patches and returns the final result\nimport { patchedObjects } from \"./shared.js\";\nexport default function (funcName, funcParent, funcArgs, \n// the value of `this` to apply\nctxt, \n// if true, the function is actually constructor\nisConstruct) {\n    const patch = patchedObjects.get(funcParent)?.[funcName];\n    // This is in the event that this function is being called after all patches are removed.\n    if (!patch)\n        return isConstruct\n            ? Reflect.construct(funcParent[funcName], funcArgs, ctxt)\n            : funcParent[funcName].apply(ctxt, funcArgs);\n    // Before patches\n    for (const hook of patch.b.values()) {\n        const maybefuncArgs = hook.call(ctxt, funcArgs);\n        if (Array.isArray(maybefuncArgs))\n            funcArgs = maybefuncArgs;\n    }\n    // Instead patches\n    let workingRetVal = [...patch.i.values()].reduce((prev, current) => (...args) => current.call(ctxt, args, prev), \n    // This calls the original function\n    (...args) => isConstruct\n        ? Reflect.construct(patch.o, args, ctxt)\n        : patch.o.apply(ctxt, args))(...funcArgs);\n    // After patches\n    for (const hook of patch.a.values())\n        workingRetVal = hook.call(ctxt, funcArgs, workingRetVal) ?? workingRetVal;\n    return workingRetVal;\n}\n","import getPatchFunc from \"./getPatchFunc.js\";\nimport { unpatchAll } from \"./unpatch.js\";\nconst before = getPatchFunc(\"b\");\nconst instead = getPatchFunc(\"i\");\nconst after = getPatchFunc(\"a\");\nexport { instead, before, after, unpatchAll };\n","/* HELPERS */\nconst IS_BROWSER = !!globalThis.CDATASection?.toString?.().match(/^\\s*function\\s+CDATASection\\s*\\(\\s*\\)\\s*\\{\\s*\\[native code\\]\\s*\\}\\s*$/);\n/* MAIN */\nconst isServer = () => {\n    return !IS_BROWSER;\n};\n/* EXPORT */\nexport default isServer;\n","/* MAIN */\nconst SYMBOL_CACHED = Symbol('Cached');\nconst SYMBOL_OBSERVABLE = Symbol('Observable');\nconst SYMBOL_OBSERVABLE_FROZEN = Symbol('Observable.Frozen');\nconst SYMBOL_OBSERVABLE_READABLE = Symbol('Observable.Readable');\nconst SYMBOL_OBSERVABLE_WRITABLE = Symbol('Observable.Writable');\nconst SYMBOL_STORE = Symbol('Store');\nconst SYMBOL_STORE_KEYS = Symbol('Store.Keys');\nconst SYMBOL_STORE_OBSERVABLE = Symbol('Store.Observable');\nconst SYMBOL_STORE_TARGET = Symbol('Store.Target');\nconst SYMBOL_STORE_VALUES = Symbol('Store.Values');\nconst SYMBOL_STORE_UNTRACKED = Symbol('Store.Untracked');\nconst SYMBOL_SUSPENSE = Symbol('Suspense');\nconst SYMBOL_UNCACHED = Symbol('Uncached');\nconst SYMBOL_UNTRACKED = Symbol('Untracked');\nconst SYMBOL_UNTRACKED_UNWRAPPED = Symbol('Untracked.Unwrapped');\n/* EXPORT */\nexport { SYMBOL_CACHED, SYMBOL_OBSERVABLE, SYMBOL_OBSERVABLE_FROZEN, SYMBOL_OBSERVABLE_READABLE, SYMBOL_OBSERVABLE_WRITABLE, SYMBOL_STORE, SYMBOL_STORE_KEYS, SYMBOL_STORE_OBSERVABLE, SYMBOL_STORE_TARGET, SYMBOL_STORE_VALUES, SYMBOL_STORE_UNTRACKED, SYMBOL_SUSPENSE, SYMBOL_UNCACHED, SYMBOL_UNTRACKED, SYMBOL_UNTRACKED_UNWRAPPED };\n","/* MAIN */\nconst castArray = (value) => {\n    return isArray(value) ? value : [value];\n};\nconst castError = (error) => {\n    if (error instanceof Error)\n        return error;\n    if (typeof error === 'string')\n        return new Error(error);\n    return new Error('Unknown error');\n};\nconst { is } = Object;\nconst { isArray } = Array;\nconst isEqual = (a, b) => {\n    if (a.length !== b.length)\n        return false;\n    for (let i = 0, l = a.length; i < l; i++) {\n        const valueA = a[i];\n        const valueB = b[i];\n        if (!is(valueA, valueB))\n            return false;\n    }\n    return true;\n};\nconst isFunction = (value) => {\n    return typeof value === 'function';\n};\nconst isObject = (value) => {\n    return (value !== null) && (typeof value === 'object');\n};\nconst isSymbol = (value) => {\n    return typeof value === 'symbol';\n};\nconst noop = () => {\n    return;\n};\nconst nope = () => {\n    return false;\n};\n/* EXPORT */\nexport { castArray, castError, is, isArray, isEqual, isFunction, isObject, isSymbol, noop, nope };\n","/* IMPORT */\nimport { SYMBOL_OBSERVABLE, SYMBOL_OBSERVABLE_FROZEN, SYMBOL_OBSERVABLE_READABLE, SYMBOL_OBSERVABLE_WRITABLE } from '../symbols.js';\nimport { isFunction } from '../utils.js';\n/* MAIN - FUNCTIONS */\nfunction frozenFunction() {\n    if (arguments.length) {\n        throw new Error('A readonly Observable can not be updated');\n    }\n    else {\n        return this;\n    }\n}\nfunction readableFunction() {\n    if (arguments.length) {\n        throw new Error('A readonly Observable can not be updated');\n    }\n    else {\n        return this.get();\n    }\n}\nfunction writableFunction(fn) {\n    if (arguments.length) {\n        if (isFunction(fn)) {\n            return this.C(fn);\n        }\n        else {\n            return this.set(fn); //TSC\n        }\n    }\n    else {\n        return this.get();\n    }\n}\n/* MAIN - GENERATORS */\nconst frozen = (value) => {\n    const fn = frozenFunction.bind(value); //TSC\n    fn[SYMBOL_OBSERVABLE] = true;\n    fn[SYMBOL_OBSERVABLE_FROZEN] = true;\n    return fn;\n};\nconst readable = (value) => {\n    //TODO: Make a frozen one instead if disposed\n    const fn = readableFunction.bind(value); //TSC\n    fn[SYMBOL_OBSERVABLE] = true;\n    fn[SYMBOL_OBSERVABLE_READABLE] = value;\n    return fn;\n};\nconst writable = (value) => {\n    const fn = writableFunction.bind(value); //TSC\n    fn[SYMBOL_OBSERVABLE] = true;\n    fn[SYMBOL_OBSERVABLE_WRITABLE] = value;\n    return fn;\n};\n/* EXPORT */\nexport { frozen, readable, writable };\n","/* IMPORT */\nimport { frozen } from './objects/callable.js';\n/* MAIN */\nconst DIRTY_NO = 0; // The observer is not dirty, for sure\nconst DIRTY_MAYBE_NO = 1; // The observer is not dirty, possibly\nconst DIRTY_MAYBE_YES = 2; // The observer is dirty, possibly\nconst DIRTY_YES = 3; // The observer is dirty, for sure\nconst OBSERVABLE_FALSE = frozen(false);\nconst OBSERVABLE_TRUE = frozen(true);\nconst UNAVAILABLE = new Proxy({}, new Proxy({}, { get() { throw new Error('Unavailable value'); } })); //TSC\nconst UNINITIALIZED = function () { }; //TSC\n/* EXPORT */\nexport { DIRTY_NO, DIRTY_MAYBE_NO, DIRTY_MAYBE_YES, DIRTY_YES };\nexport { OBSERVABLE_FALSE, OBSERVABLE_TRUE };\nexport { UNAVAILABLE, UNINITIALIZED };\n","/* IMPORT */\n/* MAIN */\nconst lazyArrayEach = (arr, fn) => {\n    if (arr instanceof Array) {\n        for (let i = 0, l = arr.length; i < l; i++) {\n            fn(arr[i]);\n        }\n    }\n    else if (arr) {\n        fn(arr);\n    }\n};\nconst lazyArrayEachRight = (arr, fn) => {\n    if (arr instanceof Array) {\n        for (let i = arr.length - 1; i >= 0; i--) {\n            fn(arr[i]);\n        }\n    }\n    else if (arr) {\n        fn(arr);\n    }\n};\nconst lazyArrayPush = (obj, key, value) => {\n    const arr = obj[key];\n    if (arr instanceof Array) {\n        arr.push(value);\n    }\n    else if (arr) {\n        obj[key] = [arr, value];\n    }\n    else {\n        obj[key] = value;\n    }\n};\nconst lazySetAdd = (obj, key, value) => {\n    const set = obj[key];\n    if (set instanceof Set) {\n        set.add(value);\n    }\n    else if (set) {\n        if (value !== set) {\n            const s = new Set();\n            s.add(set);\n            s.add(value);\n            obj[key] = s;\n        }\n    }\n    else {\n        obj[key] = value;\n    }\n};\nconst lazySetDelete = (obj, key, value) => {\n    const set = obj[key];\n    if (set instanceof Set) {\n        set.delete(value);\n    }\n    else if (set === value) {\n        obj[key] = undefined;\n    }\n};\nconst lazySetEach = (set, fn) => {\n    if (set instanceof Set) {\n        for (const value of set) {\n            fn(value);\n        }\n    }\n    else if (set) {\n        fn(set);\n    }\n};\n/* EXPORT */\nexport { lazyArrayEach, lazyArrayEachRight, lazyArrayPush };\nexport { lazySetAdd, lazySetDelete, lazySetEach };\n","/* IMPORT */\nimport { UNAVAILABLE } from '../constants.js';\nimport { OBSERVER, OWNER, setObserver, setOwner } from '../context.js';\nimport { lazyArrayEachRight } from '../lazy.js';\nimport { castError } from '../utils.js';\n/* HELPERS */\nconst onCleanup = (cleanup) => cleanup.call(cleanup);\nconst onDispose = (owner) => owner.Q(true);\n/* MAIN */\n//TODO: Throw when registering stuff O disposing, maybe\nclass Owner {\n    constructor() {\n        /* VARIABLES */\n        this.disposed = false;\n        this.B = undefined;\n        this.S = undefined;\n        this.D = undefined;\n        this.K = undefined;\n        this.T = undefined;\n        this.U = undefined;\n    }\n    /* API */\n    catch(error, silent) {\n        const { S } = this;\n        if (S) {\n            S(error); //TODO: This assumes that the error handler won't throw immediately, which we know, but Owner shouldn't know\n            return true;\n        }\n        else {\n            if (this.parent?.catch(error, true))\n                return true;\n            if (silent)\n                return false;\n            // console.error ( error.stack ); // <-- Log \"error.stack\" to better understand where the error happened\n            throw error;\n        }\n    }\n    Q(deep) {\n        lazyArrayEachRight(this.D, onDispose);\n        lazyArrayEachRight(this.K, onDispose);\n        lazyArrayEachRight(this.U, onDispose);\n        lazyArrayEachRight(this.B, onCleanup);\n        this.B = undefined;\n        this.disposed = deep;\n        this.S = undefined;\n        this.K = undefined;\n        this.U = undefined;\n    }\n    get(symbol) {\n        return this.context?.[symbol];\n    }\n    E(fn, owner, observer) {\n        const ownerPrev = OWNER;\n        const observerPrev = OBSERVER;\n        setOwner(owner);\n        setObserver(observer);\n        try {\n            return fn();\n        }\n        catch (error) {\n            this.catch(castError(error), false); // Bubbling the error up\n            return UNAVAILABLE; // Returning a value that is the least likely to cause bugs\n        }\n        finally {\n            setOwner(ownerPrev);\n            setObserver(observerPrev);\n        }\n    }\n}\n/* EXPORT */\nexport default Owner;\n","/* IMPORT */\nimport Owner from './owner.js';\n/* MAIN */\nclass SuperRoot extends Owner {\n    constructor() {\n        /* VARIABLES */\n        super(...arguments);\n        this.context = {};\n    }\n}\n/* EXPORT */\nexport default SuperRoot;\n","/* IMPORT */\nimport SuperRoot from './objects/superroot.js';\n/* MAIN - READ */\n// This module relies on live-binding of exported variables to avoid a bunch of property accesses\nlet BATCH;\nlet SUPER_OWNER = new SuperRoot();\nlet OBSERVER;\nlet OWNER = SUPER_OWNER;\n/* MAIN - WRITE */\n// Unfortunately live-bounded exports can't just be overridden, so we need these functions\nconst setBatch = (value) => BATCH = value;\nconst setObserver = (value) => OBSERVER = value;\nconst setOwner = (value) => OWNER = value;\n/* EXPORT */\nexport { BATCH, OBSERVER, OWNER, SUPER_OWNER };\nexport { setBatch, setObserver, setOwner };\n","/* IMPORT */\nimport { setBatch } from '../context.js';\nimport { noop } from '../utils.js';\n/* HELPERS */\nlet M = 0;\nlet resolve = noop;\n/* MAIN */\nconst batch = async (fn) => {\n    if (!M) {\n        setBatch(new Promise(r => resolve = r));\n    }\n    try {\n        M += 1;\n        return await fn();\n    }\n    finally {\n        M -= 1;\n        if (!M) {\n            setBatch(undefined);\n            resolve();\n        }\n    }\n};\n/* MAIN */\nexport default batch;\n","/* IMPORT */\nimport { SYMBOL_OBSERVABLE_FROZEN, SYMBOL_OBSERVABLE_READABLE } from '../symbols.js';\nimport { isFunction } from '../utils.js';\n/* MAIN */\nconst isObservableFrozen = (value) => {\n    return isFunction(value) && ((SYMBOL_OBSERVABLE_FROZEN in value) || !!value[SYMBOL_OBSERVABLE_READABLE]?.parent?.disposed);\n};\n/* EXPORT */\nexport default isObservableFrozen;\n","/* IMPORT */\nimport { SYMBOL_UNTRACKED, SYMBOL_UNTRACKED_UNWRAPPED } from '../symbols.js';\nimport { isFunction } from '../utils.js';\n/* MAIN */\nconst isUntracked = (value) => {\n    return isFunction(value) && ((SYMBOL_UNTRACKED in value) || (SYMBOL_UNTRACKED_UNWRAPPED in value));\n};\n/* EXPORT */\nexport default isUntracked;\n","/* IMPORT */\n/* MAIN */\n// This ensures that there's only one flushing of the queue happening at the same time\nclass Scheduler {\n    constructor() {\n        /* VARIABLES */\n        this.A1 = [];\n        this.M = 0;\n        this.A2 = false;\n        /* QUEING API */\n        this.N = () => {\n            if (this.A2)\n                return;\n            if (this.M)\n                return;\n            if (!this.A1.length)\n                return;\n            try {\n                this.A2 = true;\n                while (true) {\n                    const queue = this.A1;\n                    if (!queue.length)\n                        break;\n                    this.A1 = [];\n                    for (let i = 0, l = queue.length; i < l; i++) {\n                        queue[i].C();\n                    }\n                }\n            }\n            finally {\n                this.A2 = false;\n            }\n        };\n        this.E = (fn) => {\n            this.M += 1;\n            fn();\n            this.M -= 1;\n            this.N();\n        };\n        /* SCHEDULING API */\n        this.F = (observer) => {\n            this.A1.push(observer);\n        };\n    }\n}\n/* EXPORT */\nexport default new Scheduler();\n","/* IMPORT */\nimport { DIRTY_MAYBE_NO, DIRTY_YES, UNINITIALIZED } from '../constants.js';\nimport { OBSERVER } from '../context.js';\nimport Scheduler from './scheduler.sync.js';\nimport { is, nope } from '../utils.js';\n/* MAIN */\nclass Observable {\n    /* CONSTRUCTOR */\n    constructor(value, options, parent) {\n        this.K = new Set();\n        this.value = value;\n        if (parent) {\n            this.parent = parent;\n        }\n        if (options?.equals !== undefined) {\n            this.equals = options.equals || nope;\n        }\n    }\n    /* API */\n    get() {\n        if (!this.parent?.disposed) {\n            this.parent?.C();\n            OBSERVER?.A.L(this);\n        }\n        return this.value;\n    }\n    set(value) {\n        const equals = this.equals || is;\n        const fresh = (this.value === UNINITIALIZED) || !equals(value, this.value);\n        if (!fresh)\n            return value;\n        this.value = value;\n        Scheduler.M += 1;\n        this.I(DIRTY_YES);\n        Scheduler.M -= 1;\n        Scheduler.N();\n        return value;\n    }\n    I(J) {\n        for (const observer of this.K) {\n            if (observer.J !== DIRTY_MAYBE_NO || observer.A.has(this)) { // Maybe this is a potential future dependency we haven't re-read yet\n                if (observer.sync) {\n                    observer.J = Math.max(observer.J, J);\n                    Scheduler.F(observer);\n                }\n                else {\n                    observer.I(J);\n                }\n            }\n        }\n    }\n    C(fn) {\n        const value = fn(this.value);\n        return this.set(value);\n    }\n}\n/* EXPORT */\nexport default Observable;\n","/* IMPORT */\n/* MAIN */\n// Dedicated data structures for managing A efficiently\n// We use an array if the list is small enough, as that's faster than a Set, and only switch to Sets O that\nclass ObservablesArray {\n    /* CONSTRUCTOR */\n    constructor(observer) {\n        this.observer = observer;\n        this.A = [];\n        this.P = 0;\n    }\n    /* API */\n    Q(deep) {\n        if (deep) {\n            const { observer, A } = this;\n            for (let i = 0; i < A.length; i++) {\n                A[i].K.delete(observer);\n            }\n        }\n        this.P = 0;\n    }\n    R() {\n        const { observer, A, P } = this;\n        const observablesLength = A.length;\n        if (P < observablesLength) {\n            for (let i = P; i < observablesLength; i++) {\n                A[i].K.delete(observer);\n            }\n            A.length = P;\n        }\n    }\n    empty() {\n        return !this.A.length;\n    }\n    has(observable) {\n        const index = this.A.indexOf(observable);\n        return index >= 0 && index < this.P;\n    }\n    L(observable) {\n        const { observer, A, P } = this;\n        const observablesLength = A.length;\n        if (observablesLength > 0) {\n            if (A[P] === observable) {\n                this.P += 1;\n                return;\n            }\n            const index = A.indexOf(observable);\n            if (index >= 0 && index < P) {\n                return;\n            }\n            if (P < observablesLength - 1) {\n                this.R();\n            }\n            else if (P === observablesLength - 1) {\n                A[P].K.delete(observer);\n            }\n        }\n        observable.K.add(observer);\n        A[this.P++] = observable;\n        if (P === 128) { // Switching to a Set, as indexOf checks may get artbirarily expensive otherwise\n            observer.A = new ObservablesSet(observer, A);\n        }\n    }\n    C() {\n        const { A } = this;\n        for (let i = 0, l = A.length; i < l; i++) {\n            A[i].parent?.C();\n        }\n    }\n}\nclass ObservablesSet {\n    /* CONSTRUCTOR */\n    constructor(observer, A) {\n        this.observer = observer;\n        this.A = new Set(A);\n    }\n    /* API */\n    Q(deep) {\n        for (const observable of this.A) {\n            observable.K.delete(this.observer);\n        }\n    }\n    R() {\n        return;\n    }\n    empty() {\n        return !this.A.size;\n    }\n    has(observable) {\n        return this.A.has(observable);\n    }\n    L(observable) {\n        const { observer, A } = this;\n        const sizePrev = A.size;\n        observable.K.add(observer);\n        const sizeNext = A.size;\n        if (sizePrev === sizeNext)\n            return; // Cheaper than Set.has+Set.add\n        A.add(observable);\n    }\n    C() {\n        for (const observable of this.A) {\n            observable.parent?.C();\n        }\n    }\n}\n/* EXPORT */\nexport { ObservablesArray, ObservablesSet };\n","/* IMPORT */\nimport { DIRTY_NO, DIRTY_MAYBE_NO, DIRTY_MAYBE_YES, DIRTY_YES } from '../constants.js';\nimport { OWNER, SUPER_OWNER } from '../context.js';\nimport { lazyArrayPush } from '../lazy.js';\nimport { ObservablesArray, ObservablesSet } from './observables.js';\nimport Owner from './owner.js';\n/* MAIN */\nclass Observer extends Owner {\n    /* CONSTRUCTOR */\n    constructor() {\n        super();\n        /* VARIABLES */\n        this.parent = OWNER;\n        this.context = OWNER.context;\n        this.J = DIRTY_YES;\n        this.A = new ObservablesArray(this);\n        if (OWNER !== SUPER_OWNER) {\n            lazyArrayPush(this.parent, 'K', this);\n        }\n    }\n    /* API */\n    Q(deep) {\n        this.A.Q(deep);\n        super.Q(deep);\n    }\n    H(fn) {\n        this.Q(false);\n        this.J = DIRTY_MAYBE_NO; // Resetting the trip flag, we didn't re-execute just yet\n        try {\n            return this.E(fn, this, this);\n        }\n        finally {\n            this.A.R();\n        }\n    }\n    run() {\n        throw new Error('Abstract method');\n    }\n    I(J) {\n        throw new Error('Abstract method');\n    }\n    C() {\n        if (this.disposed)\n            return; // Disposed, it shouldn't be updated again\n        if (this.J === DIRTY_MAYBE_YES) { // Maybe we are dirty, let's check with our A, to be sure\n            this.A.C();\n        }\n        if (this.J === DIRTY_YES) { // We are dirty, let's H\n            this.J = DIRTY_MAYBE_NO; // Trip flag, to be able to tell if we caused ourselves to be dirty again\n            this.run();\n            if (this.J === DIRTY_MAYBE_NO) { // Not dirty anymore\n                this.J = DIRTY_NO;\n            }\n            else { // Maybe we are still dirty, let's check again\n                this.C();\n            }\n        }\n        else { // Not dirty\n            this.J = DIRTY_NO;\n        }\n    }\n}\n/* EXPORT */\nexport default Observer;\n","/* IMPORT */\nimport { DIRTY_MAYBE_YES, UNAVAILABLE, UNINITIALIZED } from '../constants.js';\nimport Observable from './observable.js';\nimport Observer from './observer.js';\n/* MAIN */\nclass Memo extends Observer {\n    /* CONSTRUCTOR */\n    constructor(fn, options) {\n        super();\n        this.fn = fn;\n        this.observable = new Observable(UNINITIALIZED, options, this);\n        if (options?.sync === true) {\n            this.sync = true;\n            this.C();\n        }\n    }\n    /* API */\n    run() {\n        const G = super.H(this.fn);\n        if (!this.disposed && this.A.empty()) {\n            this.disposed = true;\n        }\n        if (G !== UNAVAILABLE) {\n            this.observable.set(G);\n        }\n    }\n    I(J) {\n        const statusPrev = this.J;\n        if (statusPrev >= J)\n            return;\n        this.J = J;\n        if (statusPrev === DIRTY_MAYBE_YES)\n            return;\n        this.observable.I(DIRTY_MAYBE_YES);\n    }\n}\n/* EXPORT */\nexport default Memo;\n","/* IMPORT */\nimport isObservableFrozen from './is_observable_frozen.js';\nimport isUntracked from './is_untracked.js';\nimport { frozen, readable } from '../objects/callable.js';\nimport Memo from '../objects/memo.js';\n/* MAIN */\nconst memo = (fn, options) => {\n    if (isObservableFrozen(fn)) {\n        return fn;\n    }\n    else if (isUntracked(fn)) {\n        return frozen(fn());\n    }\n    else {\n        const memo = new Memo(fn, options);\n        const observable = readable(memo.observable);\n        return observable;\n    }\n};\n/* EXPORT */\nexport default memo;\n","/* IMPORT */\nimport isObservableFrozen from './is_observable_frozen.js';\nimport isUntracked from './is_untracked.js';\nimport memo from './memo.js';\nimport { isFunction } from '../utils.js';\n/* MAIN */\nconst boolean = (value) => {\n    if (isFunction(value)) {\n        if (isObservableFrozen(value) || isUntracked(value)) {\n            return !!value();\n        }\n        else {\n            return memo(() => !!value());\n        }\n    }\n    else {\n        return !!value;\n    }\n};\n/* EXPORT */\nexport default boolean;\n","/* IMPORT */\nimport { OWNER } from '../context.js';\nimport { lazyArrayPush } from '../lazy.js';\n/* MAIN */\nconst cleanup = (fn) => {\n    lazyArrayPush(OWNER, 'B', fn);\n};\n/* EXPORT */\nexport default cleanup;\n","/* IMPORT */\nimport { OWNER } from '../context.js';\nimport { lazyArrayPush } from '../lazy.js';\nimport Owner from './owner.js';\n/* MAIN */\nclass Context extends Owner {\n    /* CONSTRUCTOR */\n    constructor(context) {\n        super();\n        /* VARIABLES */\n        this.parent = OWNER;\n        this.context = { ...OWNER.context, ...context };\n        lazyArrayPush(this.parent, 'D', this);\n    }\n    /* API */\n    E(fn) {\n        return super.E(fn, this, undefined);\n    }\n}\n/* EXPORT */\nexport default Context;\n","/* IMPORT */\nimport { OWNER } from '../context.js';\nimport Context from '../objects/context.js';\nimport { isSymbol, noop } from '../utils.js';\nfunction context(symbolOrContext, fn) {\n    if (isSymbol(symbolOrContext)) {\n        return OWNER.context[symbolOrContext];\n    }\n    else {\n        return new Context(symbolOrContext).E(fn || noop);\n    }\n}\n/* EXPORT */\nexport default context;\n","/* IMPORT */\nimport cleanup from './cleanup.js';\nimport { readable } from '../objects/callable.js';\nimport Observable from '../objects/observable.js';\n/* MAIN */\nconst disposed = () => {\n    const observable = new Observable(false);\n    const A4 = () => observable.set(true);\n    cleanup(A4);\n    return readable(observable);\n};\n/* EXPORT */\nexport default disposed;\n","/* IMPORT */\nimport { BATCH } from '../context.js';\n/* MAIN */\n// Using 2 microtasks to give a chance to things using 1 microtask (like refs in Voby) to run first\nclass Scheduler {\n    constructor() {\n        /* VARIABLES */\n        this.A1 = [];\n        this.A2 = false;\n        this.A3 = false;\n        /* QUEUING API */\n        this.N = () => {\n            if (this.A2)\n                return;\n            if (!this.A1.length)\n                return;\n            try {\n                this.A2 = true;\n                while (true) {\n                    const queue = this.A1;\n                    if (!queue.length)\n                        break;\n                    this.A1 = [];\n                    for (let i = 0, l = queue.length; i < l; i++) {\n                        queue[i].C();\n                    }\n                }\n            }\n            finally {\n                this.A2 = false;\n            }\n        };\n        this.queue = () => {\n            if (this.A3)\n                return;\n            this.A3 = true;\n            this.resolve();\n        };\n        this.resolve = () => {\n            queueMicrotask(() => {\n                queueMicrotask(() => {\n                    if (BATCH) {\n                        BATCH.finally(this.resolve);\n                    }\n                    else {\n                        this.A3 = false;\n                        this.N();\n                    }\n                });\n            });\n        };\n        /* SCHEDULING API */\n        this.F = (effect) => {\n            this.A1.push(effect);\n            this.queue();\n        };\n    }\n}\n/* EXPORT */\nexport default new Scheduler();\n","/* IMPORT */\nimport { lazyArrayPush } from '../lazy.js';\nimport Observer from './observer.js';\nimport Scheduler from './scheduler.async.js';\nimport { SYMBOL_SUSPENSE } from '../symbols.js';\nimport { isFunction } from '../utils.js';\n/* MAIN */\nclass Effect extends Observer {\n    /* CONSTRUCTOR */\n    constructor(fn, options) {\n        super();\n        this.fn = fn;\n        if (options?.suspense !== false) {\n            const suspense = this.get(SYMBOL_SUSPENSE);\n            if (suspense) {\n                this.suspense = suspense;\n            }\n        }\n        if (options?.sync === true) {\n            this.sync = true;\n        }\n        if (options?.sync === 'init') {\n            this.init = true;\n            this.C();\n        }\n        else {\n            this.F();\n        }\n    }\n    /* API */\n    run() {\n        const G = super.H(this.fn);\n        if (isFunction(G)) {\n            lazyArrayPush(this, 'B', G);\n        }\n    }\n    F() {\n        if (this.suspense?.suspended)\n            return;\n        if (this.sync) {\n            this.C();\n        }\n        else {\n            Scheduler.F(this);\n        }\n    }\n    I(J) {\n        const statusPrev = this.J;\n        if (statusPrev >= J)\n            return;\n        this.J = J;\n        if (!this.sync || (statusPrev !== 2 && statusPrev !== 3)) { // It isn't currently executing, so let's F it\n            this.F();\n        }\n    }\n    C() {\n        if (this.suspense?.suspended)\n            return;\n        super.C();\n    }\n}\n/* EXPORT */\nexport default Effect;\n","/* IMPORT */\nimport Effect from '../objects/effect.js';\n/* MAIN */\nconst effect = (fn, options) => {\n    const effect = new Effect(fn, options);\n    const Q = () => effect.Q(true);\n    return Q;\n};\n/* EXPORT */\nexport default effect;\n","/* IMPORT */\nimport memo from './memo.js';\nimport { frozen } from '../objects/callable.js';\nimport { SYMBOL_OBSERVABLE, SYMBOL_UNTRACKED, SYMBOL_UNTRACKED_UNWRAPPED } from '../symbols.js';\nimport { isFunction } from '../utils.js';\nfunction resolve(value) {\n    if (isFunction(value)) {\n        if (SYMBOL_UNTRACKED_UNWRAPPED in value) {\n            return resolve(value());\n        }\n        else if (SYMBOL_UNTRACKED in value) {\n            return frozen(resolve(value()));\n        }\n        else if (SYMBOL_OBSERVABLE in value) {\n            return value;\n        }\n        else {\n            return memo(() => resolve(value()));\n        }\n    }\n    if (value instanceof Array) {\n        const resolved = new Array(value.length);\n        for (let i = 0, l = resolved.length; i < l; i++) {\n            resolved[i] = resolve(value[i]);\n        }\n        return resolved;\n    }\n    else {\n        return value;\n    }\n}\n/* EXPORT */\nexport default resolve;\n","/* IMPORT */\nimport { OWNER } from '../context.js';\nimport { lazySetAdd, lazySetDelete } from '../lazy.js';\nimport Owner from './owner.js';\nimport { SYMBOL_SUSPENSE } from '../symbols.js';\n/* MAIN */\nclass Root extends Owner {\n    /* CONSTRUCTOR */\n    constructor(V) {\n        super();\n        /* VARIABLES */\n        this.parent = OWNER;\n        this.context = OWNER.context;\n        if (V) {\n            const suspense = this.get(SYMBOL_SUSPENSE);\n            if (suspense) {\n                this.A0 = true;\n                lazySetAdd(this.parent, 'T', this);\n            }\n        }\n    }\n    /* API */\n    Q(deep) {\n        if (this.A0) {\n            lazySetDelete(this.parent, 'T', this);\n        }\n        super.Q(deep);\n    }\n    E(fn) {\n        const Q = () => this.Q(true);\n        const fnWithDispose = () => fn(Q);\n        return super.E(fnWithDispose, this, undefined);\n    }\n}\n/* EXPORT */\nexport default Root;\n","/* IMPORT */\nimport { OWNER } from '../context.js';\nimport { lazySetAdd, lazySetDelete } from '../lazy.js';\nimport cleanup from './cleanup.js';\nimport resolve from './resolve.js';\nimport { frozen, readable } from '../objects/callable.js';\nimport Observable from '../objects/observable.js';\nimport Root from '../objects/root.js';\nimport { SYMBOL_CACHED, SYMBOL_SUSPENSE, SYMBOL_UNCACHED } from '../symbols.js';\n/* HELPERS */\nconst DUMMY_INDEX = frozen(-1);\nclass MappedRoot extends Root {\n}\n/* MAIN */\nclass CacheKeyed {\n    /* CONSTRUCTOR */\n    constructor(fn) {\n        /* VARIABLES */\n        this.parent = OWNER;\n        this.suspense = OWNER.get(SYMBOL_SUSPENSE);\n        this.A5 = new Map();\n        this.A6 = false; // The A6 is flipped with each iteration, the T that don't have the updated one are disposed, it's like a cheap M basically\n        this.A7 = 0; // Number of previous items\n        this.A8 = 0; // Number of previous items that got reused\n        this.A9 = 0; // Number of next items\n        /* API */\n        this.cleanup = () => {\n            if (!this.A7)\n                return; // There was nothing AA, no need to cleanup\n            if (this.A7 === this.A8)\n                return; // All the previous items were reused, no need to cleanup\n            const { A5, A6 } = this;\n            if (!A5.size)\n                return; // Nothing to Q of\n            if (this.A9) { // Regular cleanup\n                A5.forEach((mapped, value) => {\n                    if (mapped.A6 === A6)\n                        return;\n                    mapped.Q(true);\n                    A5.delete(value);\n                });\n            }\n            else { // There is nothing O, disposing quickly\n                this.A5.forEach(mapped => {\n                    mapped.Q(true);\n                });\n                this.A5 = new Map();\n            }\n        };\n        this.Q = () => {\n            if (this.suspense) {\n                lazySetDelete(this.parent, 'T', this.T);\n            }\n            this.A7 = this.A5.size;\n            this.A8 = 0;\n            this.A9 = 0;\n            this.cleanup();\n        };\n        this.AA = () => {\n            this.A6 = !this.A6;\n            this.A8 = 0;\n            this.A9 = 0;\n        };\n        this.O = (values) => {\n            this.A9 = values.length;\n            this.cleanup();\n            this.A7 = this.A9;\n            this.A8 = 0;\n        };\n        this.map = (values) => {\n            this.AA();\n            const { A5, A6, fn, AB } = this;\n            const results = new Array(values.length);\n            let resultsCached = true; // Whether all results are cached, if so this enables an optimization\n            let resultsUncached = true; // Whether all results are anew, if so this enables an optimization in Voby\n            let A8 = 0;\n            for (let i = 0, l = values.length; i < l; i++) {\n                const value = values[i];\n                const cached = A5.get(value);\n                if (cached && cached.A6 !== A6) {\n                    resultsUncached = false;\n                    A8 += 1;\n                    cached.A6 = A6;\n                    cached.index?.set(i);\n                    results[i] = cached.G; //TSC\n                }\n                else {\n                    resultsCached = false;\n                    const mapped = new MappedRoot(false);\n                    if (cached) {\n                        cleanup(() => mapped.Q(true));\n                    }\n                    mapped.E(() => {\n                        let index = DUMMY_INDEX;\n                        if (AB) {\n                            mapped.index = new Observable(i);\n                            index = readable(mapped.index);\n                        }\n                        const G = results[i] = resolve(fn(value, index));\n                        mapped.A6 = A6;\n                        mapped.G = G;\n                        if (!cached) {\n                            A5.set(value, mapped);\n                        }\n                    });\n                }\n            }\n            this.A8 = A8;\n            this.O(values);\n            if (resultsCached) {\n                results[SYMBOL_CACHED] = true;\n            }\n            if (resultsUncached) {\n                results[SYMBOL_UNCACHED] = true;\n            }\n            return results;\n        };\n        this.T = () => {\n            return Array.from(this.A5.values());\n        };\n        this.fn = fn;\n        this.AB = (fn.length > 1);\n        if (this.suspense) {\n            lazySetAdd(this.parent, 'T', this.T);\n        }\n    }\n}\n/* EXPORT */\nexport default CacheKeyed;\n","/* IMPORT */\nimport { SYMBOL_OBSERVABLE } from '../symbols.js';\nimport { isFunction } from '../utils.js';\n/* MAIN */\nconst isObservable = (value) => {\n    return isFunction(value) && (SYMBOL_OBSERVABLE in value);\n};\n/* EXPORT */\nexport default isObservable;\n","/* IMPORT */\nimport isObservable from './is_observable.js';\nimport { isFunction } from '../utils.js';\nfunction get(value, getFunction = true) {\n    const is = getFunction ? isFunction : isObservable;\n    if (is(value)) {\n        return value();\n    }\n    else {\n        return value;\n    }\n}\n/* EXPORT */\nexport default get;\n","/* IMPORT */\nimport { DIRTY_MAYBE_YES, DIRTY_YES } from '../constants.js';\nimport { OWNER } from '../context.js';\nimport { lazyArrayEach, lazyArrayPush, lazySetEach } from '../lazy.js';\nimport Effect from './effect.js';\nimport Owner from './owner.js';\nimport { SYMBOL_SUSPENSE } from '../symbols.js';\nimport { isFunction } from '../utils.js';\n/* MAIN */\nclass Suspense extends Owner {\n    /* CONSTRUCTOR */\n    constructor() {\n        super();\n        /* VARIABLES */\n        this.parent = OWNER;\n        this.context = { ...OWNER.context, [SYMBOL_SUSPENSE]: this };\n        lazyArrayPush(this.parent, 'U', this);\n        this.suspended = (OWNER.get(SYMBOL_SUSPENSE)?.suspended || 0);\n    }\n    /* API */\n    A4(force) {\n        if (!this.suspended && !force)\n            return; // Already suspended, this can happen at instantion time\n        const suspendedPrev = this.suspended;\n        const suspendedNext = suspendedPrev + (force ? 1 : -1);\n        this.suspended = suspendedNext;\n        if (!!suspendedPrev === !!suspendedNext)\n            return; // Same state, nothing to pause or resume\n        /* NOTIFYING OBSERVERS, ROOTS AND SUSPENSES */\n        this.observable?.set(!!suspendedNext);\n        const notifyOwner = (owner) => {\n            lazyArrayEach(owner.D, notifyOwner);\n            lazyArrayEach(owner.K, notifyObserver);\n            lazyArrayEach(owner.U, notifySuspense);\n            lazySetEach(owner.T, notifyRoot);\n        };\n        const notifyObserver = (observer) => {\n            if (observer instanceof Effect) {\n                if (observer.J === DIRTY_MAYBE_YES || observer.J === DIRTY_YES) {\n                    if (observer.init) {\n                        observer.C();\n                    }\n                    else {\n                        observer.F();\n                    }\n                }\n            }\n            notifyOwner(observer);\n        };\n        const notifyRoot = (root) => {\n            if (isFunction(root)) {\n                root().forEach(notifyOwner);\n            }\n            else {\n                notifyOwner(root);\n            }\n        };\n        const notifySuspense = (suspense) => {\n            suspense.A4(force);\n        };\n        notifyOwner(this);\n    }\n    E(fn) {\n        return super.E(fn, this, undefined);\n    }\n}\n/* EXPORT */\nexport default Suspense;\n","/* IMPORT */\nimport boolean from './boolean.js';\nimport effect from './effect.js';\nimport get from './get.js';\nimport Suspense from '../objects/suspense.js';\n/* MAIN */\nconst suspense = (when, fn) => {\n    const suspense = new Suspense();\n    const condition = boolean(when);\n    const A4 = () => suspense.A4(get(condition));\n    effect(A4, { sync: true });\n    return suspense.E(fn);\n};\n/* EXPORT */\nexport default suspense;\n","/* IMPORT */\nimport { OWNER } from '../context.js';\nimport { lazySetAdd, lazySetDelete } from '../lazy.js';\nimport cleanup from './cleanup.js';\nimport get from './get.js';\nimport memo from './memo.js';\nimport resolve from './resolve.js';\nimport suspense from './suspense.js';\nimport { frozen, readable } from '../objects/callable.js';\nimport Observable from '../objects/observable.js';\nimport Root from '../objects/root.js';\nimport { SYMBOL_CACHED, SYMBOL_SUSPENSE, SYMBOL_UNCACHED } from '../symbols.js';\n/* HELPERS */\nconst DUMMY_INDEX = frozen(-1);\nclass MappedRoot extends Root {\n}\n/* MAIN */\n//TODO: Optimize this more\nclass CacheUnkeyed {\n    /* CONSTRUCTOR */\n    constructor(fn, pooled) {\n        /* VARIABLES */\n        this.parent = OWNER;\n        this.suspense = OWNER.get(SYMBOL_SUSPENSE);\n        this.A5 = new Map();\n        this.AC = [];\n        this.AD = 0;\n        /* API */\n        this.cleanup = () => {\n            let pooled = 0;\n            let poolable = Math.max(0, this.pooled ? this.AD - this.AC.length : 0);\n            this.A5.forEach(mapped => {\n                if (poolable > 0 && pooled++ < poolable) {\n                    mapped.suspended?.set(true);\n                    this.AC.push(mapped);\n                }\n                else {\n                    mapped.Q(true);\n                }\n            });\n        };\n        this.Q = () => {\n            if (this.suspense) {\n                lazySetDelete(this.parent, 'T', this.T);\n            }\n            this.A5.forEach(mapped => {\n                mapped.Q(true);\n            });\n            this.AC.forEach(mapped => {\n                mapped.Q(true);\n            });\n        };\n        this.map = (values) => {\n            const { A5, fn, AB } = this;\n            const cacheNext = new Map();\n            const results = new Array(values.length);\n            const AC = this.AC;\n            const pooled = this.pooled;\n            let resultsCached = true; // Whether all results are cached, if so this enables an optimization\n            let resultsUncached = true; // Whether all results are anew, if so this enables an optimization in Voby\n            let leftovers = [];\n            if (A5.size) {\n                for (let i = 0, l = values.length; i < l; i++) {\n                    const value = values[i];\n                    const cached = A5.get(value);\n                    if (cached) {\n                        resultsUncached = false;\n                        A5.delete(value);\n                        cacheNext.set(value, cached);\n                        cached.index?.set(i);\n                        results[i] = cached.G; //TSC\n                    }\n                    else {\n                        leftovers.push(i);\n                    }\n                }\n            }\n            else {\n                leftovers = new Array(results.length);\n            }\n            outer: for (let i = 0, l = leftovers.length; i < l; i++) {\n                const index = leftovers[i] || i;\n                const value = values[index];\n                const isDuplicate = cacheNext.has(value);\n                if (!isDuplicate) {\n                    for (const [key, mapped] of A5.entries()) {\n                        A5.delete(key);\n                        cacheNext.set(value, mapped);\n                        mapped.index?.set(index);\n                        mapped.value?.set(value);\n                        results[index] = mapped.G; //TSC\n                        continue outer;\n                    }\n                }\n                resultsCached = false;\n                let mapped;\n                if (pooled && AC.length) {\n                    mapped = AC.pop(); //TSC\n                    mapped.index?.set(index);\n                    mapped.value?.set(value);\n                    mapped.suspended?.set(false);\n                    results[index] = mapped.G; //TSC\n                }\n                else {\n                    mapped = new MappedRoot(false);\n                    mapped.E(() => {\n                        let $index = DUMMY_INDEX;\n                        if (AB) {\n                            mapped.index = new Observable(index);\n                            $index = readable(mapped.index);\n                        }\n                        const observable = mapped.value = new Observable(value);\n                        const suspended = pooled ? new Observable(false) : undefined;\n                        const $value = memo(() => get(observable.get())); //TSC\n                        const G = results[index] = suspended ? suspense(() => suspended.get(), () => resolve(fn($value, $index))) : resolve(fn($value, $index));\n                        mapped.value = observable;\n                        mapped.G = G;\n                        mapped.suspended = suspended;\n                    });\n                }\n                if (isDuplicate) { // Expensive, not reusable\n                    cleanup(() => mapped.Q(true));\n                }\n                else { // Cheap, reusable\n                    cacheNext.set(value, mapped);\n                }\n            }\n            this.AD = Math.max(this.AD, results.length);\n            this.cleanup();\n            this.A5 = cacheNext;\n            if (resultsCached) {\n                results[SYMBOL_CACHED] = true;\n            }\n            if (resultsUncached) {\n                results[SYMBOL_UNCACHED] = true;\n            }\n            return results;\n        };\n        this.T = () => {\n            return [...this.A5.values(), ...this.AC.values()];\n        };\n        this.fn = fn;\n        this.AB = (fn.length > 1);\n        this.pooled = pooled;\n        if (this.suspense) {\n            lazySetAdd(this.parent, 'T', this.T);\n        }\n    }\n}\n/* EXPORT */\nexport default CacheUnkeyed;\n","/* IMPORT */\nimport { SYMBOL_STORE } from '../symbols.js';\nimport { isObject } from '../utils.js';\n/* MAIN */\nconst isStore = (value) => {\n    return isObject(value) && (SYMBOL_STORE in value);\n};\n/* EXPORT */\nexport default isStore;\n","/* IMPORT */\nimport { OBSERVER, setObserver } from '../context.js';\nimport { isFunction } from '../utils.js';\nfunction untrack(fn) {\n    if (isFunction(fn)) {\n        const observerPrev = OBSERVER;\n        if (observerPrev) {\n            try {\n                setObserver(undefined);\n                return fn();\n            }\n            finally {\n                setObserver(observerPrev);\n            }\n        }\n        else {\n            return fn();\n        }\n    }\n    else {\n        return fn;\n    }\n}\n/* EXPORT */\nexport default untrack;\n","/* IMPORT */\nimport untrack from './untrack.js';\n/* MAIN */\n// This function ensures an Observable contains a fresh value, mainly to try to push it into a frozen state, if possible\nconst warmup = (value) => {\n    untrack(value);\n    return value;\n};\n/* EXPORT */\nexport default warmup;\n","/* IMPORT */\nimport get from './get.js';\nimport isObservableFrozen from './is_observable_frozen.js';\nimport isUntracked from './is_untracked.js';\nimport memo from './memo.js';\nimport resolve from './resolve.js';\nimport warmup from './warmup.js';\nimport { frozen } from '../objects/callable.js';\nimport { is, isFunction } from '../utils.js';\n/* HELPERS */\nconst match = (condition, values, fallback) => {\n    for (let i = 0, l = values.length; i < l; i++) {\n        const value = values[i];\n        if (value.length === 1)\n            return value[0];\n        if (is(value[0], condition))\n            return value[1];\n    }\n    return fallback;\n};\nfunction _switch(when, values, fallback) {\n    const isDynamic = isFunction(when) && !isObservableFrozen(when) && !isUntracked(when);\n    if (isDynamic) {\n        const value = warmup(memo(() => match(when(), values, fallback)));\n        if (isObservableFrozen(value)) {\n            return frozen(resolve(value()));\n        }\n        else {\n            return memo(() => resolve(get(value)));\n        }\n    }\n    else {\n        const value = match(get(when), values, fallback);\n        return frozen(resolve(value));\n    }\n}\n/* EXPORT */\nexport default _switch;\n","/* IMPORT */\nimport boolean from './boolean.js';\nimport _switch from './switch.js';\n/* MAIN */\nconst ternary = (when, valueTrue, valueFalse) => {\n    const condition = boolean(when);\n    return _switch(condition, [[true, valueTrue], [valueFalse]]);\n};\n/* EXPORT */\nexport default ternary;\n","/* IMPORT */\nimport { BATCH } from '../context.js';\nimport SchedulerAsync from '../objects/scheduler.async.js';\nimport SchedulerSync from '../objects/scheduler.sync.js';\n/* MAIN */\nconst isBatching = () => {\n    return !!BATCH || SchedulerAsync.A3 || SchedulerAsync.A2 || SchedulerSync.A2;\n};\n/* EXPORT */\nexport default isBatching;\n","/* IMPORT */\nimport { writable } from '../objects/callable.js';\nimport ObservableClass from '../objects/observable.js';\nfunction observable(value, options) {\n    return writable(new ObservableClass(value, options));\n}\n/* EXPORT */\nexport default observable;\n","/* IMPORT */\nimport { SYMBOL_OBSERVABLE_WRITABLE } from '../symbols.js';\nimport { isFunction } from '../utils.js';\n/* MAIN */\nconst isObservableWritable = (value) => {\n    return isFunction(value) && (SYMBOL_OBSERVABLE_WRITABLE in value);\n};\n/* EXPORT */\nexport default isObservableWritable;\n","/* IMPORT */\nimport { UNAVAILABLE } from '../constants.js';\nimport { SYMBOL_OBSERVABLE_READABLE, SYMBOL_OBSERVABLE_WRITABLE } from '../symbols.js';\nimport { isFunction } from '../utils.js';\n/* MAIN */\nconst target = (observable) => {\n    if (isFunction(observable)) {\n        return observable[SYMBOL_OBSERVABLE_READABLE] || observable[SYMBOL_OBSERVABLE_WRITABLE] || UNAVAILABLE;\n    }\n    else {\n        return observable;\n    }\n};\n/* EXPORT */\nexport default target;\n","/* IMPORT */\nimport isObservableWritable from './is_observable_writable.js';\nimport target from './target.js';\nimport { readable } from '../objects/callable.js';\n/* MAIN */\nconst readonly = (observable) => {\n    if (isObservableWritable(observable)) {\n        return readable(target(observable));\n    }\n    else {\n        return observable;\n    }\n};\n/* EXPORT */\nexport default readonly;\n","/* IMPORT */\nimport Root from '../objects/root.js';\n/* MAIN */\nconst root = (fn) => {\n    return new Root(true).E(fn);\n};\n/* EXPORT */\nexport default root;\n","/* IMPORT */\nimport { OBSERVABLE_FALSE, OBSERVABLE_TRUE } from '../constants.js';\nimport cleanup from './cleanup.js';\nimport effect from './effect.js';\nimport isObservableFrozen from './is_observable_frozen.js';\nimport memo from './memo.js';\nimport untrack from './untrack.js';\nimport warmup from './warmup.js';\nimport { readable } from '../objects/callable.js';\nimport Observable from '../objects/observable.js';\nimport { is } from '../utils.js';\n/* HELPERS */\nclass DisposableMap extends Map {\n    constructor() {\n        super(...arguments);\n        this.disposed = false;\n    }\n}\nclass SelectedObservable extends Observable {\n    constructor() {\n        super(...arguments);\n        this.AE = 1;\n    }\n    /* API */\n    call() {\n        if (this.AF.disposed)\n            return;\n        this.AE -= 1;\n        if (this.AE)\n            return;\n        this.AF.delete(this.AG);\n    }\n}\n/* MAIN */\nconst selector = (AG) => {\n    /* NORMALIZING SOURCE */\n    AG = warmup(memo(AG));\n    /* FROZEN SOURCE */\n    if (isObservableFrozen(AG)) {\n        const sourceValue = untrack(AG);\n        return (value) => {\n            return (value === sourceValue) ? OBSERVABLE_TRUE : OBSERVABLE_FALSE;\n        };\n    }\n    /* SELECTEDS */\n    let AF = new DisposableMap();\n    let selectedValue = untrack(AG);\n    effect(() => {\n        const valuePrev = selectedValue;\n        const valueNext = AG();\n        if (is(valuePrev, valueNext))\n            return;\n        selectedValue = valueNext;\n        AF.get(valuePrev)?.set(false);\n        AF.get(valueNext)?.set(true);\n    }, { suspense: false, sync: true });\n    /* CLEANUP ALL */\n    const cleanupAll = () => {\n        AF.disposed = true;\n    };\n    cleanup(cleanupAll);\n    /* SELECTOR */\n    return (value) => {\n        /* INIT */\n        let selected = AF.get(value);\n        if (selected) {\n            selected.AE += 1;\n        }\n        else {\n            selected = new SelectedObservable(value === selectedValue);\n            selected.AF = AF;\n            selected.AG = value;\n            AF.set(value, selected);\n        }\n        /* CLEANUP */\n        cleanup(selected);\n        /* RETURN */\n        return readable(selected);\n    };\n};\n/* EXPORT */\nexport default selector;\n","/* IMPORT */\nimport { BATCH, OBSERVER } from '../context.js';\nimport { lazySetAdd, lazySetDelete, lazySetEach } from '../lazy.js';\nimport cleanup from './cleanup.js';\nimport effect from './effect.js';\nimport isBatching from './is_batching.js';\nimport isStore from './is_store.js';\nimport untrack from './untrack.js';\nimport { readable } from '../objects/callable.js';\nimport ObservableClass from '../objects/observable.js';\nimport { SYMBOL_STORE, SYMBOL_STORE_KEYS, SYMBOL_STORE_OBSERVABLE, SYMBOL_STORE_TARGET, SYMBOL_STORE_VALUES, SYMBOL_STORE_UNTRACKED } from '../symbols.js';\nimport { castArray, is, isArray, isFunction, isObject, noop, nope } from '../utils.js';\n/* CLASSES */\nclass StoreMap extends Map {\n    AH(key, value) {\n        super.set(key, value);\n        return value;\n    }\n}\nclass StoreCleanable {\n    constructor() {\n        this.AE = 0;\n    }\n    listen() {\n        this.AE += 1;\n        cleanup(this);\n    }\n    call() {\n        this.AE -= 1;\n        if (this.AE)\n            return;\n        this.Q();\n    }\n    Q() { }\n}\nclass StoreKeys extends StoreCleanable {\n    constructor(parent, observable) {\n        super();\n        this.parent = parent;\n        this.observable = observable;\n    }\n    Q() {\n        this.parent.keys = undefined;\n    }\n}\nclass StoreValues extends StoreCleanable {\n    constructor(parent, observable) {\n        super();\n        this.parent = parent;\n        this.observable = observable;\n    }\n    Q() {\n        this.parent.values = undefined;\n    }\n}\nclass StoreHas extends StoreCleanable {\n    constructor(parent, key, observable) {\n        super();\n        this.parent = parent;\n        this.key = key;\n        this.observable = observable;\n    }\n    Q() {\n        this.parent.has?.delete(this.key);\n    }\n}\nclass StoreProperty extends StoreCleanable {\n    constructor(parent, key, observable, AI) {\n        super();\n        this.parent = parent;\n        this.key = key;\n        this.observable = observable;\n        this.AI = AI;\n    }\n    Q() {\n        this.parent.AJ?.delete(this.key);\n    }\n}\nconst StoreListenersRegular = {\n    /* VARIABLES */\n    AK: 0,\n    AL: new Set(),\n    AM: new Set(),\n    /* API */\n    AN: () => {\n        const { AL, AM } = StoreListenersRegular;\n        const traversed = new Set();\n        const traverse = (AI) => {\n            if (traversed.has(AI))\n                return;\n            traversed.add(AI);\n            lazySetEach(AI.AO, traverse);\n            lazySetEach(AI.AP, listener => {\n                AL.add(listener);\n            });\n        };\n        AM.forEach(traverse);\n        return () => {\n            AL.forEach(listener => {\n                listener();\n            });\n        };\n    },\n    V: (AI) => {\n        StoreListenersRegular.AM.add(AI);\n        StoreScheduler.F();\n    },\n    reset: () => {\n        StoreListenersRegular.AL = new Set();\n        StoreListenersRegular.AM = new Set();\n    }\n};\nconst StoreListenersRoots = {\n    /* VARIABLES */\n    AK: 0,\n    AM: new Map(),\n    /* API */\n    AN: () => {\n        const { AM } = StoreListenersRoots;\n        return () => {\n            AM.forEach((rootsSet, store) => {\n                const T = Array.from(rootsSet);\n                lazySetEach(store.AQ, listener => {\n                    listener(T);\n                });\n            });\n        };\n    },\n    V: (store, root) => {\n        const T = StoreListenersRoots.AM.get(store) || new Set();\n        T.add(root);\n        StoreListenersRoots.AM.set(store, T);\n        StoreScheduler.F();\n    },\n    AR: (current, parent, key) => {\n        if (!parent.AO) {\n            const root = current?.store || untrack(() => parent.store[key]);\n            StoreListenersRoots.V(parent, root);\n        }\n        else {\n            const traversed = new Set();\n            const traverse = (AI) => {\n                if (traversed.has(AI))\n                    return;\n                traversed.add(AI);\n                lazySetEach(AI.AO, parent => {\n                    if (!parent.AO) {\n                        StoreListenersRoots.V(parent, AI.store);\n                    }\n                    traverse(parent);\n                });\n            };\n            traverse(current || parent);\n        }\n    },\n    reset: () => {\n        StoreListenersRoots.AM = new Map();\n    }\n};\nconst StoreScheduler = {\n    /* VARIABLES */\n    AK: false,\n    /* API */\n    N: () => {\n        const flushRegular = StoreListenersRegular.AN();\n        const flushRoots = StoreListenersRoots.AN();\n        StoreScheduler.reset();\n        flushRegular();\n        flushRoots();\n    },\n    AS: () => {\n        if (isBatching()) {\n            if (BATCH) {\n                BATCH.finally(StoreScheduler.AS);\n            }\n            else {\n                setTimeout(StoreScheduler.AS, 0);\n            }\n        }\n        else {\n            StoreScheduler.N();\n        }\n    },\n    reset: () => {\n        StoreScheduler.AK = false;\n        StoreListenersRegular.reset();\n        StoreListenersRoots.reset();\n    },\n    F: () => {\n        if (StoreScheduler.AK)\n            return;\n        StoreScheduler.AK = true;\n        queueMicrotask(StoreScheduler.AS);\n    }\n};\n/* CONSTANTS */\nconst NODES = new WeakMap();\nconst SPECIAL_SYMBOLS = new Set([SYMBOL_STORE, SYMBOL_STORE_KEYS, SYMBOL_STORE_OBSERVABLE, SYMBOL_STORE_TARGET, SYMBOL_STORE_VALUES]);\nconst UNREACTIVE_KEYS = new Set(['__proto__', '__defineGetter__', '__defineSetter__', '__lookupGetter__', '__lookupSetter__', 'prototype', 'constructor', 'hasOwnProperty', 'isPrototypeOf', 'propertyIsEnumerable', 'toLocaleString', 'toSource', 'toString', 'valueOf']);\nconst STORE_TRAPS = {\n    /* API */\n    get: (target, key) => {\n        if (SPECIAL_SYMBOLS.has(key)) {\n            if (key === SYMBOL_STORE)\n                return true;\n            if (key === SYMBOL_STORE_TARGET)\n                return target;\n            if (key === SYMBOL_STORE_KEYS) {\n                if (isListenable()) {\n                    const AI = getNodeExisting(target);\n                    AI.keys || (AI.keys = getNodeKeys(AI));\n                    AI.keys.listen();\n                    AI.keys.observable.get();\n                }\n                return;\n            }\n            if (key === SYMBOL_STORE_VALUES) {\n                if (isListenable()) {\n                    const AI = getNodeExisting(target);\n                    AI.values || (AI.values = getNodeValues(AI));\n                    AI.values.listen();\n                    AI.values.observable.get();\n                }\n                return;\n            }\n            if (key === SYMBOL_STORE_OBSERVABLE) {\n                return (key) => {\n                    key = (typeof key === 'number') ? String(key) : key;\n                    const AI = getNodeExisting(target);\n                    const getter = AI.AT?.get(key);\n                    if (getter)\n                        return getter.bind(AI.store);\n                    AI.AJ || (AI.AJ = new StoreMap());\n                    const value = target[key];\n                    const property = AI.AJ.get(key) || AI.AJ.AH(key, getNodeProperty(AI, key, value));\n                    const options = AI.equals ? { equals: AI.equals } : undefined;\n                    property.observable || (property.observable = getNodeObservable(AI, value, options));\n                    const observable = readable(property.observable);\n                    return observable;\n                };\n            }\n        }\n        if (UNREACTIVE_KEYS.has(key))\n            return target[key];\n        const AI = getNodeExisting(target);\n        const getter = AI.AT?.get(key);\n        const value = getter || target[key];\n        AI.AJ || (AI.AJ = new StoreMap());\n        const listenable = isListenable();\n        const proxiable = isProxiable(value);\n        const property = listenable || proxiable ? AI.AJ.get(key) || AI.AJ.AH(key, getNodeProperty(AI, key, value)) : undefined;\n        if (property?.AI) {\n            lazySetAdd(property.AI, 'AO', AI);\n        }\n        if (property && listenable) {\n            const options = AI.equals ? { equals: AI.equals } : undefined;\n            property.listen();\n            property.observable || (property.observable = getNodeObservable(AI, value, options));\n            property.observable.get();\n        }\n        if (getter) {\n            return getter.call(AI.store);\n        }\n        else {\n            if (typeof value === 'function' && value === Array.prototype[key]) {\n                return function () {\n                    return value.apply(AI.store, arguments);\n                };\n            }\n            return property?.AI?.store || value;\n        }\n    },\n    set: (target, key, value) => {\n        value = getTarget(value);\n        const AI = getNodeExisting(target);\n        const setter = AI.AU?.get(key);\n        if (setter) {\n            setter.call(AI.store, value);\n        }\n        else {\n            const valuePrev = target[key];\n            const hadProperty = !!valuePrev || (key in target);\n            const equals = AI.equals || is;\n            if (hadProperty && equals(value, valuePrev) && (key !== 'length' || !Array.isArray(target)))\n                return true; // Array.prototype.length is special, it gets updated AA this trap is called, we need to special-case it...\n            target[key] = value;\n            AI.values?.observable.set(0);\n            if (!hadProperty) {\n                AI.keys?.observable.set(0);\n                AI.has?.get(key)?.observable.set(true);\n            }\n            const property = AI.AJ?.get(key);\n            if (property?.AI) {\n                lazySetDelete(property.AI, 'AO', AI);\n            }\n            if (property) {\n                property.observable?.set(value);\n                property.AI = isProxiable(value) ? NODES.get(value) || getNode(value, AI) : undefined;\n            }\n            if (property?.AI) {\n                lazySetAdd(property.AI, 'AO', AI);\n            }\n            if (StoreListenersRoots.AK) {\n                StoreListenersRoots.AR(property?.AI, AI, key);\n            }\n            if (StoreListenersRegular.AK) {\n                StoreListenersRegular.V(AI);\n            }\n        }\n        return true;\n    },\n    deleteProperty: (target, key) => {\n        const hasProperty = (key in target);\n        if (!hasProperty)\n            return true;\n        const deleted = Reflect.deleteProperty(target, key);\n        if (!deleted)\n            return false;\n        const AI = getNodeExisting(target);\n        AI.keys?.observable.set(0);\n        AI.values?.observable.set(0);\n        AI.has?.get(key)?.observable.set(false);\n        const property = AI.AJ?.get(key);\n        if (StoreListenersRoots.AK) {\n            StoreListenersRoots.AR(property?.AI, AI, key);\n        }\n        if (property?.AI) {\n            lazySetDelete(property.AI, 'AO', AI);\n        }\n        if (property) {\n            property.observable?.set(undefined);\n            property.AI = undefined;\n        }\n        if (StoreListenersRegular.AK) {\n            StoreListenersRegular.V(AI);\n        }\n        return true;\n    },\n    defineProperty: (target, key, descriptor) => {\n        const AI = getNodeExisting(target);\n        const equals = AI.equals || is;\n        const hadProperty = (key in target);\n        const descriptorPrev = Reflect.getOwnPropertyDescriptor(target, key);\n        if (descriptorPrev && isEqualDescriptor(descriptorPrev, descriptor, equals))\n            return true;\n        const defined = Reflect.defineProperty(target, key, descriptor);\n        if (!defined)\n            return false;\n        if (!descriptor.get) {\n            AI.AT?.delete(key);\n        }\n        else if (descriptor.get) {\n            AI.AT || (AI.AT = new StoreMap());\n            AI.AT.set(key, descriptor.get);\n        }\n        if (!descriptor.set) {\n            AI.AU?.delete(key);\n        }\n        else if (descriptor.set) {\n            AI.AU || (AI.AU = new StoreMap());\n            AI.AU.set(key, descriptor.set);\n        }\n        if (hadProperty !== !!descriptor.enumerable) {\n            AI.keys?.observable.set(0);\n            AI.has?.get(key)?.observable.set(!!descriptor.enumerable);\n        }\n        const property = AI.AJ?.get(key);\n        if (StoreListenersRoots.AK) {\n            StoreListenersRoots.AR(property?.AI, AI, key);\n        }\n        if (property?.AI) {\n            lazySetDelete(property.AI, 'AO', AI);\n        }\n        if (property) {\n            if ('get' in descriptor) {\n                property.observable?.set(descriptor.get);\n                property.AI = undefined;\n            }\n            else {\n                const value = descriptor.value;\n                property.observable?.set(value);\n                property.AI = isProxiable(value) ? NODES.get(value) || getNode(value, AI) : undefined;\n            }\n        }\n        if (property?.AI) {\n            lazySetAdd(property.AI, 'AO', AI);\n        }\n        if (StoreListenersRoots.AK) {\n            StoreListenersRoots.AR(property?.AI, AI, key);\n        }\n        if (StoreListenersRegular.AK) {\n            StoreListenersRegular.V(AI);\n        }\n        return true;\n    },\n    has: (target, key) => {\n        if (key === SYMBOL_STORE)\n            return true;\n        if (key === SYMBOL_STORE_TARGET)\n            return true;\n        const value = (key in target);\n        if (isListenable()) {\n            const AI = getNodeExisting(target);\n            AI.has || (AI.has = new StoreMap());\n            const has = AI.has.get(key) || AI.has.AH(key, getNodeHas(AI, key, value));\n            has.listen();\n            has.observable.get();\n        }\n        return value;\n    },\n    ownKeys: (target) => {\n        const keys = Reflect.ownKeys(target);\n        if (isListenable()) {\n            const AI = getNodeExisting(target);\n            AI.keys || (AI.keys = getNodeKeys(AI));\n            AI.keys.listen();\n            AI.keys.observable.get();\n        }\n        return keys;\n    }\n};\nconst STORE_UNTRACK_TRAPS = {\n    /* API */\n    has: (target, key) => {\n        if (key === SYMBOL_STORE_UNTRACKED)\n            return true;\n        return (key in target);\n    }\n};\n/* HELPERS */\nconst getNode = (value, parent, equals) => {\n    const store = new Proxy(value, STORE_TRAPS);\n    const gettersAndSetters = getGettersAndSetters(value);\n    const AI = { AO: parent, store };\n    if (gettersAndSetters) {\n        const { AT, AU } = gettersAndSetters;\n        if (AT)\n            AI.AT = AT;\n        if (AU)\n            AI.AU = AU;\n    }\n    if (equals === false) {\n        AI.equals = nope;\n    }\n    else if (equals) {\n        AI.equals = equals;\n    }\n    else if (parent?.equals) {\n        AI.equals = parent.equals;\n    }\n    NODES.set(value, AI);\n    return AI;\n};\nconst getNodeExisting = (value) => {\n    const AI = NODES.get(value);\n    if (!AI)\n        throw new Error('Impossible');\n    return AI;\n};\nconst getNodeFromStore = (store) => {\n    return getNodeExisting(getTarget(store));\n};\nconst getNodeKeys = (AI) => {\n    const observable = getNodeObservable(AI, 0, { equals: false });\n    const keys = new StoreKeys(AI, observable);\n    return keys;\n};\nconst getNodeValues = (AI) => {\n    const observable = getNodeObservable(AI, 0, { equals: false });\n    const values = new StoreValues(AI, observable);\n    return values;\n};\nconst getNodeHas = (AI, key, value) => {\n    const observable = getNodeObservable(AI, value);\n    const has = new StoreHas(AI, key, observable);\n    return has;\n};\nconst getNodeObservable = (AI, value, options) => {\n    return new ObservableClass(value, options);\n};\nconst getNodeProperty = (AI, key, value) => {\n    const observable = undefined;\n    const propertyNode = isProxiable(value) ? NODES.get(value) || getNode(value, AI) : undefined;\n    const property = new StoreProperty(AI, key, observable, propertyNode);\n    AI.AJ || (AI.AJ = new StoreMap());\n    AI.AJ.set(key, property);\n    return property;\n};\nconst getGettersAndSetters = (value) => {\n    if (isArray(value))\n        return;\n    let AT;\n    let AU;\n    const keys = Object.keys(value);\n    for (let i = 0, l = keys.length; i < l; i++) {\n        const key = keys[i];\n        const descriptor = Object.getOwnPropertyDescriptor(value, key);\n        if (!descriptor)\n            continue;\n        const { get, set } = descriptor;\n        if (get) {\n            AT || (AT = new StoreMap());\n            AT.set(key, get);\n        }\n        if (set) {\n            AU || (AU = new StoreMap());\n            AU.set(key, set);\n        }\n    }\n    if (!AT && !AU)\n        return;\n    return { AT, AU };\n};\nconst getStore = (value, options) => {\n    if (isStore(value))\n        return value;\n    const AI = NODES.get(value) || getNode(value, undefined, options?.equals);\n    return AI.store;\n};\nconst getTarget = (value) => {\n    if (isStore(value))\n        return value[SYMBOL_STORE_TARGET];\n    return value;\n};\nconst getUntracked = (value) => {\n    if (!isObject(value))\n        return value;\n    if (isUntracked(value))\n        return value;\n    return new Proxy(value, STORE_UNTRACK_TRAPS);\n};\nconst isEqualDescriptor = (a, b, equals) => {\n    return (!!a.configurable === !!b.configurable && !!a.enumerable === !!b.enumerable && !!a.writable === !!b.writable && equals(a.value, b.value) && a.get === b.get && a.set === b.set);\n};\nconst isListenable = () => {\n    return !!OBSERVER;\n};\nconst isProxiable = (value) => {\n    if (value === null || typeof value !== 'object')\n        return false;\n    if (SYMBOL_STORE in value)\n        return true;\n    if (SYMBOL_STORE_UNTRACKED in value)\n        return false;\n    if (isArray(value))\n        return true;\n    const prototype = Object.getPrototypeOf(value);\n    if (prototype === null)\n        return true;\n    return (Object.getPrototypeOf(prototype) === null);\n};\nconst isUntracked = (value) => {\n    if (value === null || typeof value !== 'object')\n        return false;\n    return (SYMBOL_STORE_UNTRACKED in value);\n};\n/* MAIN */\n//TODO: Maybe have the \"on\" method trigger immediately too like \"$.on\", or maybe the other way around, which seems more flexible\n//TODO: Explore converting target values back to numbers (the Proxy always receives strings) whenever possible, to save memory\n//TODO: Implement \"_onRoots\" better, perhaps provding string paths instead, which should be more powerful\nconst store = (value, options) => {\n    if (!isObject(value))\n        return value;\n    if (isUntracked(value))\n        return value;\n    return getStore(value, options);\n};\n/* UTILITIES */\nstore.on = (target, listener) => {\n    /* VARIABLES */\n    const targets = castArray(target);\n    const selectors = targets.filter(isFunction);\n    const AM = targets.filter(isStore).map(getNodeFromStore);\n    /* ON */\n    StoreListenersRegular.AK += 1;\n    const disposers = selectors.map(selector => {\n        let inited = false;\n        return effect(() => {\n            if (inited) {\n                StoreListenersRegular.AL.add(listener);\n                StoreScheduler.F();\n            }\n            inited = true;\n            selector();\n        }, { suspense: false, sync: true });\n    });\n    AM.forEach(AI => {\n        lazySetAdd(AI, 'AP', listener);\n    });\n    /* OFF */\n    return () => {\n        StoreListenersRegular.AK -= 1;\n        disposers.forEach(disposer => {\n            disposer();\n        });\n        AM.forEach(AI => {\n            lazySetDelete(AI, 'AP', listener);\n        });\n    };\n};\nstore._onRoots = (target, listener) => {\n    if (!isStore(target))\n        return noop;\n    const AI = getNodeFromStore(target);\n    if (AI.AO)\n        throw new Error('Only top-level stores are supported');\n    /* ON */\n    StoreListenersRoots.AK += 1;\n    lazySetAdd(AI, 'AQ', listener);\n    /* OFF */\n    return () => {\n        StoreListenersRoots.AK -= 1;\n        lazySetDelete(AI, 'AQ', listener);\n    };\n};\nstore.reconcile = (() => {\n    //TODO: Support AT, AU and symbols (symbols could be supported with Reflect.ownKeys, but that's like 2x slower)\n    const getType = (value) => {\n        if (isArray(value))\n            return 1;\n        if (isProxiable(value))\n            return 2;\n        return 0;\n    };\n    const reconcileOuter = (prev, next) => {\n        const uprev = getTarget(prev);\n        const unext = getTarget(next);\n        reconcileInner(prev, next);\n        const prevType = getType(uprev);\n        const nextType = getType(unext);\n        if (prevType === 1 || nextType === 1) {\n            prev.length = next.length;\n        }\n        return prev;\n    };\n    const reconcileInner = (prev, next) => {\n        const uprev = getTarget(prev);\n        const unext = getTarget(next);\n        const prevKeys = Object.keys(uprev);\n        const nextKeys = Object.keys(unext);\n        for (let i = 0, l = nextKeys.length; i < l; i++) {\n            const key = nextKeys[i];\n            const prevValue = uprev[key];\n            const nextValue = unext[key];\n            if (!is(prevValue, nextValue)) {\n                const prevType = getType(prevValue);\n                const nextType = getType(nextValue);\n                if (prevType && prevType === nextType) {\n                    reconcileInner(prev[key], nextValue);\n                    if (prevType === 1) {\n                        prev[key].length = nextValue.length;\n                    }\n                }\n                else {\n                    prev[key] = nextValue;\n                }\n            }\n            else if (prevValue === undefined && !(key in uprev)) {\n                prev[key] = undefined;\n            }\n        }\n        for (let i = 0, l = prevKeys.length; i < l; i++) {\n            const key = prevKeys[i];\n            if (!(key in unext)) {\n                delete prev[key];\n            }\n        }\n        return prev;\n    };\n    const reconcile = (prev, next) => {\n        return untrack(() => {\n            return reconcileOuter(prev, next);\n        });\n    };\n    return reconcile;\n})();\nstore.untrack = (value) => {\n    return getUntracked(value);\n};\nstore.unwrap = (value) => {\n    return getTarget(value);\n};\n/* EXPORT */\nexport default store;\n","/* IMPORT */\nimport { OBSERVABLE_FALSE } from '../constants.js';\nimport { OWNER } from '../context.js';\nimport { readable } from '../objects/callable.js';\nimport Observable from '../objects/observable.js';\nimport { SYMBOL_SUSPENSE } from '../symbols.js';\n/* MAIN */\nconst suspended = () => {\n    const suspense = OWNER.get(SYMBOL_SUSPENSE);\n    if (!suspense)\n        return OBSERVABLE_FALSE;\n    const observable = (suspense.observable || (suspense.observable = new Observable(!!suspense.suspended)));\n    return readable(observable);\n};\n/* EXPORT */\nexport default suspended;\n","/* IMPORT */\nimport Scheduler from '../objects/scheduler.async.js';\n/* MAIN */\nconst tick = () => {\n    Scheduler.N();\n};\n/* EXPORT */\nexport default tick;\n","/* IMPORT */\nimport { OWNER } from '../context.js';\nimport memo from './memo.js';\nimport $ from './observable.js';\nimport resolve from './resolve.js';\n/* MAIN */\nconst tryCatch = (value, fn) => {\n    const observable = $();\n    return memo(() => {\n        const error = observable();\n        if (error) {\n            const reset = () => observable(undefined);\n            const options = { error, reset };\n            return resolve(fn(options));\n        }\n        else {\n            OWNER.S = observable;\n            return resolve(value);\n        }\n    });\n};\n/* EXPORT */\nexport default tryCatch;\n","/* IMPORT */\nimport untrack from './untrack.js';\nimport { SYMBOL_UNTRACKED } from '../symbols.js';\nimport { isFunction } from '../utils.js';\nfunction untracked(fn) {\n    const untracked = isFunction(fn) ? (...args) => untrack(() => fn(...args)) : () => fn;\n    untracked[SYMBOL_UNTRACKED] = true;\n    return untracked;\n}\n/* EXPORT */\nexport default untracked;\n","/* IMPORT */\nimport { OBSERVER, OWNER } from '../context.js';\n/* MAIN */\nconst _with = () => {\n    const owner = OWNER;\n    const observer = OBSERVER;\n    return (fn) => {\n        return owner.E(() => fn(), owner, observer);\n    };\n};\n/* EXPORT */\nexport default _with;\n","/* IMPORT */\nimport { SYMBOL_OBSERVABLE, SYMBOL_OBSERVABLE_FROZEN, SYMBOL_OBSERVABLE_READABLE, SYMBOL_UNCACHED, SYMBOL_UNTRACKED, SYMBOL_UNTRACKED_UNWRAPPED } from './oby.js';\n/* MAIN */\nconst CONTEXTS_DATA = new WeakMap();\nconst DIRECTIVES = {};\nconst SYMBOL_SUSPENSE = Symbol('Suspense');\nconst SYMBOL_TEMPLATE_ACCESSOR = Symbol('Template.Accessor');\nconst SYMBOLS_DIRECTIVES = {};\n/* EXPORT */\nexport { SYMBOL_OBSERVABLE, SYMBOL_OBSERVABLE_FROZEN, SYMBOL_OBSERVABLE_READABLE, SYMBOL_UNCACHED, SYMBOL_UNTRACKED, SYMBOL_UNTRACKED_UNWRAPPED };\nexport { CONTEXTS_DATA, DIRECTIVES, SYMBOL_SUSPENSE, SYMBOL_TEMPLATE_ACCESSOR, SYMBOLS_DIRECTIVES };\n","/* IMPORT */\nimport { SYMBOL_UNTRACKED_UNWRAPPED } from '../constants.js';\n/* MAIN */\nconst wrapElement = (element) => {\n    element[SYMBOL_UNTRACKED_UNWRAPPED] = true;\n    return element;\n};\n/* EXPORT */\nexport default wrapElement;\n","/* IMPORT */\n/* MAIN */\nconst createComment = document.createComment.bind(document, '');\nconst createHTMLNode = document.createElement.bind(document);\nconst createSVGNode = document.createElementNS.bind(document, 'http://www.w3.org/2000/svg');\nconst createText = document.createTextNode.bind(document);\n/* EXPORT */\nexport { createComment, createHTMLNode, createSVGNode, createText };\n","/* IMPORT */\nimport { SYMBOL_OBSERVABLE_FROZEN, SYMBOL_OBSERVABLE_READABLE, SYMBOL_TEMPLATE_ACCESSOR, SYMBOL_UNTRACKED, SYMBOL_UNTRACKED_UNWRAPPED } from '../constants.js';\n/* MAIN */\nconst { assign } = Object;\nconst castArray = (value) => {\n    return isArray(value) ? value : [value];\n};\nconst castError = (exception) => {\n    if (isError(exception))\n        return exception;\n    if (isString(exception))\n        return new Error(exception);\n    return new Error('Unknown error');\n};\nconst flatten = (arr) => {\n    for (let i = 0, l = arr.length; i < l; i++) {\n        if (!isArray(arr[i]))\n            continue;\n        return arr.flat(Infinity);\n    }\n    return arr;\n};\nconst indexOf = (() => {\n    const _indexOf = Array.prototype.indexOf;\n    return (arr, value) => {\n        return _indexOf.call(arr, value);\n    };\n})();\nconst { isArray } = Array;\nconst isBoolean = (value) => {\n    return typeof value === 'boolean';\n};\nconst isComponent = (value) => {\n    return isFunction(value) && (SYMBOL_UNTRACKED_UNWRAPPED in value);\n};\nconst isError = (value) => {\n    return value instanceof Error;\n};\nconst isFalsy = (value) => {\n    return !value;\n};\nconst isFunction = (value) => {\n    return typeof value === 'function';\n};\nconst isFunctionReactive = (value) => {\n    return !(SYMBOL_UNTRACKED in value || SYMBOL_UNTRACKED_UNWRAPPED in value || SYMBOL_OBSERVABLE_FROZEN in value || value[SYMBOL_OBSERVABLE_READABLE]?.parent?.disposed);\n};\nconst isNil = (value) => {\n    return value === null || value === undefined;\n};\nconst isNode = (value) => {\n    return value instanceof Node;\n};\nconst isObject = (value) => {\n    return typeof value === 'object' && value !== null;\n};\nconst isPromise = (value) => {\n    return value instanceof Promise;\n};\nconst isString = (value) => {\n    return typeof value === 'string';\n};\nconst isSVG = (value) => {\n    return !!value['isSVG'];\n};\nconst isSVGElement = (() => {\n    const svgRe = /^(t(ext$|s)|s[vwy]|g)|^set|tad|ker|p(at|s)|s(to|c$|ca|k)|r(ec|cl)|ew|us|f($|e|s)|cu|n[ei]|l[ty]|[GOP]/; //URL: https://regex101.com/r/Ck4kFp/1\n    const svgCache = {};\n    return (element) => {\n        const cached = svgCache[element];\n        return (cached !== undefined) ? cached : (svgCache[element] = !element.includes('-') && svgRe.test(element));\n    };\n})();\nconst isTemplateAccessor = (value) => {\n    return isFunction(value) && (SYMBOL_TEMPLATE_ACCESSOR in value);\n};\nconst isTruthy = (value) => {\n    return !!value;\n};\nconst isVoidChild = (value) => {\n    return value === null || value === undefined || typeof value === 'boolean' || typeof value === 'symbol';\n};\nconst noop = () => {\n    return;\n};\nconst once = (fn) => {\n    let called = false;\n    let result;\n    return () => {\n        if (!called) {\n            called = true;\n            result = fn();\n        }\n        return result;\n    };\n};\n/* EXPORT */\nexport { assign, castArray, castError, flatten, indexOf, isArray, isBoolean, isComponent, isError, isFalsy, isFunction, isFunctionReactive, isNil, isNode, isObject, isPromise, isString, isSVG, isSVGElement, isTemplateAccessor, isTruthy, isVoidChild, noop, once };\n","/* IMPORT */\nimport isObservable from '../methods/is_observable.js';\nimport { isArray, isFunction } from '../utils/lang.js';\nfunction useResolved(values, callback, resolveFunction) {\n    const isResolvable = (resolveFunction !== false && callback !== false) ? isFunction : isObservable;\n    const resolve = (value) => isResolvable(value) ? value() : value;\n    if (isArray(values)) {\n        const resolved = values.map(resolve);\n        if (isFunction(callback)) {\n            return callback.apply(undefined, resolved);\n        }\n        else {\n            return resolved;\n        }\n    }\n    else {\n        const resolved = resolve(values);\n        if (isFunction(callback)) {\n            return callback(resolved);\n        }\n        else {\n            return resolved;\n        }\n    }\n}\n/* EXPORT */\nexport default useResolved;\n","/* IMPORT */\nimport useEffect from './use_effect.js';\nimport useResolved from './use_resolved.js';\nimport $$ from '../methods/SS.js';\nimport { castArray } from '../utils/lang.js';\nfunction useEventListener(target, event, handler, options) {\n    return useEffect(() => {\n        const fn = $$(handler, false);\n        return useResolved([target, event, options], (target, event, options) => {\n            const targets = castArray(target);\n            targets.forEach(target => {\n                target?.addEventListener(event, fn, options);\n            });\n            return () => {\n                targets.forEach(target => {\n                    target?.removeEventListener(event, fn, options);\n                });\n            };\n        });\n    }, { sync: 'init' });\n}\n/* EXPORT */\nexport default useEventListener;\n","/* IMPORT */\nimport useCleanup from './use_cleanup.js';\nimport useEventListener from './use_event_listener.js';\nimport { castArray } from '../utils/lang.js';\n/* MAIN */\nconst useAbortController = (signals = []) => {\n    signals = castArray(signals);\n    const controller = new AbortController();\n    const abort = controller.abort.bind(controller);\n    const aborted = signals.some(signal => signal.aborted);\n    if (aborted) {\n        abort();\n    }\n    else {\n        signals.forEach(signal => useEventListener(signal, 'abort', abort));\n        useCleanup(abort);\n    }\n    return controller;\n};\n/* EXPORT */\nexport default useAbortController;\n","/* IMPORT */\nimport useAbortController from './use_abort_controller.js';\n/* MAIN */\nconst useAbortSignal = (signals = []) => {\n    return useAbortController(signals).signal;\n};\n/* EXPORT */\nexport default useAbortSignal;\n","/* IMPORT */\nimport useEffect from './use_effect.js';\nimport useSuspended from './use_suspended.js';\nimport $$ from '../methods/SS.js';\nimport untrack from '../methods/untrack.js';\n/* MAIN */\nconst useScheduler = ({ loop, once, callback, cancel, schedule }) => {\n    let executed = false;\n    let suspended = useSuspended();\n    let tickId;\n    const work = (value) => {\n        executed = true;\n        if ($$(loop))\n            tick();\n        $$(callback, false)(value);\n    };\n    const tick = () => {\n        tickId = untrack(() => schedule(work));\n    };\n    const dispose = () => {\n        untrack(() => cancel(tickId));\n    };\n    useEffect(() => {\n        if (once && executed)\n            return;\n        if (suspended())\n            return;\n        tick();\n        return dispose;\n    }, { suspense: false });\n    return dispose;\n};\n/* EXPORT */\nexport default useScheduler;\n","/* IMPORT */\nimport useScheduler from './use_scheduler.js';\n/* MAIN */\nconst useAnimationFrame = (callback) => {\n    return useScheduler({\n        callback,\n        once: true,\n        cancel: cancelAnimationFrame,\n        schedule: requestAnimationFrame\n    });\n};\n/* EXPORT */\nexport default useAnimationFrame;\n","/* IMPORT */\nimport useScheduler from './use_scheduler.js';\n/* MAIN */\nconst useAnimationLoop = (callback) => {\n    return useScheduler({\n        callback,\n        loop: true,\n        cancel: cancelAnimationFrame,\n        schedule: requestAnimationFrame\n    });\n};\n/* EXPORT */\nexport default useAnimationLoop;\n","/* IMPORT */\nimport { SYMBOL_SUSPENSE } from '../constants.js';\nimport useMemo from '../hooks/use_memo.js';\nimport $ from '../methods/S.js';\nimport { context, resolve } from '../oby.js';\n/* MAIN */\nconst SuspenseContext = {\n    create: () => {\n        const parent = SuspenseContext.get();\n        const count = $(0);\n        const active = useMemo(() => !!count());\n        const increment = (nr = 1) => { parent?.increment(nr); count(prev => prev + nr); };\n        const decrement = (nr = -1) => queueMicrotask(() => { parent?.decrement(nr); count(prev => prev + nr); });\n        const data = { active, increment, decrement };\n        return data;\n    },\n    get: () => {\n        return context(SYMBOL_SUSPENSE);\n    },\n    wrap: (fn) => {\n        const data = SuspenseContext.create();\n        return context({ [SYMBOL_SUSPENSE]: data }, () => {\n            return resolve(() => fn(data));\n        });\n    }\n};\n/* EXPORT */\nexport default SuspenseContext;\n","/* IMPORT */\nimport SuspenseContext from './suspense.context.js';\nimport useCleanup from '../hooks/use_cleanup.js';\n/* MAIN */\nclass SuspenseManager {\n    constructor() {\n        /* VARIABLES */\n        this.suspenses = new Map();\n        /* API */\n        this.change = (suspense, nr) => {\n            const counter = this.suspenses.get(suspense) || 0;\n            const counterNext = Math.max(0, counter + nr);\n            if (counter === counterNext)\n                return;\n            if (counterNext) {\n                this.suspenses.set(suspense, counterNext);\n            }\n            else {\n                this.suspenses.delete(suspense);\n            }\n            if (nr > 0) {\n                suspense.increment(nr);\n            }\n            else {\n                suspense.decrement(nr);\n            }\n        };\n        this.suspend = () => {\n            const suspense = SuspenseContext.get();\n            if (!suspense)\n                return;\n            this.change(suspense, 1);\n            useCleanup(() => {\n                this.change(suspense, -1);\n            });\n        };\n        this.unsuspend = () => {\n            this.suspenses.forEach((counter, suspense) => {\n                this.change(suspense, -counter);\n            });\n        };\n    }\n}\n;\n/* EXPORT */\nexport default SuspenseManager;\n","/* IMPORT */\nimport useEffect from './use_effect.js';\n/* HELPERS */\nconst options = {\n    sync: 'init'\n};\n/* MAIN */\n// This function exists for convenience, and to avoid creating unnecessary options objects\nconst useRenderEffect = (fn) => {\n    return useEffect(fn, options);\n};\n/* EXPORT */\nexport default useRenderEffect;\n","/* IMPORT */\nimport SuspenseManager from '../components/suspense.manager.js';\nimport useCheapDisposed from './use_cheap_disposed.js';\nimport useReadonly from './use_readonly.js';\nimport useRenderEffect from './use_render_effect.js';\nimport $ from '../methods/S.js';\nimport $$ from '../methods/SS.js';\nimport { assign, castError, isPromise } from '../utils/lang.js';\n/* MAIN */\n//TODO: Maybe port this to oby, as \"from\"\n//TODO: Option for returning the resource as a store, where also the returned value gets wrapped in a store\n//FIXME: SSR demo: toggling back and forth between /home and /loader is buggy, /loader gets loaded with no data, which is wrong\nconst useResource = (fetcher) => {\n    const pending = $(true);\n    const error = $();\n    const value = $();\n    const latest = $();\n    const { suspend, unsuspend } = new SuspenseManager();\n    const resourcePending = { pending: true, get value() { return void suspend(); }, get latest() { return latest() ?? void suspend(); } };\n    const resourceRejected = { pending: false, get error() { return error(); }, get value() { throw error(); }, get latest() { throw error(); } };\n    const resourceResolved = { pending: false, get value() { return value(); }, get latest() { return value(); } };\n    const resourceFunction = { pending: () => pending(), error: () => error(), value: () => resource().value, latest: () => resource().latest };\n    const resource = $(resourcePending);\n    useRenderEffect(() => {\n        const disposed = useCheapDisposed();\n        const onPending = () => {\n            pending(true);\n            error(undefined);\n            value(undefined);\n            resource(resourcePending);\n        };\n        const onResolve = (result) => {\n            if (disposed())\n                return;\n            pending(false);\n            error(undefined);\n            value(() => result);\n            latest(() => result);\n            resource(resourceResolved);\n        };\n        const onReject = (exception) => {\n            if (disposed())\n                return;\n            pending(false);\n            error(castError(exception));\n            value(undefined);\n            latest(undefined);\n            resource(resourceRejected);\n        };\n        const fetch = () => {\n            try {\n                const value = $$(fetcher());\n                if (isPromise(value)) {\n                    onPending();\n                    value.then(onResolve, onReject);\n                    value.then(unsuspend, unsuspend);\n                }\n                else {\n                    onResolve(value);\n                }\n            }\n            catch (error) {\n                onReject(error);\n            }\n        };\n        fetch();\n    });\n    return assign(useReadonly(resource), resourceFunction);\n};\n/* EXPORT */\nexport default useResource;\n","/* IMPORT */\nimport useAbortSignal from './use_abort_signal.js';\nimport useResolved from './use_resolved.js';\nimport useResource from './use_resource.js';\n/* MAIN */\nconst useFetch = (request, init) => {\n    return useResource(() => {\n        return useResolved([request, init], (request, init = {}) => {\n            const signal = useAbortSignal(init.signal || []);\n            init.signal = signal;\n            return fetch(request, init);\n        });\n    });\n};\n/* EXPORT */\nexport default useFetch;\n","/* IMPORT */\nimport useScheduler from './use_scheduler.js';\nimport $$ from '../methods/SS.js';\n/* MAIN */\nconst useIdleCallback = (callback, options) => {\n    return useScheduler({\n        callback,\n        once: true,\n        cancel: cancelIdleCallback,\n        schedule: callback => requestIdleCallback(callback, $$(options))\n    });\n};\n/* EXPORT */\nexport default useIdleCallback;\n","/* IMPORT */\nimport useScheduler from './use_scheduler.js';\nimport $$ from '../methods/SS.js';\n/* MAIN */\nconst useIdleLoop = (callback, options) => {\n    return useScheduler({\n        callback,\n        loop: true,\n        cancel: cancelIdleCallback,\n        schedule: callback => requestIdleCallback(callback, $$(options))\n    });\n};\n/* EXPORT */\nexport default useIdleLoop;\n","/* IMPORT */\nimport useScheduler from './use_scheduler.js';\nimport $$ from '../methods/SS.js';\n/* MAIN */\nconst useInterval = (callback, ms) => {\n    return useScheduler({\n        callback,\n        cancel: clearInterval,\n        schedule: callback => setInterval(callback, $$(ms))\n    });\n};\n/* EXPORT */\nexport default useInterval;\n","/* IMPORT */\nimport useResource from './use_resource.js';\nimport $$ from '../methods/SS.js';\n/* MAIN */\nconst usePromise = (promise) => {\n    return useResource(() => $$(promise));\n};\n/* EXPORT */\nexport default usePromise;\n","/* IMPORT */\nimport useScheduler from './use_scheduler.js';\nimport $$ from '../methods/SS.js';\n/* MAIN */\nconst useTimeout = (callback, ms) => {\n    return useScheduler({\n        callback,\n        once: true,\n        cancel: clearTimeout,\n        schedule: callback => setTimeout(callback, $$(ms))\n    });\n};\n/* EXPORT */\nexport default useTimeout;\n","/* IMPORT */\nimport { useCleanup } from './/index.js';\n/* MAIN */\nconst useCheapDisposed = () => {\n    let disposed = false;\n    const get = () => disposed;\n    const set = () => disposed = true;\n    useCleanup(set);\n    return get;\n};\n/* EXPORT */\nexport default useCheapDisposed;\n","/* IMPORT */\nimport useCheapDisposed from './use_cheap_disposed.js';\nimport { with as _with } from '../oby.js';\n/* MAIN */\n//TODO: Maybe port this to oby\nconst useMicrotask = (fn) => {\n    const disposed = useCheapDisposed();\n    const runWithOwner = _with();\n    queueMicrotask(() => {\n        if (disposed())\n            return;\n        runWithOwner(fn);\n    });\n};\n/* EXPORT */\nexport default useMicrotask;\n","/* IMPORT */\nimport { isString } from './lang.js';\n/* MAIN */\n// This function exists to optimize memory usage in some cases, where the classList API won't be touched without sacrificing performance\nconst classesToggle = (element, classes, force) => {\n    const { className } = element;\n    /* OPTIMIZED PATH */\n    if (isString(className)) {\n        if (!className) { // Optimized addition/deletion\n            if (force) { // Optimized addition\n                element.className = classes;\n                return;\n            }\n            else { // Optimized deletion, nothing to do really\n                return;\n            }\n        }\n        else if (!force && className === classes) { // Optimized deletion\n            element.className = '';\n            return;\n        }\n    }\n    /* REGULAR PATH */\n    if (classes.includes(' ')) {\n        classes.split(' ').forEach(cls => {\n            if (!cls.length)\n                return;\n            element.classList.toggle(cls, !!force);\n        });\n    }\n    else {\n        element.classList.toggle(classes, !!force);\n    }\n};\n/* EXPORT */\nexport { classesToggle };\n","/**\n * ISC License\n *\n * Copyright (c) 2020, Andrea Giammarchi, @WebReflection\n *\n * Permission to use, copy, modify, and/or distribute this software for any\n * purpose with or without fee is hereby granted, provided that the above\n * copyright notice and this permission notice appear in all copies.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n * AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n * PERFORMANCE OF THIS SOFTWARE.\n */\n/* MAIN */\n// This is just a slightly customized version of udomdiff: with types, no accessor function and support for diffing unwrapped nodes\nconst dummyNode = document.createComment('');\nconst beforeDummyWrapper = [dummyNode];\nconst afterDummyWrapper = [dummyNode];\nconst diff = (parent, before, after, nextSibling) => {\n    if (before === after)\n        return;\n    if (before instanceof Node) {\n        beforeDummyWrapper[0] = before;\n        before = beforeDummyWrapper;\n    }\n    if (after instanceof Node) {\n        afterDummyWrapper[0] = after;\n        after = afterDummyWrapper;\n    }\n    const bLength = after.length;\n    let aEnd = before.length;\n    let bEnd = bLength;\n    let aStart = 0;\n    let bStart = 0;\n    let map = null;\n    let removable;\n    while (aStart < aEnd || bStart < bEnd) {\n        // append head, tail, or nodes in between: fast path\n        if (aEnd === aStart) {\n            // we could be in a situation where the rest of nodes that\n            // need to be added are not at the end, and in such case\n            // the node to `insertBefore`, if the index is more than 0\n            // must be retrieved, otherwise it's gonna be the first item.\n            const node = bEnd < bLength ?\n                (bStart ?\n                    (after[bStart - 1].nextSibling) :\n                    after[bEnd - bStart]) :\n                nextSibling;\n            if (bStart < bEnd) {\n                // parent.insertBefore(after[bStart++], node);\n                if (node) {\n                    node.before.apply(node, after.slice(bStart, bEnd));\n                }\n                else {\n                    parent.append.apply(parent, after.slice(bStart, bEnd));\n                }\n                bStart = bEnd;\n            }\n        }\n        // remove head or tail: fast path\n        else if (bEnd === bStart) {\n            while (aStart < aEnd) {\n                // remove the node only if it's unknown or not live\n                if (!map || !map.has(before[aStart])) {\n                    removable = before[aStart];\n                    try {\n                        parent.removeChild(removable);\n                    }\n                    catch {\n                        //FIXME: This try..catch block shouldn't exist, though sometimes setChildStatic wants to update the DOM immediately -- tricky\n                    }\n                }\n                aStart++;\n            }\n        }\n        // same node: fast path\n        else if (before[aStart] === after[bStart]) {\n            aStart++;\n            bStart++;\n        }\n        // same tail: fast path\n        else if (before[aEnd - 1] === after[bEnd - 1]) {\n            aEnd--;\n            bEnd--;\n        }\n        // The once here single last swap \"fast path\" has been removed in v1.1.0\n        // https://github.com/WebReflection/udomdiff/blob/single-final-swap/esm/index.js#L69-L85\n        // reverse swap: also fast path\n        else if (before[aStart] === after[bEnd - 1] &&\n            after[bStart] === before[aEnd - 1]) {\n            // this is a \"shrink\" operation that could happen in these cases:\n            // [1, 2, 3, 4, 5]\n            // [1, 4, 3, 2, 5]\n            // or asymmetric too\n            // [1, 2, 3, 4, 5]\n            // [1, 2, 3, 5, 6, 4]\n            const node = before[--aEnd].nextSibling;\n            parent.insertBefore(after[bStart++], before[aStart++].nextSibling);\n            parent.insertBefore(after[--bEnd], node);\n            // mark the future index as identical (yeah, it's dirty, but cheap )\n            // The main reason to do this, is that when a[aEnd] will be reached,\n            // the loop will likely be on the fast path, as identical to b[bEnd].\n            // In the best case scenario, the next loop will skip the tail,\n            // but in the worst one, this node will be considered as already\n            // processed, bailing out pretty quickly from the map index check\n            before[aEnd] = after[bEnd];\n        }\n        // map based fallback, \"slow\" path\n        else {\n            // the map requires an O(bEnd - bStart) operation once\n            // to store all future nodes indexes for later purposes.\n            // In the worst case scenario, this is a full O(N) cost,\n            // and such scenario happens at least when all nodes are different,\n            // but also if both first and last items of the lists are different\n            if (!map) {\n                map = new Map;\n                let i = bStart;\n                while (i < bEnd)\n                    map.set(after[i], i++);\n            }\n            // if it's a future node, hence it needs some handling\n            if (map.has(before[aStart])) {\n                // grab the index of such node, 'cause it might have been processed\n                const index = map.get(before[aStart]);\n                // if it's not already processed, look on demand for the next LCS\n                if (bStart < index && index < bEnd) {\n                    let i = aStart;\n                    // counts the amount of nodes that are the same in the future\n                    let sequence = 1;\n                    while (++i < aEnd && i < bEnd && map.get(before[i]) === (index + sequence))\n                        sequence++;\n                    // effort decision here: if the sequence is longer than replaces\n                    // needed to reach such sequence, which would brings again this loop\n                    // to the fast path, prepend the difference before a sequence,\n                    // and move only the future list index forward, so that aStart\n                    // and bStart will be aligned again, hence on the fast path.\n                    // An example considering aStart and bStart are both 0:\n                    // a: [1, 2, 3, 4]\n                    // b: [7, 1, 2, 3, 6]\n                    // this would place 7 before 1 and, from that time on, 1, 2, and 3\n                    // will be processed at zero cost\n                    if (sequence > (index - bStart)) {\n                        const node = before[aStart];\n                        if (bStart < index) {\n                            // parent.insertBefore(after[bStart++], node);\n                            if (node) {\n                                node.before.apply(node, after.slice(bStart, index));\n                            }\n                            else {\n                                parent.append.apply(parent, after.slice(bStart, index));\n                            }\n                            bStart = index;\n                        }\n                    }\n                    // if the effort wasn't good enough, fallback to a replace,\n                    // moving both source and target indexes forward, hoping that some\n                    // similar node will be found later on, to go back to the fast path\n                    else {\n                        parent.replaceChild(after[bStart++], before[aStart++]);\n                    }\n                }\n                // otherwise move the source forward, 'cause there's nothing to do\n                else\n                    aStart++;\n            }\n            // this node has no meaning in the future list, so it's more than safe\n            // to remove it, and check the next live node out instead, meaning\n            // that only the live list index should be forwarded\n            else {\n                removable = before[aStart++];\n                try {\n                    parent.removeChild(removable);\n                }\n                catch {\n                    //FIXME: This try..catch block shouldn't exist, though sometimes setChildStatic wants to update the DOM immediately -- tricky\n                }\n            }\n        }\n    }\n    beforeDummyWrapper[0] = dummyNode;\n    afterDummyWrapper[0] = dummyNode;\n};\n/* EXPORT */\nexport default diff;\n","/* IMPORT */\n/* HELPERS */\nconst NOOP_CHILDREN = [];\n/* MAIN */\nconst FragmentUtils = {\n    make: () => {\n        return {\n            values: undefined,\n            length: 0\n        };\n    },\n    makeWithNode: (node) => {\n        return {\n            values: node,\n            length: 1\n        };\n    },\n    makeWithFragment: (fragment) => {\n        return {\n            values: fragment,\n            fragmented: true,\n            length: 1\n        };\n    },\n    getChildrenFragmented: (thiz, children = []) => {\n        const { values, length } = thiz;\n        if (!length)\n            return children;\n        if (values instanceof Array) {\n            for (let i = 0, l = values.length; i < l; i++) {\n                const value = values[i];\n                if (value instanceof Node) {\n                    children.push(value);\n                }\n                else {\n                    FragmentUtils.getChildrenFragmented(value, children);\n                }\n            }\n        }\n        else {\n            if (values instanceof Node) {\n                children.push(values);\n            }\n            else {\n                FragmentUtils.getChildrenFragmented(values, children);\n            }\n        }\n        return children;\n    },\n    getChildren: (thiz) => {\n        if (!thiz.length)\n            return NOOP_CHILDREN;\n        if (!thiz.fragmented)\n            return thiz.values;\n        if (thiz.length === 1)\n            return FragmentUtils.getChildren(thiz.values);\n        return FragmentUtils.getChildrenFragmented(thiz);\n    },\n    pushFragment: (thiz, fragment) => {\n        FragmentUtils.pushValue(thiz, fragment);\n        thiz.fragmented = true;\n    },\n    pushNode: (thiz, node) => {\n        FragmentUtils.pushValue(thiz, node);\n    },\n    pushValue: (thiz, value) => {\n        const { values, length } = thiz; //TSC\n        if (length === 0) {\n            thiz.values = value;\n        }\n        else if (length === 1) {\n            thiz.values = [values, value];\n        }\n        else {\n            values.push(value);\n        }\n        thiz.length += 1;\n    },\n    replaceWithNode: (thiz, node) => {\n        thiz.values = node;\n        delete thiz.fragmented;\n        thiz.length = 1;\n    },\n    replaceWithFragment: (thiz, fragment) => {\n        thiz.values = fragment.values;\n        thiz.fragmented = fragment.fragmented;\n        thiz.length = fragment.length;\n    }\n};\n/* EXPORT */\nexport default FragmentUtils;\n","/* IMPORT */\nimport { SYMBOL_UNCACHED } from '../constants.js';\nimport isObservable from '../methods/is_observable.js';\nimport useRenderEffect from '../hooks/use_render_effect.js';\nimport $$ from '../methods/SS.js';\nimport { createText } from './creators.js';\nimport { isArray, isFunction, isFunctionReactive, isString } from './lang.js';\n/* MAIN */\nconst resolveChild = (value, setter, _dynamic = false) => {\n    if (isFunction(value)) {\n        if (!isFunctionReactive(value)) {\n            resolveChild(value(), setter, _dynamic);\n        }\n        else {\n            useRenderEffect(() => {\n                resolveChild(value(), setter, true);\n            });\n        }\n    }\n    else if (isArray(value)) {\n        const [values, hasObservables] = resolveArraysAndStatics(value);\n        values[SYMBOL_UNCACHED] = value[SYMBOL_UNCACHED]; // Preserving this special symbol\n        setter(values, hasObservables || _dynamic);\n    }\n    else {\n        setter(value, _dynamic);\n    }\n};\nconst resolveClass = (classes, resolved = {}) => {\n    if (isString(classes)) {\n        classes.split(/\\s+/g).filter(Boolean).filter(cls => {\n            resolved[cls] = true;\n        });\n    }\n    else if (isFunction(classes)) {\n        resolveClass(classes(), resolved);\n    }\n    else if (isArray(classes)) {\n        classes.forEach(cls => {\n            resolveClass(cls, resolved); //TSC\n        });\n    }\n    else if (classes) {\n        for (const key in classes) {\n            const value = classes[key];\n            const isActive = !!$$(value);\n            if (!isActive)\n                continue;\n            resolved[key] = true;\n        }\n    }\n    return resolved;\n};\nconst resolveArraysAndStatics = (() => {\n    // This function does 3 things:\n    // 1. It deeply flattens the array, only if actually needed though (!)\n    // 2. It resolves statics, it's important to resolve them soon enough or they will be re-created multiple times (!)\n    // 3. It checks if we found any Observables along the way, avoiding looping over the array another time in the future\n    const DUMMY_RESOLVED = [];\n    const resolveArraysAndStaticsInner = (values, resolved, hasObservables) => {\n        for (let i = 0, l = values.length; i < l; i++) {\n            const value = values[i];\n            const type = typeof value;\n            if (type === 'string' || type === 'number' || type === 'bigint') { // Static\n                if (resolved === DUMMY_RESOLVED)\n                    resolved = values.slice(0, i);\n                resolved.push(createText(value));\n            }\n            else if (type === 'object' && isArray(value)) { // Array\n                if (resolved === DUMMY_RESOLVED)\n                    resolved = values.slice(0, i);\n                hasObservables = resolveArraysAndStaticsInner(value, resolved, hasObservables)[1];\n            }\n            else if (type === 'function' && isObservable(value)) { // Observable\n                if (resolved !== DUMMY_RESOLVED)\n                    resolved.push(value);\n                hasObservables = true;\n            }\n            else { // Something else\n                if (resolved !== DUMMY_RESOLVED)\n                    resolved.push(value);\n            }\n        }\n        if (resolved === DUMMY_RESOLVED)\n            resolved = values;\n        return [resolved, hasObservables];\n    };\n    return (values) => {\n        return resolveArraysAndStaticsInner(values, DUMMY_RESOLVED, false);\n    };\n})();\n/* EXPORT */\nexport { resolveChild, resolveClass, resolveArraysAndStatics };\n","/* IMPORT */\nimport { DIRECTIVES, SYMBOLS_DIRECTIVES, SYMBOL_UNCACHED } from '../constants.js';\nimport useMicrotask from '../hooks/use_microtask.js';\nimport useRenderEffect from '../hooks/use_render_effect.js';\nimport isStore from '../methods/is_store.js';\nimport $$ from '../methods/SS.js';\nimport store from '../methods/store.js';\nimport untrack from '../methods/untrack.js';\nimport { context, with as _with } from '../oby.js';\nimport { SYMBOL_STORE_OBSERVABLE } from '../oby.js';\nimport { classesToggle } from './classlist.js';\nimport { createText, createComment } from './creators.js';\nimport diff from './diff.js';\nimport FragmentUtils from './fragment.js';\nimport { castArray, flatten, isArray, isBoolean, isFunction, isFunctionReactive, isNil, isString, isSVG, isTemplateAccessor } from './lang.js';\nimport { resolveChild, resolveClass } from './resolvers.js';\n/* MAIN */\nconst setAttributeStatic = (() => {\n    const attributesBoolean = new Set(['allowfullscreen', 'async', 'autofocus', 'autoplay', 'checked', 'controls', 'default', 'disabled', 'formnovalidate', 'hidden', 'indeterminate', 'ismap', 'loop', 'multiple', 'muted', 'nomodule', 'novalidate', 'open', 'playsinline', 'readonly', 'required', 'reversed', 'seamless', 'selected']);\n    const attributeCamelCasedRe = /e(r[HRWrv]|[Vawy])|Con|l(e[Tcs]|c)|s(eP|y)|a(t[rt]|u|v)|Of|Ex|f[XYa]|gt|hR|d[Pg]|t[TXYd]|[UZq]/; //URL: https://regex101.com/r/I8Wm4S/1\n    const attributesCache = {};\n    const uppercaseRe = /[A-Z]/g;\n    const normalizeKeySvg = (key) => {\n        return attributesCache[key] || (attributesCache[key] = attributeCamelCasedRe.test(key) ? key : key.replace(uppercaseRe, char => `-${char.toLowerCase()}`));\n    };\n    return (element, key, value) => {\n        if (isSVG(element)) {\n            key = (key === 'xlinkHref' || key === 'xlink:href') ? 'href' : normalizeKeySvg(key);\n            if (isNil(value) || (value === false && attributesBoolean.has(key))) {\n                element.removeAttribute(key);\n            }\n            else {\n                element.setAttribute(key, String(value));\n            }\n        }\n        else {\n            if (isNil(value) || (value === false && attributesBoolean.has(key))) {\n                element.removeAttribute(key);\n            }\n            else {\n                value = (value === true) ? '' : String(value);\n                element.setAttribute(key, value);\n            }\n        }\n    };\n})();\nconst setAttribute = (element, key, value) => {\n    if (isFunction(value) && isFunctionReactive(value)) {\n        useRenderEffect(() => {\n            setAttributeStatic(element, key, value());\n        });\n    }\n    else {\n        setAttributeStatic(element, key, $$(value));\n    }\n};\nconst setChildReplacementFunction = (parent, fragment, child) => {\n    useRenderEffect(() => {\n        let valueNext = child();\n        while (isFunction(valueNext)) {\n            valueNext = valueNext();\n        }\n        setChildStatic(parent, fragment, false, valueNext, true);\n    });\n};\nconst setChildReplacementText = (child, childPrev) => {\n    if (childPrev.nodeType === 3) {\n        childPrev.nodeValue = child;\n        return childPrev;\n    }\n    else {\n        const parent = childPrev.parentElement;\n        if (!parent)\n            throw new Error('Invalid child replacement');\n        const textNode = createText(child);\n        parent.replaceChild(textNode, childPrev);\n        return textNode;\n    }\n};\nconst setChildReplacement = (child, childPrev) => {\n    const type = typeof child;\n    if (type === 'string' || type === 'number' || type === 'bigint') {\n        setChildReplacementText(String(child), childPrev);\n    }\n    else {\n        const parent = childPrev.parentElement;\n        if (!parent)\n            throw new Error('Invalid child replacement');\n        const fragment = FragmentUtils.makeWithNode(childPrev);\n        if (type === 'function') {\n            setChildReplacementFunction(parent, fragment, child); //TSC\n        }\n        else {\n            setChild(parent, child, fragment);\n        }\n    }\n};\nconst setChildStatic = (parent, fragment, fragmentOnly, child, dynamic) => {\n    if (!dynamic && child === undefined)\n        return; // Ignoring static undefined children, avoiding inserting some useless placeholder nodes\n    const prev = FragmentUtils.getChildren(fragment);\n    const prevIsArray = (prev instanceof Array);\n    const prevLength = prevIsArray ? prev.length : 1;\n    const prevFirst = prevIsArray ? prev[0] : prev;\n    const prevLast = prevIsArray ? prev[prevLength - 1] : prev;\n    const prevSibling = prevLast?.nextSibling || null;\n    if (prevLength === 0) { // Fast path for appending a node the first time\n        const type = typeof child;\n        if (type === 'string' || type === 'number' || type === 'bigint') {\n            const textNode = createText(child);\n            if (!fragmentOnly) {\n                parent.appendChild(textNode);\n            }\n            FragmentUtils.replaceWithNode(fragment, textNode);\n            return;\n        }\n        else if (type === 'object' && child !== null && typeof child.nodeType === 'number') { //TSC\n            const node = child;\n            if (!fragmentOnly) {\n                parent.insertBefore(node, null);\n            }\n            FragmentUtils.replaceWithNode(fragment, node);\n            return;\n        }\n    }\n    if (prevLength === 1) { // Fast path for single text child\n        const type = typeof child;\n        if (type === 'string' || type === 'number' || type === 'bigint') {\n            const node = setChildReplacementText(String(child), prevFirst); //TODO: maybe \"fragmentOnly\" should be passed on here, but it seems unnecessary\n            FragmentUtils.replaceWithNode(fragment, node);\n            return;\n        }\n    }\n    const fragmentNext = FragmentUtils.make();\n    const children = (Array.isArray(child) ? child : [child]); //TSC\n    for (let i = 0, l = children.length; i < l; i++) {\n        const child = children[i];\n        const type = typeof child;\n        if (type === 'string' || type === 'number' || type === 'bigint') {\n            FragmentUtils.pushNode(fragmentNext, createText(child));\n        }\n        else if (type === 'object' && child !== null && typeof child.nodeType === 'number') {\n            FragmentUtils.pushNode(fragmentNext, child);\n        }\n        else if (type === 'function') {\n            const fragment = FragmentUtils.make();\n            let childFragmentOnly = !fragmentOnly; // Avoiding mutating the DOM immediately, letting the parent handle it\n            FragmentUtils.pushFragment(fragmentNext, fragment);\n            resolveChild(child, (child, dynamic) => {\n                const fragmentOnly = childFragmentOnly;\n                childFragmentOnly = false;\n                setChildStatic(parent, fragment, fragmentOnly, child, dynamic);\n            });\n        }\n    }\n    let next = FragmentUtils.getChildren(fragmentNext);\n    let nextLength = fragmentNext.length;\n    if (nextLength === 0 && prevLength === 1 && prevFirst.nodeType === 8) { // It's a placeholder already, no need to replace it\n        return;\n    }\n    if (!fragmentOnly && (nextLength === 0 || (prevLength === 1 && prevFirst.nodeType === 8) || children[SYMBOL_UNCACHED])) { // Fast path for removing all children and/or replacing the placeholder\n        const { childNodes } = parent;\n        if (childNodes.length === prevLength) { // Maybe this fragment doesn't handle all children but only a range of them, checking for that here\n            parent.textContent = '';\n            if (nextLength === 0) { // Placeholder, to keep the right spot in the array of children\n                const placeholder = createComment();\n                FragmentUtils.pushNode(fragmentNext, placeholder);\n                if (next !== fragmentNext.values) {\n                    next = placeholder;\n                    nextLength += 1;\n                }\n            }\n            if (prevSibling) {\n                if (next instanceof Array) {\n                    prevSibling.before.apply(prevSibling, next);\n                }\n                else {\n                    parent.insertBefore(next, prevSibling);\n                }\n            }\n            else {\n                if (next instanceof Array) {\n                    parent.append.apply(parent, next);\n                }\n                else {\n                    parent.append(next);\n                }\n            }\n            FragmentUtils.replaceWithFragment(fragment, fragmentNext);\n            return;\n        }\n    }\n    if (nextLength === 0) { // Placeholder, to keep the right spot in the array of children\n        const placeholder = createComment();\n        FragmentUtils.pushNode(fragmentNext, placeholder);\n        if (next !== fragmentNext.values) {\n            next = placeholder;\n            nextLength += 1;\n        }\n    }\n    if (!fragmentOnly) {\n        diff(parent, prev, next, prevSibling);\n    }\n    FragmentUtils.replaceWithFragment(fragment, fragmentNext);\n};\nconst setChild = (parent, child, fragment = FragmentUtils.make()) => {\n    resolveChild(child, setChildStatic.bind(undefined, parent, fragment, false));\n};\nconst setClassStatic = classesToggle;\nconst setClass = (element, key, value) => {\n    if (isFunction(value) && isFunctionReactive(value)) {\n        useRenderEffect(() => {\n            setClassStatic(element, key, value());\n        });\n    }\n    else {\n        setClassStatic(element, key, $$(value));\n    }\n};\nconst setClassBooleanStatic = (element, value, key, keyPrev) => {\n    if (keyPrev && keyPrev !== true) {\n        setClassStatic(element, keyPrev, false);\n    }\n    if (key && key !== true) {\n        setClassStatic(element, key, value);\n    }\n};\nconst setClassBoolean = (element, value, key) => {\n    if (isFunction(key) && isFunctionReactive(key)) {\n        let keyPrev;\n        useRenderEffect(() => {\n            const keyNext = key();\n            setClassBooleanStatic(element, value, keyNext, keyPrev);\n            keyPrev = keyNext;\n        });\n    }\n    else {\n        setClassBooleanStatic(element, value, $$(key));\n    }\n};\nconst setClassesStatic = (element, object, objectPrev) => {\n    if (isString(object)) {\n        if (isSVG(element)) {\n            element.setAttribute('class', object);\n        }\n        else {\n            element.className = object;\n        }\n    }\n    else {\n        if (objectPrev) {\n            if (isString(objectPrev)) {\n                if (objectPrev) {\n                    if (isSVG(element)) {\n                        element.setAttribute('class', '');\n                    }\n                    else {\n                        element.className = '';\n                    }\n                }\n            }\n            else if (isArray(objectPrev)) {\n                objectPrev = store.unwrap(objectPrev);\n                for (let i = 0, l = objectPrev.length; i < l; i++) {\n                    if (!objectPrev[i])\n                        continue;\n                    setClassBoolean(element, false, objectPrev[i]);\n                }\n            }\n            else {\n                objectPrev = store.unwrap(objectPrev);\n                for (const key in objectPrev) {\n                    if (object && key in object)\n                        continue;\n                    setClass(element, key, false);\n                }\n            }\n        }\n        if (isArray(object)) {\n            if (isStore(object)) {\n                for (let i = 0, l = object.length; i < l; i++) {\n                    const fn = untrack(() => isFunction(object[i]) ? object[i] : object[SYMBOL_STORE_OBSERVABLE](String(i))); //TSC\n                    setClassBoolean(element, true, fn);\n                }\n            }\n            else {\n                for (let i = 0, l = object.length; i < l; i++) {\n                    if (!object[i])\n                        continue;\n                    setClassBoolean(element, true, object[i]);\n                }\n            }\n        }\n        else {\n            if (isStore(object)) {\n                for (const key in object) {\n                    const fn = untrack(() => isFunction(object[key]) ? object[key] : object[SYMBOL_STORE_OBSERVABLE](key)); //TSC\n                    setClass(element, key, fn);\n                }\n            }\n            else {\n                for (const key in object) {\n                    setClass(element, key, object[key]);\n                }\n            }\n        }\n    }\n};\nconst setClasses = (element, object) => {\n    if (isFunction(object) || isArray(object)) {\n        let objectPrev;\n        useRenderEffect(() => {\n            const objectNext = resolveClass(object);\n            setClassesStatic(element, objectNext, objectPrev);\n            objectPrev = objectNext;\n        });\n    }\n    else {\n        setClassesStatic(element, object);\n    }\n};\nconst setDirective = (element, directive, args) => {\n    const symbol = SYMBOLS_DIRECTIVES[directive] || Symbol();\n    const data = context(symbol) || DIRECTIVES[symbol];\n    if (!data)\n        throw new Error(`Directive \"${directive}\" not found`);\n    const call = () => data.fn(element, ...castArray(args)); //TSC\n    if (data.immediate) {\n        call();\n    }\n    else {\n        useMicrotask(call);\n    }\n};\nconst setEventStatic = (() => {\n    //TODO: Maybe delete event delegation\n    //TODO: Maybe delegate more events: [onmousemove, onmouseout, onmouseover, onpointerdown, onpointermove, onpointerout, onpointerover, onpointerup, ontouchend, ontouchmove, ontouchstart]\n    const delegatedEvents = {\n        onauxclick: ['_onauxclick', false],\n        onbeforeinput: ['_onbeforeinput', false],\n        onclick: ['_onclick', false],\n        ondblclick: ['_ondblclick', false],\n        onfocusin: ['_onfocusin', false],\n        onfocusout: ['_onfocusout', false],\n        oninput: ['_oninput', false],\n        onkeydown: ['_onkeydown', false],\n        onkeyup: ['_onkeyup', false],\n        onmousedown: ['_onmousedown', false],\n        onmouseup: ['_onmouseup', false]\n    };\n    const delegate = (event) => {\n        const key = `_${event}`;\n        document.addEventListener(event.slice(2), event => {\n            const targets = event.composedPath();\n            let target = null;\n            Object.defineProperty(event, 'currentTarget', {\n                configurable: true,\n                get() {\n                    return target;\n                }\n            });\n            for (let i = 0, l = targets.length; i < l; i++) {\n                target = targets[i];\n                const handler = target[key];\n                if (!handler)\n                    continue;\n                handler(event);\n                if (event.cancelBubble)\n                    break;\n            }\n            target = null;\n        });\n    };\n    return (element, event, value) => {\n        if (event.startsWith('onmiddleclick')) { // Special-cased synthetic event, somewhat ugly but very convenient\n            const _value = value;\n            event = `onauxclick${event.slice(13)}`;\n            value = _value && ((event) => event['button'] === 1 && _value(event));\n        }\n        const delegated = delegatedEvents[event];\n        if (delegated) {\n            if (!delegated[1]) { // Not actually delegating yet\n                delegated[1] = true;\n                delegate(event);\n            }\n            element[delegated[0]] = value;\n        }\n        else if (event.endsWith('passive')) {\n            const isCapture = event.endsWith('capturepassive');\n            const type = event.slice(2, -7 - (isCapture ? 7 : 0));\n            const key = `_${event}`;\n            const valuePrev = element[key];\n            if (valuePrev)\n                element.removeEventListener(type, valuePrev, { capture: isCapture });\n            if (value)\n                element.addEventListener(type, value, { passive: true, capture: isCapture });\n            element[key] = value;\n        }\n        else if (event.endsWith('capture')) {\n            const type = event.slice(2, -7);\n            const key = `_${event}`;\n            const valuePrev = element[key];\n            if (valuePrev)\n                element.removeEventListener(type, valuePrev, { capture: true });\n            if (value)\n                element.addEventListener(type, value, { capture: true });\n            element[key] = value;\n        }\n        else {\n            element[event] = value;\n        }\n    };\n})();\nconst setEvent = (element, event, value) => {\n    setEventStatic(element, event, value);\n};\nconst setHTMLStatic = (element, value) => {\n    element.innerHTML = String(isNil(value) ? '' : value);\n};\nconst setHTML = (element, value) => {\n    useRenderEffect(() => {\n        setHTMLStatic(element, $$($$(value).__html));\n    });\n};\nconst setPropertyStatic = (element, key, value) => {\n    if (key === 'tabIndex' && isBoolean(value)) {\n        value = value ? 0 : undefined;\n    }\n    if (key === 'value' && element.tagName === 'SELECT' && !element['_$inited']) {\n        element['_$inited'] = true;\n        queueMicrotask(() => element[key] = value);\n    }\n    element[key] = value;\n    if (isNil(value)) {\n        setAttributeStatic(element, key, null);\n    }\n};\nconst setProperty = (element, key, value) => {\n    if (isFunction(value) && isFunctionReactive(value)) {\n        useRenderEffect(() => {\n            setPropertyStatic(element, key, value());\n        });\n    }\n    else {\n        setPropertyStatic(element, key, $$(value));\n    }\n};\nconst setRef = (element, value) => {\n    if (isNil(value))\n        return;\n    const values = flatten(castArray(value)).filter(Boolean);\n    if (!values.length)\n        return;\n    useMicrotask(() => untrack(() => values.forEach(value => value?.(element))));\n};\nconst setStyleStatic = (() => {\n    // From Preact: https://github.com/preactjs/preact/blob/e703a62b77c9de45e886d8a7f59bd0db658318f9/src/constants.js#L3\n    // const propertyNonDimensionalRe = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;\n    // From this Preact issue: https://github.com/preactjs/preact/issues/2607\n    const propertyNonDimensionalRe = /^(-|f[lo].*[^se]$|g.{5,}[^ps]$|z|o[pr]|(W.{5})?[lL]i.*(t|mp)$|an|(bo|s).{4}Im|sca|m.{6}[ds]|ta|c.*[st]$|wido|ini)/i;\n    const propertyNonDimensionalCache = {};\n    return (element, key, value) => {\n        if (key.charCodeAt(0) === 45) { // /^-/\n            if (isNil(value)) {\n                element.style.removeProperty(key);\n            }\n            else {\n                element.style.setProperty(key, String(value));\n            }\n        }\n        else if (isNil(value)) {\n            element.style[key] = null;\n        }\n        else {\n            element.style[key] = (isString(value) || (propertyNonDimensionalCache[key] || (propertyNonDimensionalCache[key] = propertyNonDimensionalRe.test(key))) ? value : `${value}px`);\n        }\n    };\n})();\nconst setStyle = (element, key, value) => {\n    if (isFunction(value) && isFunctionReactive(value)) {\n        useRenderEffect(() => {\n            setStyleStatic(element, key, value());\n        });\n    }\n    else {\n        setStyleStatic(element, key, $$(value));\n    }\n};\nconst setStylesStatic = (element, object, objectPrev) => {\n    if (isString(object)) {\n        element.setAttribute('style', object);\n    }\n    else {\n        if (objectPrev) {\n            if (isString(objectPrev)) {\n                if (objectPrev) {\n                    element.style.cssText = '';\n                }\n            }\n            else {\n                objectPrev = store.unwrap(objectPrev);\n                for (const key in objectPrev) {\n                    if (object && key in object)\n                        continue;\n                    setStyleStatic(element, key, null);\n                }\n            }\n        }\n        if (isStore(object)) {\n            for (const key in object) {\n                const fn = untrack(() => isFunction(object[key]) ? object[key] : object[SYMBOL_STORE_OBSERVABLE](key)); //TSC\n                setStyle(element, key, fn);\n            }\n        }\n        else {\n            for (const key in object) {\n                setStyle(element, key, object[key]);\n            }\n        }\n    }\n};\nconst setStyles = (element, object) => {\n    if (isFunction(object) && isFunctionReactive(object)) {\n        let objectPrev;\n        useRenderEffect(() => {\n            const objectNext = object();\n            setStylesStatic(element, objectNext, objectPrev);\n            objectPrev = objectNext;\n        });\n    }\n    else {\n        setStylesStatic(element, $$(object));\n    }\n};\nconst setTemplateAccessor = (element, key, value) => {\n    if (key === 'children') {\n        const placeholder = createText(''); // Using a Text node rather than a Comment as the former may be what we actually want ultimately\n        element.insertBefore(placeholder, null);\n        value(element, 'setChildReplacement', undefined, placeholder);\n    }\n    else if (key === 'ref') {\n        value(element, 'setRef');\n    }\n    else if (key === 'style') {\n        value(element, 'setStyles');\n    }\n    else if (key === 'class') {\n        if (!isSVG(element)) {\n            element.className = ''; // Ensuring the attribute is present\n        }\n        value(element, 'setClasses');\n    }\n    else if (key === 'dangerouslySetInnerHTML') {\n        value(element, 'setHTML');\n    }\n    else if (key.charCodeAt(0) === 111 && key.charCodeAt(1) === 110) { // /^on/\n        value(element, 'setEvent', key.toLowerCase());\n    }\n    else if (key.charCodeAt(0) === 117 && key.charCodeAt(3) === 58) { // /^u..:/\n        value(element, 'setDirective', key.slice(4));\n    }\n    else if (key === 'innerHTML' || key === 'outerHTML' || key === 'textContent' || key === 'className') {\n        // Forbidden props\n    }\n    else if (key in element && !isSVG(element)) {\n        value(element, 'setProperty', key);\n    }\n    else {\n        element.setAttribute(key, ''); // Ensuring the attribute is present\n        value(element, 'setAttribute', key);\n    }\n};\nconst setProp = (element, key, value) => {\n    if (isTemplateAccessor(value)) {\n        setTemplateAccessor(element, key, value);\n    }\n    else if (key === 'children') {\n        setChild(element, value);\n    }\n    else if (key === 'ref') {\n        setRef(element, value);\n    }\n    else if (key === 'style') {\n        setStyles(element, value);\n    }\n    else if (key === 'class') {\n        setClasses(element, value);\n    }\n    else if (key === 'dangerouslySetInnerHTML') {\n        setHTML(element, value);\n    }\n    else if (key.charCodeAt(0) === 111 && key.charCodeAt(1) === 110) { // /^on/\n        setEvent(element, key.toLowerCase(), value);\n    }\n    else if (key.charCodeAt(0) === 117 && key.charCodeAt(3) === 58) { // /^u..:/\n        setDirective(element, key.slice(4), value);\n    }\n    else if (key === 'innerHTML' || key === 'outerHTML' || key === 'textContent' || key === 'className') {\n        // Forbidden props\n    }\n    else if (key in element && !isSVG(element)) {\n        setProperty(element, key, value);\n    }\n    else {\n        setAttribute(element, key, value);\n    }\n};\nconst setProps = (element, object) => {\n    for (const key in object) {\n        setProp(element, key, object[key]);\n    }\n};\n/* EXPORT */\nexport { setAttributeStatic, setAttribute, setChildReplacementFunction, setChildReplacementText, setChildReplacement, setChildStatic, setChild, setClassStatic, setClass, setClassBooleanStatic, setClassesStatic, setClasses, setEventStatic, setEvent, setHTMLStatic, setHTML, setPropertyStatic, setProperty, setRef, setStyleStatic, setStyle, setStylesStatic, setStyles, setTemplateAccessor, setProp, setProps };\n","/* IMPORT */\nimport untrack from './untrack.js';\nimport wrapElement from './wrap_element.js';\nimport { createHTMLNode, createSVGNode } from '../utils/creators.js';\nimport { isFunction, isNil, isNode, isString, isSVGElement, isVoidChild } from '../utils/lang.js';\nimport { setProps } from '../utils/setters.js';\n/* MAIN */\n// It's important to wrap components, so that they can be executed in the right order, from parent to child, rather than from child to parent in some cases\nconst createElement = (component, props, ..._children) => {\n    const { children: __children, key, ref, ...rest } = (props || {}); //TSC\n    const children = (_children.length === 1) ? _children[0] : (_children.length === 0) ? __children : _children;\n    if (isFunction(component)) {\n        const props = rest;\n        if (!isNil(children))\n            props.children = children;\n        if (!isNil(ref))\n            props.ref = ref;\n        return wrapElement(() => {\n            return untrack(() => component.call(component, props)); //TSC\n        });\n    }\n    else if (isString(component)) {\n        const props = rest;\n        const isSVG = isSVGElement(component);\n        const createNode = isSVG ? createSVGNode : createHTMLNode;\n        if (!isVoidChild(children))\n            props.children = children;\n        if (!isNil(ref))\n            props.ref = ref;\n        return wrapElement(() => {\n            const child = createNode(component); //TSC\n            if (isSVG)\n                child['isSVG'] = true;\n            untrack(() => setProps(child, props));\n            return child;\n        });\n    }\n    else if (isNode(component)) {\n        return wrapElement(() => component);\n    }\n    else {\n        throw new Error('Invalid component');\n    }\n};\n/* EXPORT */\nexport default createElement;\n","/* IMPORT */\nimport useMemo from '../hooks/use_memo.js';\nimport createElement from '../methods/create_element.js';\nimport resolve from '../methods/resolve.js';\nimport $$ from '../methods/SS.js';\n/* MAIN */\nconst Dynamic = ({ component, props, children }) => {\n    return useMemo(() => {\n        return resolve(createElement($$(component, false), $$(props), children));\n    });\n};\n/* EXPORT */\nexport default Dynamic;\n","/* IMPORT */\nimport untrack from '../methods/untrack.js';\nimport { tryCatch } from '../oby.js';\nimport { isFunction } from '../utils/lang.js';\n/* MAIN */\nconst ErrorBoundary = ({ fallback, children }) => {\n    return tryCatch(children, props => untrack(() => isFunction(fallback) ? fallback(props) : fallback));\n};\n/* EXPORT */\nexport default ErrorBoundary;\n","/* IMPORT */\nimport { for as _for } from '../oby.js';\nfunction For({ values, fallback, pooled, unkeyed, children }) {\n    return _for(values, children, fallback, { pooled, unkeyed }); //TSC\n}\n/* EXPORT */\nexport default For;\n","/* IMPORT */\nimport cleanup from './cleanup.js';\nimport CacheKeyed from './for.cache.keyed.js';\nimport CacheUnkeyed from './for.cache.unkeyed.js';\nimport get from './get.js';\nimport isStore from './is_store.js';\nimport memo from './memo.js';\nimport resolve from './resolve.js';\nimport untrack from './untrack.js';\nimport { SYMBOL_CACHED, SYMBOL_STORE_VALUES } from '../symbols.js';\nimport { isArray, isEqual } from '../utils.js';\nfunction _for(values, fn, fallback = [], options) {\n    const { Q, map } = options?.unkeyed ? new CacheUnkeyed(fn, !!options.pooled) : new CacheKeyed(fn); //TSC\n    cleanup(Q);\n    const value = memo(() => {\n        return get(values);\n    }, {\n        equals: (next, prev) => {\n            return !!next && !!prev && !next.length && !prev.length && !isStore(next) && !isStore(prev);\n        }\n    });\n    return memo(() => {\n        const array = value();\n        if (isStore(array)) {\n            array[SYMBOL_STORE_VALUES];\n        }\n        return untrack(() => {\n            const results = map(array);\n            return results?.length ? results : resolve(fallback);\n        });\n    }, {\n        equals: (next, prev) => {\n            return isArray(next) && !!next[SYMBOL_CACHED] && isArray(prev) && isEqual(next, prev);\n        }\n    });\n}\n/* EXPORT */\nexport default _for;\n","/* IMPORT */\n/* MAIN */\nconst Fragment = ({ children }) => {\n    return children;\n};\n/* EXPORT */\nexport default Fragment;\n","/* IMPORT */\nimport useMemo from './use_memo.js';\nimport $$ from '../methods/SS.js';\nimport { isNil } from '../utils/lang.js';\n/* MAIN */\n//TODO: Maybe port this to oby, as \"when\" or \"is\" or \"guarded\"\n//TODO: Optimize this, checking if the value is actually potentially reactive\nconst useGuarded = (value, guard) => {\n    let valueLast;\n    const guarded = useMemo(() => {\n        const current = $$(value);\n        if (!guard(current))\n            return valueLast;\n        return valueLast = current;\n    });\n    return () => {\n        const current = guarded();\n        if (isNil(current))\n            throw new Error('The value never passed the type guard');\n        return current;\n    };\n};\n/* EXPORT */\nexport default useGuarded;\n","/* IMPORT */\nimport isObservable from '../methods/is_observable.js';\nimport useGuarded from '../hooks/use_guarded.js';\nimport useUntracked from '../hooks/use_untracked.js';\nimport { ternary } from '../oby.js';\nimport { isComponent, isFunction, isTruthy } from '../utils/lang.js';\n/* MAIN */\n//TODO: Support an is/guard prop, maybe\nconst If = ({ when, fallback, children }) => {\n    if (isFunction(children) && !isObservable(children) && !isComponent(children)) { // Calling the children function with an (() => Truthy<T>)\n        const truthy = useGuarded(when, isTruthy);\n        return ternary(when, useUntracked(() => children(truthy)), fallback);\n    }\n    else { // Just passing the children along\n        return ternary(when, children, fallback); //TSC\n    }\n};\n/* EXPORT */\nexport default If;\n","/* IMPORT */\nimport useCleanup from '../hooks/use_cleanup.js';\nimport useMemo from '../hooks/use_memo.js';\nimport useResolved from '../hooks/use_resolved.js';\nimport useRoot from '../hooks/use_root.js';\nimport useSuspense from '../hooks/use_suspense.js';\nimport resolve from '../methods/resolve.js';\nimport $ from '../methods/S.js';\nimport { with as _with } from '../oby.js';\n/* HELPERS */\nconst cache = {};\nconst runWithSuperRoot = _with();\nlet lockId = 1;\n/* MAIN */\n//TODO: Support hot-swapping owner and context, to make the context JustWork\nconst KeepAlive = ({ id, ttl, children }) => {\n    return useMemo(() => {\n        return useResolved([id, ttl], (id, ttl) => {\n            const lock = lockId++;\n            const item = cache[id] || (cache[id] = { id, lock });\n            item.lock = lock;\n            item.reset?.();\n            item.suspended || (item.suspended = $(false));\n            item.suspended(false);\n            if (!item.dispose || !item.result) {\n                runWithSuperRoot(() => {\n                    useRoot(dispose => {\n                        item.dispose = () => {\n                            delete cache[id];\n                            dispose();\n                        };\n                        useSuspense(item.suspended, () => {\n                            item.result = resolve(children);\n                        });\n                    });\n                });\n            }\n            useCleanup(() => {\n                const hasLock = () => lock === item.lock;\n                if (!hasLock())\n                    return;\n                item.suspended?.(true);\n                if (!ttl || ttl <= 0 || ttl >= Infinity)\n                    return;\n                const dispose = () => hasLock() && item.dispose?.();\n                const timeoutId = setTimeout(dispose, ttl);\n                const reset = () => clearTimeout(timeoutId);\n                item.reset = reset;\n            });\n            return item.result;\n        });\n    });\n};\n/* EXPORT */\nexport default KeepAlive;\n","/* IMPORT */\nimport useRoot from '../hooks/use_root.js';\nimport { setChild } from '../utils/setters.js';\n/* MAIN */\nconst render = (child, parent) => {\n    if (!parent || !(parent instanceof HTMLElement))\n        throw new Error('Invalid parent node');\n    parent.textContent = '';\n    return useRoot(dispose => {\n        setChild(parent, child);\n        return () => {\n            dispose();\n            parent.textContent = '';\n        };\n    });\n};\n/* EXPORT */\nexport default render;\n","/* IMPORT */\nimport useBoolean from '../hooks/use_boolean.js';\nimport useRenderEffect from '../hooks/use_render_effect.js';\nimport render from '../methods/render.js';\nimport $$ from '../methods/SS.js';\nimport { createHTMLNode } from '../utils/creators.js';\nimport { assign } from '../utils/lang.js';\n/* MAIN */\nconst Portal = ({ when = true, mount, wrapper, children }) => {\n    const portal = $$(wrapper) || createHTMLNode('div');\n    if (!(portal instanceof HTMLElement))\n        throw new Error('Invalid wrapper node');\n    const condition = useBoolean(when);\n    useRenderEffect(() => {\n        if (!$$(condition))\n            return;\n        const parent = $$(mount) || document.body;\n        if (!(parent instanceof Element))\n            throw new Error('Invalid mount node');\n        parent.insertBefore(portal, null);\n        return () => {\n            parent.removeChild(portal);\n        };\n    });\n    useRenderEffect(() => {\n        if (!$$(condition))\n            return;\n        return render(children, portal);\n    });\n    return assign(() => $$(condition) || children, { metadata: { portal } });\n};\n/* EXPORT */\nexport default Portal;\n","/* IMPORT */\nimport SuspenseContext from './suspense.context.js';\nimport useMemo from '../hooks/use_memo.js';\nimport useSuspense from '../hooks/use_suspense.js';\nimport resolve from '../methods/resolve.js';\nimport $$ from '../methods/SS.js';\nimport { suspense as _suspense, ternary } from '../oby.js';\n/* MAIN */\nconst Suspense = ({ when, fallback, children }) => {\n    return SuspenseContext.wrap(suspense => {\n        const condition = useMemo(() => !!$$(when) || suspense.active());\n        const childrenSuspended = useSuspense(condition, () => resolve(children));\n        return ternary(condition, fallback, childrenSuspended);\n    });\n};\n/* EXPORT */\nexport default Suspense;\n","/* IMPORT */\nimport { switch as _switch } from '../oby.js';\nimport { assign, castArray } from '../utils/lang.js';\n/* MAIN */\n//TODO: Enforce children of Switch to be of type Switch.Case or Switch.Default\nconst Switch = ({ when, fallback, children }) => {\n    const childrenWithValues = castArray(children); //TSC\n    const values = childrenWithValues.map(child => child().metadata);\n    return _switch(when, values, fallback); //TSC\n};\n/* UTILITIES */\nSwitch.Case = ({ when, children }) => {\n    const metadata = { metadata: [when, children] };\n    return assign(() => children, metadata);\n};\nSwitch.Default = ({ children }) => {\n    const metadata = { metadata: [children] };\n    return assign(() => children, metadata);\n};\n/* EXPORT */\nexport default Switch;\n","/* IMPORT */\nimport { ternary } from '../oby.js';\n/* MAIN */\nconst Ternary = ({ when, children }) => {\n    return ternary(when, children[0], children[1]);\n};\n/* EXPORT */\nexport default Ternary;\n","/* IMPORT */\nimport './types.js';\nimport Fragment from '../components/fragment.js';\nimport createElement from '../methods/create_element.js';\n/* MAIN */\nconst jsx = (component, props) => {\n    return createElement(component, props);\n};\n/* EXPORT */\nexport { jsx, jsx as jsxs, jsx as jsxDEV, Fragment };\n","/* IMPORT */\nimport { DIRECTIVES, SYMBOLS_DIRECTIVES } from '../constants.js';\nimport resolve from './resolve.js';\nimport { context } from '../oby.js';\n/* MAIN */\nconst createDirective = (name, fn, options) => {\n    const immediate = !!options?.immediate;\n    const data = { fn, immediate };\n    const symbol = (SYMBOLS_DIRECTIVES[name] || (SYMBOLS_DIRECTIVES[name] = Symbol()));\n    const Provider = ({ children }) => {\n        return context({ [symbol]: data }, () => {\n            return resolve(children);\n        });\n    };\n    const ref = (...args) => {\n        return (element) => {\n            fn(element, ...args);\n        };\n    };\n    const register = () => {\n        if (symbol in DIRECTIVES)\n            throw new Error('Directive \"name\" is already registered');\n        DIRECTIVES[symbol] = data;\n    };\n    return { Provider, ref, register };\n};\n/* EXPORT */\nexport default createDirective;\n","/* IMPORT */\nimport useMemo from '../hooks/use_memo.js';\nimport $ from './S.js';\nimport resolve from './resolve.js';\nimport untrack from './untrack.js';\nimport { isFunction } from '../utils/lang.js';\n/* HELPERS */\nconst COMPONENT_RE = /^_?[A-Z][a-zA-Z0-9$_-]*$/;\nconst SYMBOL_AS = '__hmr_as__';\nconst SYMBOL_COLD_COMPONENT = Symbol('HMR.Cold');\nconst SYMBOL_HOT_COMPONENT = Symbol('HMR.Hot');\nconst SYMBOL_HOT_ID = Symbol('HMR.ID');\nconst SOURCES = new WeakMap();\n/* MAIN */\n//TODO: This seems excessively complicated, maybe it can be simplified somewhat?\n//TODO: Make this work better when a nested component is added/removed too\nconst hmr = (accept, component) => {\n    if (accept) { // Making the component hot\n        /* CHECK */\n        const cached = component[SYMBOL_HOT_COMPONENT];\n        if (cached)\n            return cached; // Already hot\n        const isProvider = !isFunction(component) && ('Provider' in component);\n        if (isProvider)\n            return component; // Context/Directive providers are not hot-reloadable\n        /* HELPERS */\n        const createHotComponent = (path) => {\n            return (...args) => {\n                return useMemo(() => {\n                    const component = path.reduce((component, key) => component[key], SOURCES.get(id())?.() || source());\n                    const result = resolve(untrack(() => component(...args)));\n                    return result;\n                });\n            };\n        };\n        const createHotComponentDeep = (component, path) => {\n            const cached = component[SYMBOL_HOT_COMPONENT];\n            if (cached)\n                return cached;\n            const hot = component[SYMBOL_HOT_COMPONENT] = createHotComponent(path);\n            for (const key in component) {\n                const value = component[key];\n                if (isFunction(value) && COMPONENT_RE.test(key)) { // A component\n                    hot[key] = createHotComponentDeep(value, [...path, key]);\n                }\n                else { // Something else\n                    hot[key] = value;\n                }\n            }\n            return hot;\n        };\n        const onAccept = (module) => {\n            const hot = module[component[SYMBOL_AS]] || module[component.name] || module.default;\n            if (!hot)\n                return console.error(`[hmr] Failed to handle update for \"${component.name}\" component:\\n\\n`, component);\n            const cold = hot[SYMBOL_COLD_COMPONENT] || hot;\n            hot[SYMBOL_HOT_ID]?.(id());\n            SOURCES.get(id())?.(() => cold);\n        };\n        /* MAIN */\n        const id = $({});\n        const source = $(component);\n        SOURCES.set(id(), source);\n        const cold = component[SYMBOL_COLD_COMPONENT] || component;\n        const hot = createHotComponentDeep(component, []);\n        cold[SYMBOL_HOT_COMPONENT] = hot;\n        hot[SYMBOL_COLD_COMPONENT] = cold;\n        hot[SYMBOL_HOT_COMPONENT] = hot;\n        hot[SYMBOL_HOT_ID] = id;\n        accept(onAccept);\n        /* RETURN */\n        return hot;\n    }\n    else { // Returning the component as is\n        return component;\n    }\n};\n/* EXPORT */\nexport default hmr;\n","var n=function(t,s,r,e){var u;s[0]=0;for(var h=1;h<s.length;h++){var p=s[h++],a=s[h]?(s[0]|=p?1:2,r[s[h++]]):s[++h];3===p?e[0]=a:4===p?e[1]=Object.assign(e[1]||{},a):5===p?(e[1]=e[1]||{})[s[++h]]=a:6===p?e[1][s[++h]]+=a+\"\":p?(u=t.apply(a,n(t,a,r,[\"\",null])),e.push(u),a[0]?s[0]|=2:(s[h-2]=0,s[h]=u)):e.push(a)}return e},t=new Map;export default function(s){var r=t.get(this);return r||(r=new Map,t.set(this,r)),(r=n(this,r.get(s)||(r.set(s,r=function(n){for(var t,s,r=1,e=\"\",u=\"\",h=[0],p=function(n){1===r&&(n||(e=e.replace(/^\\s*\\n\\s*|\\s*\\n\\s*$/g,\"\")))?h.push(0,n,e):3===r&&(n||e)?(h.push(3,n,e),r=2):2===r&&\"...\"===e&&n?h.push(4,n,0):2===r&&e&&!n?h.push(5,0,!0,e):r>=5&&((e||!n&&5===r)&&(h.push(r,0,e,s),r=6),n&&(h.push(r,n,0,s),r=6)),e=\"\"},a=0;a<n.length;a++){a&&(1===r&&p(),p(a));for(var l=0;l<n[a].length;l++)t=n[a][l],1===r?\"<\"===t?(p(),h=[h],r=3):e+=t:4===r?\"--\"===e&&\">\"===t?(r=1,e=\"\"):e=t+e[0]:u?t===u?u=\"\":e+=t:'\"'===t||\"'\"===t?u=t:\">\"===t?(p(),r=1):r&&(\"=\"===t?(r=5,s=e,e=\"\"):\"/\"===t&&(r<5||\">\"===n[a][l+1])?(p(),3===r&&(h=h[0]),r=h,(h=h[0]).push(2,0,r),r=0):\" \"===t||\"\\t\"===t||\"\\n\"===t||\"\\r\"===t?(p(),r=2):e+=t),3===r&&\"!--\"===e&&(r=4,h=h[0])}return p(),h}(s)),r),arguments,[])).length>1?r:r[0]}\n","/* IMPORT */\nimport htm from 'htm';\nimport createElement from './create_element.js';\nimport { assign } from '../utils/lang.js';\n/* HELPERS */\nconst registry = {};\nconst h = (type, props, ...children) => createElement(registry[type] || type, props, ...children);\nconst register = (components) => void assign(registry, components);\n/* MAIN */\nconst html = assign(htm.bind(h), { register });\n/* EXPORT */\nexport default html;\n","/* IMPORT */\nimport useMemo from '../hooks/use_memo.js';\nimport useResolved from '../hooks/use_resolved.js';\nimport useResource from '../hooks/use_resource.js';\nimport creatElement from './create_element.js';\nimport resolve from './resolve.js';\nimport { once } from '../utils/lang.js';\n/* MAIN */\nconst lazy = (fetcher) => {\n    const fetcherOnce = once(fetcher);\n    const component = (props) => {\n        const resource = useResource(fetcherOnce);\n        return useMemo(() => {\n            return useResolved(resource, ({ pending, error, value }) => {\n                if (pending)\n                    return;\n                if (error)\n                    throw error;\n                const component = ('default' in value) ? value.default : value;\n                return resolve(creatElement(component, props));\n            });\n        });\n    };\n    component.preload = () => {\n        return new Promise((resolve, reject) => {\n            const resource = useResource(fetcherOnce);\n            useResolved(resource, ({ pending, error }) => {\n                if (pending)\n                    return;\n                if (error)\n                    return reject(error);\n                return resolve();\n            });\n        });\n    };\n    return component;\n};\n/* EXPORT */\nexport default lazy;\n","/* IMPORT */\nimport Portal from '../components/portal.js';\nimport Suspense from '../components/suspense.js';\nimport SuspenseContext from '../components/suspense.context.js';\nimport { SYMBOL_SUSPENSE } from '../constants.js';\nimport useEffect from '../hooks/use_effect.js';\nimport useRoot from '../hooks/use_root.js';\nimport { context } from '../oby.js';\n/* MAIN */\n//TODO: Implement this properly, without relying on JSDOM or stuff like that\nconst renderToString = (child) => {\n    return new Promise(resolve => {\n        useRoot(dispose => {\n            context({ [SYMBOL_SUSPENSE]: undefined }, () => {\n                SuspenseContext.wrap(suspense => {\n                    const { portal } = Portal({ children: Suspense({ children: child }) }).metadata;\n                    useEffect(() => {\n                        if (suspense.active())\n                            return;\n                        resolve(portal.innerHTML);\n                        dispose();\n                    });\n                });\n            });\n        });\n    });\n};\n/* EXPORT */\nexport default renderToString;\n","/* IMPORT */\nimport { SYMBOL_TEMPLATE_ACCESSOR } from '../constants.js';\nimport wrapElement from './wrap_element.js';\nimport { assign, indexOf, isFunction, isString } from '../utils/lang.js';\nimport { setAttribute, setChildReplacement, setClasses, setEvent, setHTML, setProperty, setRef, setStyles } from '../utils/setters.js';\n/* MAIN */\n//TODO: Avoid using \"Function\" and \"eval\", while still keeping similar performance, if possible\n//TODO: support complex children in the template function\nconst template = (fn) => {\n    const safePropertyRe = /^[a-z0-9-_]+$/i;\n    const checkValidProperty = (property) => {\n        if (isString(property) && safePropertyRe.test(property))\n            return true;\n        throw new Error(`Invalid property, only alphanumeric properties are allowed inside templates, received: \"${property}\"`);\n    };\n    const makeAccessor = (actionsWithNodes) => {\n        return new Proxy({}, {\n            get(target, prop) {\n                checkValidProperty(prop);\n                const accessor = (node, method, key, targetNode) => {\n                    if (key)\n                        checkValidProperty(key);\n                    actionsWithNodes.push([node, method, prop, key, targetNode]);\n                };\n                const metadata = { [SYMBOL_TEMPLATE_ACCESSOR]: true };\n                return assign(accessor, metadata);\n            }\n        });\n    };\n    const makeActionsWithNodesAndTemplate = () => {\n        const actionsWithNodes = [];\n        const accessor = makeAccessor(actionsWithNodes);\n        const component = fn(accessor);\n        if (isFunction(component)) {\n            const root = component();\n            if (root instanceof Element) {\n                return { actionsWithNodes, root };\n            }\n        }\n        throw new Error('Invalid template, it must return a function that returns an Element');\n    };\n    const makeActionsWithPaths = (actionsWithNodes) => {\n        const actionsWithPaths = [];\n        for (let i = 0, l = actionsWithNodes.length; i < l; i++) {\n            const [node, method, prop, key, targetNode] = actionsWithNodes[i];\n            const nodePath = makeNodePath(node);\n            const targetNodePath = targetNode ? makeNodePath(targetNode) : undefined;\n            actionsWithPaths.push([nodePath, method, prop, key, targetNodePath]);\n        }\n        return actionsWithPaths;\n    };\n    const makeNodePath = (() => {\n        let prevNode = null;\n        let prevPath;\n        return (node) => {\n            if (node === prevNode)\n                return prevPath; // Cache hit\n            const path = [];\n            let child = node;\n            let parent = child.parentNode;\n            while (parent) {\n                const index = !child.previousSibling ? 0 : !child.nextSibling ? -0 : indexOf(parent.childNodes, child);\n                path.push(index);\n                child = parent;\n                parent = parent.parentNode;\n            }\n            prevNode = node;\n            prevPath = path;\n            return path;\n        };\n    })();\n    const makeNodePathProperties = (path) => {\n        const properties = ['root'];\n        const parts = path.slice().reverse();\n        for (let i = 0, l = parts.length; i < l; i++) {\n            const part = parts[i];\n            if (Object.is(0, part)) {\n                properties.push('firstChild');\n            }\n            else if (Object.is(-0, part)) {\n                properties.push('lastChild');\n            }\n            else {\n                properties.push('firstChild');\n                for (let nsi = 0; nsi < part; nsi++) {\n                    properties.push('nextSibling');\n                }\n            }\n        }\n        return properties;\n    };\n    const makeReviverPaths = (actionsWithPaths) => {\n        const paths = [];\n        for (let i = 0, l = actionsWithPaths.length; i < l; i++) {\n            const action = actionsWithPaths[i];\n            const nodePath = action[0];\n            const targetNodePath = action[4];\n            paths.push(nodePath);\n            if (targetNodePath) {\n                paths.push(targetNodePath);\n            }\n        }\n        return paths;\n    };\n    const makeReviverVariablesData = (paths, properties) => {\n        const data = new Array(paths.length);\n        for (let i = 0, l = paths.length; i < l; i++) {\n            data[i] = {\n                path: paths[i],\n                properties: properties[i]\n            };\n        }\n        return data;\n    };\n    const makeReviverVariables = (actionsWithPaths) => {\n        const paths = makeReviverPaths(actionsWithPaths);\n        const properties = paths.map(makeNodePathProperties);\n        const data = makeReviverVariablesData(paths, properties);\n        const assignments = [];\n        const map = new Map();\n        let variableId = 0;\n        while (true) {\n            const datum = data.find(datum => datum.properties.length > 1);\n            if (!datum)\n                break;\n            const [current, next] = datum.properties;\n            const variable = `$${variableId++}`;\n            const assignment = `const ${variable} = ${current}.${next};`;\n            assignments.push(assignment);\n            for (let i = 0, l = data.length; i < l; i++) {\n                const datum = data[i];\n                const [otherCurrent, otherNext] = datum.properties;\n                if (otherCurrent !== current || otherNext !== next)\n                    continue;\n                datum.properties[0] = variable;\n                datum.properties.splice(1, 1);\n            }\n        }\n        for (let i = 0, l = data.length; i < l; i++) {\n            const datum = data[i];\n            map.set(datum.path, datum.properties[0]);\n        }\n        return { assignments, map };\n    };\n    const makeReviverActions = (actionsWithPaths, variables) => {\n        const actions = [];\n        for (let i = 0, l = actionsWithPaths.length; i < l; i++) { //TODO: Write this more cleanly, with a single case\n            const [nodePath, method, prop, key, targetNodePath] = actionsWithPaths[i];\n            if (targetNodePath) {\n                actions.push(`this.${method} ( props[\"${prop}\"], ${variables.get(targetNodePath)} );`);\n            }\n            else if (key) {\n                actions.push(`this.${method} ( ${variables.get(nodePath)}, \"${key}\", props[\"${prop}\"] );`);\n            }\n            else {\n                actions.push(`this.${method} ( ${variables.get(nodePath)}, props[\"${prop}\"] );`);\n            }\n        }\n        return actions;\n    };\n    const makeReviver = (actionsWithPaths) => {\n        const { assignments, map } = makeReviverVariables(actionsWithPaths);\n        const actions = makeReviverActions(actionsWithPaths, map);\n        const fn = new Function('root', 'props', `${assignments.join('')}${actions.join('')}return root;`);\n        const apis = { setAttribute, setChildReplacement, setClasses, setEvent, setHTML, setProperty, setRef, setStyles };\n        const reviver = fn.bind(apis);\n        return reviver;\n    };\n    const makeComponent = () => {\n        const { actionsWithNodes, root } = makeActionsWithNodesAndTemplate();\n        const actionsWithPaths = makeActionsWithPaths(actionsWithNodes);\n        const reviver = makeReviver(actionsWithPaths);\n        return (props) => {\n            const clone = root.cloneNode(true);\n            return wrapElement(reviver.bind(undefined, clone, props));\n        };\n    };\n    return makeComponent();\n};\n/* EXPORT */\nexport default template;\n","/* IMPORT */\nimport { CONTEXTS_DATA } from '../constants.js';\nimport resolve from './resolve.js';\nimport { context } from '../oby.js';\nfunction createContext(defaultValue) {\n    const symbol = Symbol();\n    const Provider = ({ value, children }) => {\n        return context({ [symbol]: value }, () => {\n            return resolve(children);\n        });\n    };\n    const Context = { Provider };\n    CONTEXTS_DATA.set(Context, { symbol, defaultValue });\n    return Context;\n}\n/* EXPORT */\nexport default createContext;\n","/* IMPORT */\nimport createElement from './create_element.js';\nimport { isArray, isObject } from '../utils/lang.js';\nfunction h(component, props, ...children) {\n    if (children.length || (isObject(props) && !isArray(props))) {\n        return createElement(component, props, ...children); //TSC\n    }\n    else {\n        return createElement(component, null, props); //TSC\n    }\n}\n/* EXPORT */\nexport default h;\n","/* IMPORT */\nimport { CONTEXTS_DATA } from '../constants.js';\nimport { context } from '../oby.js';\nimport { isNil } from '../utils/lang.js';\nfunction useContext(Context) {\n    const { symbol, defaultValue } = CONTEXTS_DATA.get(Context) || { symbol: Symbol() };\n    const valueContext = context(symbol);\n    const value = isNil(valueContext) ? defaultValue : valueContext;\n    return value;\n}\n/* EXPORT */\nexport default useContext;\n","import { html, render, $, isObservable } from \"voby\";\n\ncustomElements.define(\n  \"neptune-reactive-root\",\n  class extends HTMLElement {\n    constructor(children) {\n      super();\n      this.c = () => {};\n    };\n\n    connectedCallback() {\n      this.style.display = \"contents\"\n      this.dispose?.();\n      this.dispose = render(html`${this.c()}`, this)\n    };\n\n    disconnectedCallback() {\n      this.dispose?.()\n    }\n  },\n);\n\nexport function ReactiveRoot({ children }) {\n  const root = html`<neptune-reactive-root></neptune-reactive-root>`()\n  root.c = () => children;\n\n  return root;\n}\n\nexport function Switch(props) {\n  let checked = props.checked ?? false;\n\n  if (!props.onClick) {\n    checked = $(!!checked);\n    props.onClick = () => checked((c) => !c);\n  }\n\n  return html`\n    <div>\n      <input class=\"neptune-switch-checkbox\" type=\"checkbox\" checked=${checked} />\n      <span onClick=${props.onClick} class=\"neptune-switch\"></span>\n    </div>\n  `;\n}\n\nexport function TextInput({ placeholder = \"\", type = \"text\", value = \"\", onEnter = () => {} }) {\n  if (!isObservable(value)) value = $(value);\n\n  return html`\n    <input\n      class=\"neptune-text-input\"\n      value=${value}\n      onKeyup=${(e) => {\n        if (e.key != \"Enter\") return;\n        onEnter(e);\n      }}\n      onInput=${(e) => value(e.target.value)}\n      placeholder=${placeholder}\n      type=${type} />\n  `;\n}\n\nexport function Button({ onClick = () => {}, children }) {\n  return html` <button class=\"neptune-button\" onClick=${onClick}>${children}</button> `;\n}\n","function promisifyRequest(request) {\n    return new Promise((resolve, reject) => {\n        // @ts-ignore - file size hacks\n        request.oncomplete = request.onsuccess = () => resolve(request.result);\n        // @ts-ignore - file size hacks\n        request.onabort = request.onerror = () => reject(request.error);\n    });\n}\nfunction createStore(dbName, storeName) {\n    const request = indexedDB.open(dbName);\n    request.onupgradeneeded = () => request.result.createObjectStore(storeName);\n    const dbp = promisifyRequest(request);\n    return (txMode, callback) => dbp.then((db) => callback(db.transaction(storeName, txMode).objectStore(storeName)));\n}\nlet defaultGetStoreFunc;\nfunction defaultGetStore() {\n    if (!defaultGetStoreFunc) {\n        defaultGetStoreFunc = createStore('keyval-store', 'keyval');\n    }\n    return defaultGetStoreFunc;\n}\n/**\n * Get a value by its key.\n *\n * @param key\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction get(key, customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => promisifyRequest(store.get(key)));\n}\n/**\n * Set a value with a key.\n *\n * @param key\n * @param value\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction set(key, value, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.put(value, key);\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Set multiple values at once. This is faster than calling set() multiple times.\n * It's also atomic  if one of the pairs can't be added, none will be added.\n *\n * @param entries Array of entries, where each entry is an array of `[key, value]`.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction setMany(entries, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        entries.forEach((entry) => store.put(entry[1], entry[0]));\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Get multiple values by their keys\n *\n * @param keys\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction getMany(keys, customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => Promise.all(keys.map((key) => promisifyRequest(store.get(key)))));\n}\n/**\n * Update a value. This lets you see the old value and update it as an atomic operation.\n *\n * @param key\n * @param updater A callback that takes the old value and returns a new value.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction update(key, updater, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => \n    // Need to create the promise manually.\n    // If I try to chain promises, the transaction closes in browsers\n    // that use a promise polyfill (IE10/11).\n    new Promise((resolve, reject) => {\n        store.get(key).onsuccess = function () {\n            try {\n                store.put(updater(this.result), key);\n                resolve(promisifyRequest(store.transaction));\n            }\n            catch (err) {\n                reject(err);\n            }\n        };\n    }));\n}\n/**\n * Delete a particular key from the store.\n *\n * @param key\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction del(key, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.delete(key);\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Delete multiple keys at once.\n *\n * @param keys List of keys to delete.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction delMany(keys, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        keys.forEach((key) => store.delete(key));\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Clear all values in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction clear(customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.clear();\n        return promisifyRequest(store.transaction);\n    });\n}\nfunction eachCursor(store, callback) {\n    store.openCursor().onsuccess = function () {\n        if (!this.result)\n            return;\n        callback(this.result);\n        this.result.continue();\n    };\n    return promisifyRequest(store.transaction);\n}\n/**\n * Get all keys in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction keys(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        if (store.getAllKeys) {\n            return promisifyRequest(store.getAllKeys());\n        }\n        const items = [];\n        return eachCursor(store, (cursor) => items.push(cursor.key)).then(() => items);\n    });\n}\n/**\n * Get all values in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction values(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        if (store.getAll) {\n            return promisifyRequest(store.getAll());\n        }\n        const items = [];\n        return eachCursor(store, (cursor) => items.push(cursor.value)).then(() => items);\n    });\n}\n/**\n * Get all entries in the store. Each entry is an array of `[key, value]`.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction entries(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        // (although, hopefully we'll get a simpler path some day)\n        if (store.getAll && store.getAllKeys) {\n            return Promise.all([\n                promisifyRequest(store.getAllKeys()),\n                promisifyRequest(store.getAll()),\n            ]).then(([keys, values]) => keys.map((key, i) => [key, values[i]]));\n        }\n        const items = [];\n        return customStore('readonly', (store) => eachCursor(store, (cursor) => items.push([cursor.key, cursor.value])).then(() => items));\n    });\n}\n\nexport { clear, createStore, del, delMany, entries, get, getMany, keys, promisifyRequest, set, setMany, update, values };\n","import { createStore as createIdbStore, set as idbSet, get as idbGet } from \"idb-keyval\";\nimport { store } from \"voby\";\n\nexport function appendStyle(style) {\n  const styleTag = document.createElement(\"style\");\n  styleTag.innerHTML = style;\n\n  document.head.appendChild(styleTag);\n\n  return (newStyle) => {\n    if (newStyle == undefined) return document.head.removeChild(styleTag);\n\n    styleTag.innerHTML = newStyle;\n  };\n}\n\nexport const neptuneIdbStore = createIdbStore(\"__NEPTUNE_IDB_STORAGE\", \"__NEPTUNE_IDB_STORAGE\");\n\nexport function createPersistentObject(id, isArray = false) {\n  // This is fucking moronic. But fine, we'll do this dumb shit just for you.\n  const persistentObject = store(isArray ? { value: [] } : {});\n\n  store.on(persistentObject, () => {\n    idbSet(id, store.unwrap(persistentObject), neptuneIdbStore);\n  });\n\n  return [\n    isArray ? persistentObject.value : persistentObject,\n    new Promise((res) =>\n      idbGet(id, neptuneIdbStore).then((obj) => {\n        store.reconcile(persistentObject, obj ?? (isArray ? { value: [] } : {}));\n        res();\n      }),\n    ),\n  ];\n}\n\nexport const getMediaURLFromID = (id, path = \"/1280x1280.jpg\") =>\n  \"https://resources.tidal.com/images/\" + id.split(\"-\").join(\"/\") + path;\n","/* es-module-lexer 1.3.0 */\nconst A=1===new Uint8Array(new Uint16Array([1]).buffer)[0];export function parse(E,g=\"@\"){if(!C)return init.then((()=>parse(E)));const I=E.length+1,o=(C.__heap_base.value||C.__heap_base)+4*I-C.memory.buffer.byteLength;o>0&&C.memory.grow(Math.ceil(o/65536));const D=C.sa(I-1);if((A?B:Q)(E,new Uint16Array(C.memory.buffer,D,I)),!C.parse())throw Object.assign(new Error(`Parse error ${g}:${E.slice(0,C.e()).split(\"\\n\").length}:${C.e()-E.lastIndexOf(\"\\n\",C.e()-1)}`),{idx:C.e()});const K=[],k=[];for(;C.ri();){const A=C.is(),Q=C.ie(),B=C.ai(),g=C.id(),I=C.ss(),o=C.se();let D;C.ip()&&(D=J(E.slice(-1===g?A-1:A,-1===g?Q+1:Q))),K.push({n:D,s:A,e:Q,ss:I,se:o,d:g,a:B})}for(;C.re();){const A=C.es(),Q=C.ee(),B=C.els(),g=C.ele(),I=E.slice(A,Q),o=I[0],D=B<0?void 0:E.slice(B,g),K=D?D[0]:\"\";k.push({s:A,e:Q,ls:B,le:g,n:'\"'===o||\"'\"===o?J(I):I,ln:'\"'===K||\"'\"===K?J(D):D})}function J(A){try{return(0,eval)(A)}catch(A){}}return[K,k,!!C.f()]}function Q(A,Q){const B=A.length;let C=0;for(;C<B;){const B=A.charCodeAt(C);Q[C++]=(255&B)<<8|B>>>8}}function B(A,Q){const B=A.length;let C=0;for(;C<B;)Q[C]=A.charCodeAt(C++)}let C;export const init=WebAssembly.compile((E=\"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9wBGDQFBACgCoAohAQwCC0EAKAKgCiIBQQJqQbAIQQoQLQ0BQQYhAAwCC0EAKAKgCiIBLwECQekARw0AIAEvAQRB9ABHDQBBBCEAIAEvAQZB6ABGDQELQQAgAUF+ajYCoAoPC0EAIAEgAEEBdGo2AqAKAkBBARAnQfsARg0AQQAgATYCoAoPC0EAKAKgCiICIQADQEEAIABBAmo2AqAKAkACQAJAQQEQJyIAQSJGDQAgAEEnRw0BQScQGEEAQQAoAqAKQQJqNgKgCkEBECchAAwCC0EiEBhBAEEAKAKgCkECajYCoApBARAnIQAMAQsgABAqIQALAkAgAEE6Rg0AQQAgATYCoAoPC0EAQQAoAqAKQQJqNgKgCgJAQQEQJyIAQSJGDQAgAEEnRg0AQQAgATYCoAoPCyAAEBhBAEEAKAKgCkECajYCoAoCQAJAQQEQJyIAQSxGDQAgAEH9AEYNAUEAIAE2AqAKDwtBAEEAKAKgCkECajYCoApBARAnQf0ARg0AQQAoAqAKIQAMAQsLQQAoAuQJIgEgAjYCECABQQAoAqAKQQJqNgIMC20BAn8CQAJAA0ACQCAAQf//A3EiAUF3aiICQRdLDQBBASACdEGfgIAEcQ0CCyABQaABRg0BIAAhAiABECYNAkEAIQJBAEEAKAKgCiIAQQJqNgKgCiAALwECIgANAAwCCwsgACECCyACQf//A3ELqwEBBH8CQAJAQQAoAqAKIgIvAQAiA0HhAEYNACABIQQgACEFDAELQQAgAkEEajYCoApBARAnIQJBACgCoAohBQJAAkAgAkEiRg0AIAJBJ0YNACACECoaQQAoAqAKIQQMAQsgAhAYQQBBACgCoApBAmoiBDYCoAoLQQEQJyEDQQAoAqAKIQILAkAgAiAFRg0AIAUgBEEAIAAgACABRiICG0EAIAEgAhsQAgsgAwtyAQR/QQAoAqAKIQBBACgCpAohAQJAAkADQCAAQQJqIQIgACABTw0BAkACQCACLwEAIgNBpH9qDgIBBAALIAIhACADQXZqDgQCAQECAQsgAEEEaiEADAALC0EAIAI2AqAKECJBAA8LQQAgAjYCoApB3QALSQEDf0EAIQMCQCACRQ0AAkADQCAALQAAIgQgAS0AACIFRw0BIAFBAWohASAAQQFqIQAgAkF/aiICDQAMAgsLIAQgBWshAwsgAwsL4gECAEGACAvEAQAAeABwAG8AcgB0AG0AcABvAHIAdABlAHQAYQByAG8AbQB1AG4AYwB0AGkAbwBuAHMAcwBlAHIAdAB2AG8AeQBpAGUAZABlAGwAZQBjAG8AbgB0AGkAbgBpAG4AcwB0AGEAbgB0AHkAYgByAGUAYQByAGUAdAB1AHIAZABlAGIAdQBnAGcAZQBhAHcAYQBpAHQAaAByAHcAaABpAGwAZQBmAG8AcgBpAGYAYwBhAHQAYwBmAGkAbgBhAGwAbABlAGwAcwAAQcQJCxABAAAAAgAAAAAEAAAwOQAA\",\"undefined\"!=typeof Buffer?Buffer.from(E,\"base64\"):Uint8Array.from(atob(E),(A=>A.charCodeAt(0))))).then(WebAssembly.instantiate).then((({exports:A})=>{C=A}));var E;","import { parse } from \"es-module-lexer\";\n\n// This needs support for 3 things to be \"complete\":\n// 1. `import \"./module.js\"`\n// 2. `await import(\"module\")`\n// 3. `export * from \"module\"`\n// For now, it's fine.\n\nasync function betterParse(src) {\n  let [imports] = await parse(src);\n  let exports = [];\n\n  imports = imports.filter((imp) => {\n    imp.declaration = src\n      .slice(imp.ss, imp.se)\n      .replace(/\\/\\*[\\w\\W]*?\\*\\//g, \"\");\n    imp.importClause = imp.declaration\n      .slice(6, imp.declaration.lastIndexOf(\"from\"))\n      .trim();\n\n    const namedImportOpener = imp.importClause.indexOf(\"{\");\n    const namedImportCloser = imp.importClause.indexOf(\"}\") + 1;\n\n    imp.namedImport = imp.importClause.slice(\n      namedImportOpener,\n      namedImportCloser\n    );\n\n    if (imp.namedImport != \"\") {\n      imp.importClause =\n        imp.importClause.slice(0, namedImportOpener) +\n        imp.importClause.slice(namedImportCloser);\n\n      imp.namedImports = imp.namedImport\n        .slice(1, -1)\n        .trim()\n        .split(\",\")\n        .filter((i) => i.trim() != \"\")\n        .map((i) => {\n          const split = i.trim().split(\" as \");\n\n          if (!split[1]) split[1] = split[0];\n          return split;\n        })\n        .reduce((obj, c) => {\n          obj[c[0]] = c[1];\n\n          return obj;\n        }, {});\n    }\n\n    const commaIndex = imp.importClause.indexOf(\",\");\n\n    if (imp.namedImport == \"\") {\n      const namespace =\n        commaIndex == -1\n          ? imp.importClause\n          : imp.importClause.slice(commaIndex + 1).trim();\n\n      if (namespace[0] == \"*\")\n        imp.namespace = namespace.slice(namespace.indexOf(\"as\") + 2).trim();\n    }\n\n    // If there's no named imports and there's no namespaces, the default export *is* the importClause\n    if (imp.namedImport == \"\" && !imp.namespace) {\n      imp.default = imp.importClause;\n    } else if (commaIndex != -1) {\n      // Otherwise, the default export *must* come before the comma\n      imp.default = imp.importClause.slice(0, commaIndex);\n    }\n\n    if (imp.declaration.slice(0, 6) == \"import\") return true;\n\n    imp.isExport = true;\n    exports.push(imp);\n  });\n\n  return [imports, exports];\n}\n\nconst destructurifyImp = (obj) =>\n  Object.entries(obj)\n    .map(([k, v]) => `${k}:${v}`)\n    .join();\n\nconst removeFromString = (string, start, end) =>\n  string.slice(0, start) + string.slice(end);\n\nconst insertIntoString = (string, start, newString) =>\n  string.slice(0, start) + newString + string.slice(start);\n\nexport default async function quartz(\n  code,\n  config = { plugins: [] },\n  moduleId = false\n) {\n  let generatedImports = \"\";\n\n  for (const plugin of config.plugins)\n    if (plugin.transform) code = plugin.transform({ code });\n\n  const [imports, exports] = await betterParse(code);\n\n  // I don't want to have to parse any of this shit more than once.\n  let offset = 0;\n\n  for (const exp of exports) {\n    imports.push(exp);\n\n    const startIndex = exp.ss + offset;\n    const endIndex = exp.se + offset;\n\n    const namespace = exp.namespace;\n    if (namespace != undefined) {\n      // Because of how `export * from \"module\"` works, we can't dynamically export things.\n      // My proposal is that we have a $$$QUARTZ_DYNAMIC_EXPORTS object passed through,\n      // we add a randomly generated namespace, and then we convert the export into reassigning $$$QUARTZ_DYNAMIC_EXPORTS.\n      // We then spread the exports and the dynamic exports together and return that as the exports.\n\n      if (namespace != \"\") {\n        code = removeFromString(code, startIndex, endIndex);\n        const newExport = `export { ${namespace} };`;\n        code = insertIntoString(code, startIndex, newExport);\n\n        offset -= endIndex - startIndex + newExport.length;\n      }\n\n      continue;\n    }\n\n    const fromIndex =\n      startIndex + code.slice(startIndex, endIndex).lastIndexOf(\"from\");\n    code = removeFromString(code, fromIndex, endIndex);\n    offset -= endIndex - fromIndex;\n  }\n\n  let quartzStore = {};\n\n  for (const imp of imports) {\n    if (!imp.isExport) {\n      code = removeFromString(code, imp.ss + offset, imp.se + offset);\n\n      offset -= imp.se + offset - (imp.ss + offset);\n    }\n\n    let id = (Math.random() + 1).toString(36).substring(7);\n\n    let store = (quartzStore[id] = {});\n    let accessor = `$$$QUARTZ_STORE[\"${id}\"]`;\n\n    for (const plugin of config.plugins) {\n      if (!plugin.resolve) continue;\n\n      const generatedImport = await plugin.resolve({\n        config,\n        accessor,\n        store,\n        name: imp.n,\n        moduleId,\n      });\n\n      if (!generatedImport) continue;\n\n      const addImport = (name) =>\n        (generatedImports += `const ${name} = ${generatedImport};`);\n\n      if (imp.default) addImport(`{default:${imp.default}}`);\n      if (imp.namespace) addImport(imp.namespace);\n      if (imp.namedImports) {\n        addImport(\"{\" + destructurifyImp(imp.namedImports) + \"}\");\n      }\n\n      break;\n    }\n  }\n\n  // This appears to be the only way to share things between realms.\n  const globalStoreID = (Math.random() + 1).toString(36).substring(7);\n  globalThis[globalStoreID] = quartzStore;\n\n  // console.log(generatedImports + code)\n\n  const mod = await import(\n    `data:text/javascript;base64,${btoa(\n      `const $$$QUARTZ_STORE = globalThis[\"${globalStoreID}\"];` +\n        generatedImports +\n        code\n    )}`\n  );\n  delete globalThis[globalStoreID];\n\n  return mod;\n}\n","export default ({baseUrl = \"https://esm.sh/\", existingUrls = true} = {}) => {\n  return {\n    resolve({ name }) {\n      if (name.startsWith(\".\") || name.startsWith(\"/\")) return; // local url\n\n      // npm package\n      if (!/^\\w+:/.test(name) && baseUrl) {\n        name = baseUrl + name;\n      }\n      else if (!existingUrls) return;\n\n      return `await import(\"${name}\")`;\n    },\n  };\n};\n","import { store } from \"voby\";\nimport { createPersistentObject, neptuneIdbStore } from \"./utils.js\";\nimport { del } from \"idb-keyval\";\nimport quartz from \"@uwu/quartz\";\nimport urlImport from \"quartz-plugin-url-import\";\nimport { actions } from \"../handleExfiltrations.js\";\n\nexport const [pluginStore, pluginStoreReady] = createPersistentObject(\"NEW_NEPTUNE_PLUGINS\", true);\nexport const enabled = store({});\n\nexport const getPluginById = (id) => pluginStore.find((p) => p.id == id);\n\nexport async function disablePlugin(id) {\n  getPluginById(id).enabled = false;\n  const { onUnload } = enabled[id];\n\n  delete enabled[id];\n\n  try {\n    await onUnload?.();\n  } catch (e) {\n    console.error(\"Failed to completely clean up neptune plugin!\\n\", e);\n  }\n}\n\nexport function togglePlugin(id) {\n  return getPluginById(id).enabled ? disablePlugin(id) : enablePlugin(id);\n}\n\nexport async function enablePlugin(id) {\n  const plugin = getPluginById(id);\n  plugin.enabled = true;\n\n  await runPlugin(plugin);\n}\n\nasync function runPlugin(plugin) {\n  try {\n    const [persistentStorage, persistentStorageReady] = createPersistentObject(\n      plugin.id + \"_PERSISTENT_STORAGE\",\n    );\n\n    await persistentStorageReady;\n\n    const pluginData = {\n      id: plugin.id,\n      manifest: plugin.manifest,\n      storage: persistentStorage,\n    };\n\n    const { onUnload, Settings } = await quartz(plugin.code, {\n      plugins: [\n        {\n          resolve({ name }) {\n            if (!name.startsWith(\"@neptune\")) return;\n\n            return `window${name\n              .slice(1)\n              .split(\"/\")\n              .map((i) => `[${JSON.stringify(i)}]`)\n              .join(\"\")}`;\n          },\n        },\n        {\n          resolve({ name, store, accessor }) {\n            if (!name.startsWith(\"@plugin\")) return;\n\n            if (!store.plugin) store.plugin = { ...pluginData, default: pluginData };\n\n            return `${accessor}${name\n              .slice(1)\n              .split(\"/\")\n              .map((i) => `[${JSON.stringify(i)}]`)\n              .join(\"\")}`;\n          },\n        },\n        urlImport(),\n      ],\n    });\n\n    enabled[plugin.id] = { onUnload: onUnload ?? (() => {}) };\n    if (Settings) enabled[plugin.id].Settings = Settings;\n  } catch (e) {\n    await disablePlugin(plugin.id);\n\n    console.error(\"Failed to load neptune plugin!\\n\", e);\n  }\n}\n\nexport async function installPlugin(id, code, manifest, enabled = true) {\n  const plugin = {\n    id,\n    code,\n    manifest,\n    enabled,\n  };\n\n  pluginStore.unshift(plugin);\n\n  if (enabled) await runPlugin(plugin);\n}\n\nexport async function removePlugin(id) {\n  try {\n    if (enabled[id]) await enabled[id].onUnload();\n  } catch {\n    console.log(\"[neptune] failed to unload plugin upon removal\");\n  }\n\n  pluginStore.splice(\n    pluginStore.findIndex((p) => p.id == id),\n    1,\n  );\n\n  await del(id + \"_PERSISTENT_STORAGE\", neptuneIdbStore);\n}\n\n// This handles caching too!\nexport async function fetchPluginFromURL(url) {\n  let parsedURL = url;\n\n  if (!parsedURL.endsWith(\"/\")) parsedURL += \"/\";\n\n  const manifest = await (await fetch(parsedURL + \"manifest.json\", { cache: \"no-store\" })).json();\n  if (![\"name\", \"author\", \"description\", \"hash\"].every((i) => typeof manifest[i] === \"string\"))\n    throw \"Manifest doesn't contain required properties!\";\n\n  const plugin = getPluginById(url);\n  let code = plugin?.code;\n\n  if (plugin?.manifest?.hash != manifest.hash)\n    code = await (\n      await fetch(parsedURL + (manifest.main ?? \"index.js\"), { cache: \"no-store\" })\n    ).text();\n\n  return [\n    code,\n    {\n      name: manifest.name,\n      author: manifest.author,\n      description: manifest.description,\n      hash: manifest.hash,\n    },\n  ];\n}\n\nexport async function reloadPlugin(plugin) {\n  let pluginWasEnabled = plugin.enabled;\n\n  if (pluginWasEnabled) disablePlugin(plugin.id);\n\n  if (plugin.hasOwnProperty(\"update\")) {\n    try {\n      const [code, manifest] = await fetchPluginFromURL(plugin.id);\n\n      plugin.manifest = manifest;\n      plugin.code = code;\n    } catch {}\n  }\n\n  if (pluginWasEnabled) enablePlugin(plugin.id)\n}\n\nexport async function installPluginFromURL(url, enabled = true) {\n  if (getPluginById(url))\n    return actions.message.messageError({ message: \"Plugin is already imported!\" });\n\n  try {\n    const [code, manifest] = await fetchPluginFromURL(url);\n\n    const plugin = {\n      id: url,\n      code,\n      manifest,\n      enabled,\n      update: true,\n    };\n\n    pluginStore.unshift(plugin);\n\n    if (enabled) runPlugin(plugin);\n  } catch {\n    actions.message.messageError({ message: \"Failed to import neptune plugin!\" });\n  }\n}\n\n// The callback gets called once idb responds and the plugins are loaded into memory.\npluginStoreReady.then(async () => {\n  // We don't attempt to load plugins if CSP exists because loading every plugin will fail and automatically disable the plugin.\n  if (document.querySelector(`[http-equiv=\"Content-Security-Policy\"]`)) return;\n\n  for (const plugin of pluginStore) {\n    if (plugin.update) {\n      try {\n        const [code, manifest] = await fetchPluginFromURL(plugin.id);\n\n        plugin.manifest = manifest;\n        plugin.code = code;\n      } catch {\n        console.log(\"[neptune] failed to update plugin\");\n      }\n    }\n\n    // We do not currently account for plugin updates, but this will be handled once\n    // remote plugin installation is handled.\n    if (plugin.enabled) runPlugin(plugin);\n  }\n});\n","export const interceptors = {};\n\nexport default function intercept(types, cb, once = false) {\n  if (typeof types == \"string\") types = [types];\n\n  const uninterceptors = [];\n  const unintercept = () => uninterceptors.forEach((u) => u());\n\n  for (let type of types) {\n    if (!interceptors[type]) interceptors[type] = [];\n\n    const handleIntercept = once\n      ? (...args) => {\n          cb(...args);\n          unintercept();\n        }\n      : cb;\n    interceptors[type].push(handleIntercept);\n\n    uninterceptors.push(() =>\n      interceptors[type].splice(interceptors[type].indexOf(handleIntercept), 1),\n    );\n  }\n\n  return unintercept;\n}\n","// code source: https://github.com/KaiHax/kaihax/blob/master/src/patcher.ts\n\nconst observations = new Set();\nconst observer = new MutationObserver((records) => {\n  // de-dupe to be sure\n  const changedElems = new Set();\n\n  for (const record of records) {\n    changedElems.add(record.target);\n\n    for (const e of record.removedNodes)\n      if (e instanceof HTMLElement || e instanceof SVGElement) changedElems.add(e);\n  }\n\n  for (const elem of changedElems)\n    for (const obs of observations) {\n      if (elem.matches(obs[0])) obs[1](elem);\n\n      elem\n        .querySelectorAll(obs[0])\n        .forEach(\n          (e) => !obs[2] && (e instanceof HTMLElement || e instanceof SVGElement) && obs[1](e),\n        );\n    }\n});\n\nconst startObserving = () =>\n  observer.observe(document.body, {\n    subtree: true,\n    childList: true,\n    attributes: true,\n  });\n\nconst stopObserving = () => observer.disconnect();\n\nexport function observe(sel, cb) {\n  if (observations.size === 0) startObserving();\n  const entry = [sel, cb, false];\n  observations.add(entry);\n\n  const unobs = () => {\n    observations.delete(entry);\n    if (observations.size === 0) stopObserving();\n  };\n\n  unobs.now = () => {\n    entry[2] = true;\n    unobs();\n  };\n\n  return unobs;\n}\nexport function unobserve() {\n  observations.clear();\n  stopObserving();\n}\n","import { ReactiveRoot } from \"../ui/components.js\";\nimport intercept from \"./intercept.js\";\nimport { observe } from \"./observe.js\";\n\nconst pageNotFoundSelector = `[class^=\"contentArea--\"] [class^=\"pageNotFoundError--\"]`;\n\nconst replacePage = (page, component) => {\n  page.style.display = \"none\";\n\n  const neptunePage = document.createElement(\"div\");\n  neptunePage.className = \"__NEPTUNE_PAGE\";\n\n  page.insertAdjacentElement(\"afterend\", neptunePage);\n  neptunePage.appendChild(ReactiveRoot({ children: component }));\n};\n\nintercept(\"ROUTER_LOCATION_CHANGED\", () => {\n  for (const page of document.getElementsByClassName(\"__NEPTUNE_PAGE\"))\n    page.parentElement.removeChild(page);\n});\n\nexport default function registerRoute(path, component) {\n  return intercept(\"ROUTER_LOCATION_CHANGED\", ([payload]) => {\n    if (payload.pathname != `/neptune/${path}`) return;\n\n    const pageNotFound = document.querySelector(pageNotFoundSelector);\n    if (pageNotFound) return replacePage(pageNotFound, component);\n\n    const unob = observe(pageNotFoundSelector, (page) => {\n      unob.now();\n      replacePage(page, component);\n    });\n  });\n}\n","import registerRoute from \"./registerRoute.js\";\nimport intercept from \"./intercept.js\";\nimport { actions } from \"../handleExfiltrations.js\";\nfunction makeInactive(tab) {\n  tab.classList.remove(Array.from(tab.classList).find((c) => c.startsWith(\"activeItem--\")));\n}\n\nconst getTabs = () => document.querySelector(`.sidebarWrapper section[class^=\"section--\"]`);\n\n// Automatically set tab to unchecked.\nintercept(\"ROUTER_LOCATION_CHANGED\", () => {\n  for (const tab of document.getElementsByClassName(\"__NEPTUNE_TAB\")) tab.style.color = \"\";\n});\n\n/*\n  This entire function abuses their router's 404 handling to insert our own tabs.\n  Because 404s count towards router history, our tabs function perfectly fine even when using the back arrows!\n*/\nexport default function registerTab(name, path, component = () => {}) {\n  const unobservers = [];\n\n  const addTab = (tabs) => {\n    const tab = tabs.children[0].cloneNode(true);\n    makeInactive(tab);\n\n    tab.querySelector(`[class^=\"responsiveText--\"]`).textContent = name;\n\n    tab.classList.add(\"__NEPTUNE_TAB\");\n\n    tab.addEventListener(\"click\", (e) => {\n      e.preventDefault();\n\n      actions.router.push({\n        pathname: `/neptune/${path}`,\n        replace: true,\n      });\n    });\n\n    const removeRouteHandler = registerRoute(path, () => {\n      tab.style.color = \"var(--wave-color-solid-accent-fill)\";\n\n      return component;\n    });\n\n    tabs.appendChild(tab);\n    unobservers.push(removeRouteHandler, () => tabs.removeChild(tab));\n  };\n\n  const tabs = getTabs();\n\n  if (!tabs) {\n    // Instead of DOM observing we just intercept the first action that gets called after the UI shows. Maybe we can DOM observe later?\n    unobservers.push(\n      intercept(\n        \"favorites/SET_FAVORITE_IDS\",\n        () => {\n          addTab(getTabs());\n        },\n        true,\n      ),\n    );\n  } else addTab(tabs);\n\n  return () => unobservers.forEach((u) => u());\n}\n","import intercept from \"./intercept.js\";\nimport { observe } from \"./observe.js\";\n\nexport default function hookContextMenu(menuType, name, handler) {\n  return intercept(\"contextMenu/OPEN\", ([payload]) => {\n    // TODO: Change this to a switch statement.\n\n    if (payload?.type != menuType) return;\n\n    const unob = observe(`[data-type=\"contextmenu-item\"]`, (elem) => {\n      unob.now();\n\n      const contextMenuItem = elem.cloneNode(true);\n      const contextMenuLabel = contextMenuItem.querySelector(`[class^=\"actionTextInner--\"]`);\n      contextMenuLabel.innerText = name;\n\n      const parentClasses = contextMenuLabel.parentElement.classList;\n\n      contextMenuItem.innerHTML = \"\";\n\n      const contextMenuWrapper = document.createElement(\"div\");\n      contextMenuWrapper.setAttribute(\"tabindex\", \"0\");\n      contextMenuWrapper.classList.add(...parentClasses);\n      contextMenuWrapper.appendChild(contextMenuLabel);\n\n      contextMenuItem.addEventListener(\"keyup\", (event) => {\n        if (event.keyCode != 13) return;\n\n        event.target.click();\n      });\n\n      contextMenuItem.appendChild(contextMenuWrapper);\n\n      contextMenuItem.addEventListener(\"click\", (event) => {\n        handler(event);\n      });\n\n      elem.parentElement.appendChild(contextMenuItem);\n    });\n  });\n}\n","import { ReactiveRoot } from \"../ui/components.js\";\nimport { actions } from \"../handleExfiltrations.js\";\nimport { observe } from \"./observe.js\";\n\nexport default function showModal(name, component) {\n  actions.modal.showReleaseNotes();\n  const unob = observe(`[class^=\"modalHeader--\"]`, (header) => {\n    unob.now();\n\n    header.getElementsByTagName(\"h4\")[0].innerText = name;\n\n    header.nextSibling.replaceChildren(\n      ReactiveRoot({\n        children: component,\n      }),\n    );\n  });\n}\n","import * as voby from \"voby\";\nimport * as patcher from \"spitroast\";\nimport * as utils from \"./api/utils.js\";\nimport * as plugins from \"./api/plugins.js\";\nimport intercept from \"./api/intercept.js\";\nimport { observe } from \"./api/observe.js\";\nimport registerTab from \"./api/registerTab.js\";\nimport registerRoute from \"./api/registerRoute.js\";\nimport hookContextMenu from \"./api/hookContextMenu.js\";\nimport showModal from \"./api/showModal.js\";\n\nexport default {\n  patcher,\n  utils,\n  intercept,\n  observe,\n  registerTab,\n  registerRoute,\n  hookContextMenu,\n  showModal,\n  voby,\n  plugins,\n};\n","import windowObject from \"./windowObject.js\";\nimport * as patcher from \"spitroast\";\nimport { interceptors } from \"./api/intercept.js\";\nimport loadStyles from \"./styles.js\";\n\n// abandon all hope, ye who enter here\n\n/*\n  This code runs before webpackChunk_tidal_web is defined.\n  Upon it being assigned to, we patch push to intercept webpackRequire and exfiltrate modules.\n  The upcoming comments will explain each step of the process.\n*/\n\n// Variables used for hooking into webpack.\nlet patchedPush = false;\nlet webpackObject;\n\n// Exfiltrations gained from hooking into webpack.\nlet patchedPrepareAction = false;\nlet exfiltratedStore;\n\n// Built action handlers\nexport const actions = {};\nwindowObject.actions = actions;\n\nconst getModulesFromWpRequire = (wpRequire) =>\n  Object.fromEntries(\n    Object.entries(wpRequire.m).map(([k]) => [k, { id: k, loaded: true, exports: wpRequire(k) }]),\n  );\n\nObject.defineProperty(window, \"webpackChunk_tidal_web\", {\n  get: () => webpackObject,\n  set(val) {\n    if (webpackObject) return true;\n    loadStyles();\n\n    /*\n      We replace webpackObject with a proxy that waits for .push to be gotten.\n      This could be replaced with an Object.defineProperty call that assigns push to a getter,\n      but I didn't feel like it. Fuck you.\n    */\n    webpackObject = new Proxy(val, {\n      get(obj, prop) {\n        if (prop == \"push\" && !patchedPush) {\n          patchedPush = true;\n\n          // This patcher call patches .push.\n          patcher.before(prop, obj, (args) => {\n            // Push can be called with multiple chunks, so instead of only doing the first argument we handle all of them.\n            for (let arg of args) {\n              if (!arg[1]) continue;\n\n              // Each chunk contains an object containing a list of modules, so we iterate over each module id.\n              for (let id in arg[1]) {\n                // Modules get passed webpackRequire as their third argument, so we patch over each module to essentially patch webpackRequire.\n                patcher.before(id, arg[1], (args) => {\n                  const wpRequire = args[2];\n\n                  if (!windowObject.hasOwnProperty(\"modules\"))\n                    Object.defineProperty(windowObject, \"modules\", {\n                      get: () => Object.values(getModulesFromWpRequire(wpRequire)),\n                    });\n\n                  // See above: patching webpackRequire.\n                  patcher.after(2, args, (_, resp) => {\n                    try {\n                      /*\n                        This entire block exfiltrates modules we need / patches them.\n                        The only modules we need export an object, so we return if they aren't an object.\n                      */\n                      if (typeof resp != \"object\") return;\n\n                      try {\n                        if (!exfiltratedStore) {\n                          // We sift through the modules to find a module that exports a function that gets the global Redux store.\n                          const [key] = Object.entries(resp).find(([, e]) =>\n                            e?.toString?.().includes?.('Error(\"No global store set\"'),\n                          );\n\n                          if (key) exfiltratedStore = true;\n\n                          /*\n                            Because we patch so early, the global Redux store is not defined yet,\n                            so we wait for the getStore function to be called.\n                          */\n                          patcher.after(key, resp, (_, resp) => {\n                            if (!typeof resp == \"object\" && windowObject.store) return;\n\n                            windowObject.store = resp;\n                          });\n                        }\n                      } catch {}\n\n                      try {\n                        if (patchedPrepareAction) return;\n\n                        let found = Object.entries(resp).find(([, possiblyPrepareAction]) =>\n                          possiblyPrepareAction\n                            ?.toString?.()\n                            ?.includes?.(`new Error(\"prepareAction did not return an object\");`),\n                        );\n\n                        if (!found) return;\n\n                        patchedPrepareAction = true;\n                        patcher.after(found[0], resp, ([type], resp) => {\n                          if (!interceptors[type]) interceptors[type] = [];\n\n                          const [parent, child] = type\n                            .split(\"/\")\n                            .map((n) =>\n                              n.toUpperCase() == n\n                                ? n.toLowerCase().replace(/_([a-z])/g, (_, i) => i.toUpperCase())\n                                : n,\n                            );\n\n                          const builtAction = (...args) => {\n                            const act = resp(...args);\n\n                            if (!(act.__proto__.toString() == \"[object Promise]\"))\n                              return windowObject.store.dispatch(act);\n\n                            return new Promise(async (res, rej) => {\n                              try {\n                                res(windowObject.store.dispatch(await act));\n                              } catch (e) {\n                                rej(e);\n                              }\n                            });\n                          };\n\n                          if (child) {\n                            if (!actions[parent]) actions[parent] = {};\n\n                            actions[parent][child] = builtAction;\n                          } else {\n                            actions[parent] = builtAction;\n                          }\n\n                          return new Proxy(resp, {\n                            apply(orig, ctxt, args) {\n                              let shouldDispatch = true;\n\n                              for (let interceptor of interceptors[type]) {\n                                try {\n                                  const resp = interceptor(args);\n\n                                  if (typeof resp == \"boolean\") shouldDispatch = !shouldDispatch;\n                                } catch (e) {\n                                  console.error(\"Failed to run interceptor!\\n\", e);\n                                }\n                              }\n\n                              return shouldDispatch ? orig.apply(ctxt, args) : { type: \"NOOP\" };\n                            },\n                          });\n                        });\n                      } catch {}\n                    } catch (e) {\n                      console.error(e);\n                    }\n                  });\n                });\n              }\n            }\n          });\n        }\n\n        return obj[prop];\n      },\n    });\n\n    return true;\n  },\n});\n","import { appendStyle } from \"./api/utils.js\";\n\nexport default function loadStyles() {\n  appendStyle(`\n  .__NEPTUNE_PAGE {\n    margin: 0px auto;\n    max-width: 870px;\n    width: calc(100% - var(--defaultPadding)*2);\n  }\n\n  .neptune-plugin-card {\n    background-color: var(--wave-color-solid-base-brighter, var(--wave-color-opacity-contrast-fill-ultra-thick));\n    border: 1px solid var(--wave-color-opacity-contrast-fill-ultra-thin);\n    border-radius: 12px;\n    min-height: 70px;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n  }\n\n  .neptune-plugin-card-content {\n    display: flex;\n    justify-content: space-between;\n    padding: 0 15px 0px 15px;\n  }\n  \n  .neptune-active-tab {\n    color: var(--wave-color-solid-accent-fill);\n    box-shadow: 0px 2px var(--cyan-blue);\n  }\n  \n  .neptune-plugin-title {\n    font-weight: 600;\n    font-size: medium;\n  }\n\n  .neptune-switch-checkbox {\n    cursor: pointer;\n    margin-left: 0.8rem;\n    opacity: 0;\n    position: absolute;\n    z-index: 1;\n  }\n\n  .neptune-switch {\n    cursor: pointer;\n    background-color: var(--glass-white-5);\n    border-radius: 28px;\n    display: block;\n    height: 28px;\n    margin-left: 0.8rem;\n    min-width: 48px;\n    position: relative;\n    transition: background-color .25s ease,border-color .25s ease;\n    -webkit-user-select: none;\n    user-select: none;\n  }\n\n  .neptune-switch:after {\n    background-color: var(--snow-white);\n    border-radius: 50%;\n    box-shadow: 0 1px 2px rgb(0 0 0 / 30%);\n    content: \"\";\n    display: block;\n    height: 24px;\n    left: 2px;\n    position: absolute;\n    top: 2px;\n    transition: all .25s ease;\n    width: 24px;\n  }\n\n  .neptune-switch-checkbox:checked + .neptune-switch:after {\n    left: calc(100% - 0.1em);\n    transform: translateX(-100%);\n  }\n\n  .neptune-switch-checkbox:checked + .neptune-switch {\n    background-color: var(--cyan-blue);\n    border-color: var(--cyan-blue);\n  }\n\n  .neptune-text-input {\n    background: transparent;\n    border: 0;\n    border-bottom: 1px solid var(--glass-white-5);\n    color: var(--glass-white-2);\n    display: block;\n    width: 100%;\n  }\n\n  .neptune-text-input:not([readonly]):focus {\n    border-bottom-color: var(--cyan-blue);\n    color: var(--snow-white);\n  }\n\n  .neptune-button {\n    align-items: center;\n    background-color: var(--glass-white-1);\n    border-radius: 12px;\n    display: inline-flex;\n    height: 48px;\n    justify-content: center;\n    line-height: 49px;\n    min-height: 48px;\n    min-width: 0;\n    overflow: hidden;\n    padding: 0 24px;\n    text-align: center;\n    text-overflow: ellipsis;\n    transition: background .35s ease;\n    white-space: nowrap;\n  }\n\n  .neptune-round-button {\n    color: var(--wave-color-opacity-contrast-fill-thick);\n    background-color: var(--wave-color-solid-base-brighter);\n    border: 1px solid var(--wave-color-opacity-contrast-fill-ultra-thin);\n    transition: background-color 0.35s ease 0s;\n    transition-property: background-color;\n    transition-duration: 0.35s;\n    transition-timing-function: ease;\n    transition-delay: 0s;\n    position: relative;\n    border-radius: 100%;\n    height: 40px;\n    width: 40px;\n    display: grid;\n    place-items: center;\n  }\n\n  .neptune-round-button:active {\n    background-color: rgba(255, 255, 255, 0.2);\n  }\n`);\n}\n","import { Switch, TextInput } from \"./components.js\";\nimport { actions } from \"../handleExfiltrations.js\";\nimport {\n  pluginStore,\n  togglePlugin,\n  removePlugin,\n  installPluginFromURL,\n  installPlugin,\n  reloadPlugin,\n  enabled as enabledPlugins,\n} from \"../api/plugins.js\";\nimport showModal from \"../api/showModal.js\";\nimport { $, For, If, html } from \"voby\";\n\nconst parseManifest = (manifest) =>\n  JSON.parse(manifest.slice(manifest.indexOf(\"/*\") + 2, manifest.indexOf(\"*/\")));\n\nasync function importLocalPlugin() {\n  const [fileHandle] = await showOpenFilePicker({\n    types: [{ description: \"A neptune plugin file\", accept: { \"text/javascript\": [\".js\"] } }],\n  });\n\n  const file = await fileHandle.getFile();\n  const content = await file.text();\n\n  let manifest;\n  try {\n    manifest = parseManifest(content);\n\n    if (![\"name\", \"author\", \"description\"].every((m) => typeof manifest[m] === \"string\"))\n      throw \"invalid manifest\";\n  } catch {\n    return actions.message.messageError({ message: \"Invalid plugin manifest!\" });\n  }\n\n  try {\n    await installPlugin(\n      manifest.name + \"-\" + (Math.random() + 1).toString(36).substring(7),\n      content,\n      {\n        name: manifest.name,\n        author: manifest.author,\n        description: manifest.description,\n      },\n    );\n  } catch {\n    actions.message.messageError({ message: \"Failed to install plugin!\" });\n  }\n}\n\nexport function PluginTab() {\n  const pluginToImport = $(\"\");\n\n  return html`\n  <div style=\"display: flex; gap: 10px; flex-direction: column\">\n    <div style=\"padding-top: 10px; display: flex; gap:10px\">\n      <!-- This text input *needs* to be able to have an onEnter event. -->\n      <${TextInput} value=${pluginToImport} onEnter=${() => {\n        installPluginFromURL(pluginToImport());\n        pluginToImport(\"\");\n      }} placeholder=\"Import from URL\" />\n      <!-- This button will be used for importing from local files. -->\n      <button onClick=${importLocalPlugin} class=\"neptune-round-button\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"></path><polyline points=\"17 8 12 3 7 8\"></polyline><line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\"></line></svg>\n      </button>\n    </div>\n    <${For} values=${() => pluginStore}>\n      ${(plugin) => html`<${PluginCard} plugin=${plugin} />`}\n    </${For}>\n  </div>`;\n}\n\nfunction PluginCard({ plugin }) {\n  return html`<div class=\"neptune-plugin-card\">\n    <div class=\"neptune-plugin-card-content\">\n      <div>\n        <div style=\"display: flex; gap: 15px; align-items: center\">\n          <button class=\"neptune-round-button\" onClick=${() => reloadPlugin(plugin)}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"22\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99\" />\n            </svg>\n          </button>\n          <div class=\"padding-top: 10px; padding-bottom: 10px\">\n            <div>\n              <span class=\"neptune-plugin-title\">${plugin.manifest.name}</span>\n              <span> by </span>\n              <span class=\"neptune-plugin-title\">${plugin.manifest.author}</span>\n            </div>\n            <div style=\"font-size: medium\">${plugin.manifest.description}</div>\n          </div>\n        </div>\n      </div>\n      <div style=\"margin-top: auto; margin-bottom: auto; display: flex\">\n        <div style=\"display: flex; justify-content: center; align-items: center; gap: 6px\">\n          <${If} when=${() => enabledPlugins?.[plugin.id]?.Settings}>\n            <button style=\"display: grid; place-items: center; padding: 0px\" onClick=${() =>\n              showModal(plugin.manifest.name, enabledPlugins[plugin.id].Settings)}>\n              <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" style=\"width: 22px\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z\"></path>\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\"></path>\n              </svg>\n            </button>\n          </${If}>\n          <button style=\"display: grid; place-items: center; padding: 0px\" onClick=${() =>\n            removePlugin(plugin.id)}>\n            <svg\n              style=\"width: 22px;\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke-width=\"1.5\"\n              stroke=\"currentColor\">\n              <path\n                stroke-linecap=\"round\"\n                stroke-linejoin=\"round\"\n                d=\"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0\"></path>\n            </svg>\n          </button>\n        </div>\n        <${Switch}\n          checked=${() => plugin.enabled}\n          onClick=${() => {\n            togglePlugin(plugin.id);\n          }} />\n      </div>\n    </div>\n  </div>`;\n}\n","import { $, html } from \"voby\";\nimport { PluginTab } from \"./pluginsTab.js\";\nimport registerRoute from \"../api/registerRoute.js\";\nimport hookContextMenu from \"../api/hookContextMenu.js\";\n\nlet selectedTab = $(0);\nconst tabs = [\n  {\n    name: \"Plugins\",\n    component: PluginTab,\n  },\n  {\n    name: \"Themes\",\n    component: () => html`[WIP]`,\n  },\n  {\n    name: \"Addon Store\",\n    component: () => html`[WIP]`,\n  },\n];\n\nfunction TabButton({ className = \"\", onClick = () => {}, children }) {\n  return html`<button\n    onClick=${onClick}\n    style=\"font-weight: 500; font-size: 1.14286rem; padding-bottom: 6px\"\n    class=\"${className}\">\n    ${children}\n  </button>`;\n}\n\nregisterRoute(\n  \"settings\",\n  html`<div style=\"width: 675px\">\n    <div>\n      <div style=\"display: flex; gap: 25px; padding-bottom: 10px\">\n        ${tabs.map(\n          (tab, idx) =>\n            html`<${TabButton} onClick=${() => selectedTab(idx)} className=${() =>\n              idx == selectedTab() ? \"neptune-active-tab\" : \"\"}>${tab.name}</${TabButton}>`,\n        )}\n      </div>\n      <div>${() => tabs[selectedTab()].component}</div>\n    </div>\n  </div>`,\n);\n\nhookContextMenu(\"USER_PROFILE\", \"neptune settings\", () =>\n  neptune.actions.router.push({ pathname: \"/neptune/settings\", replace: true }),\n);\n","import { after, instead } from \"spitroast\";\nimport \"./ui/settings.js\";\nimport \"./handleExfiltrations.js\";\nimport windowObject from \"./windowObject.js\";\n\n// Restore the console\nfor (let key in console) {\n  const orig = console[key];\n\n  Object.defineProperty(console, key, {\n    set() {\n      return true;\n    },\n    get() {\n      return orig;\n    },\n  });\n}\n\n// Force properties to be writable for patching\nconst originalDefineProperty = Object.defineProperty;\n\nObject.defineProperty = function (...args) {\n  args[2].configurable = true;\n\n  try {\n    return originalDefineProperty.apply(this, args);\n  } catch {}\n};\n\nObject.freeze = (arg) => arg;\n\n// Polyfill node setInterval and setTimeout\nconst delayHandler = (_, resp) => {\n  return {\n    id: resp,\n    unref() {},\n  };\n};\n\nconst clearDelayHandler = ([id], orig) => orig(id?.id ?? id);\n\nafter(\"setInterval\", window, delayHandler);\nafter(\"setTimeout\", window, delayHandler);\n\ninstead(\"clearInterval\", window, clearDelayHandler);\ninstead(\"clearTimeout\", window, clearDelayHandler);\n\n// If the app fails to load for any reason we simply reload the page.\nsetTimeout(() => {\n  if (document.getElementById(\"skeleton-logged-out\")) window.location.reload();\n}, 7000);\n\nwindow.neptune = windowObject;\n"],"names":["patchTypes","patchedObjects","Map","unpatch","funcParent","funcName","hookId","type","patchedObject","get","patch","has","delete","every","t","size","Reflect","defineProperty","value","o","writable","configurable","Object","keys","length","getPatchFunc","patchType","callback","oneTime","Error","constructor","name","set","parentInjections","origFunc","b","i","a","runHook","ctxt","args","construct","ret","funcArgs","isConstruct","apply","hook","values","maybefuncArgs","call","Array","isArray","workingRetVal","reduce","prev","current","unpatchThisPatch","replaceProxy","Proxy","_","target","prop","receiver","toString","bind","Symbol","before","instead","after","parentObject","entries","hookType","IS_BROWSER","globalThis","CDATASection","match","isServer$1","SYMBOL_CACHED","SYMBOL_OBSERVABLE","SYMBOL_OBSERVABLE_FROZEN","SYMBOL_OBSERVABLE_READABLE","SYMBOL_OBSERVABLE_WRITABLE","SYMBOL_STORE","SYMBOL_STORE_KEYS","SYMBOL_STORE_OBSERVABLE","SYMBOL_STORE_TARGET","SYMBOL_STORE_VALUES","SYMBOL_STORE_UNTRACKED","SYMBOL_SUSPENSE","SYMBOL_UNCACHED","SYMBOL_UNTRACKED","SYMBOL_UNTRACKED_UNWRAPPED","is","isEqual","l","valueA","valueB","isFunction","isObject","isSymbol","noop","nope","frozenFunction","arguments","this","readableFunction","writableFunction","fn","C","frozen","readable","OBSERVABLE_FALSE","OBSERVABLE_TRUE","UNAVAILABLE","UNINITIALIZED","lazyArrayEach","arr","lazyArrayEachRight","lazyArrayPush","obj","key","push","lazySetAdd","Set","add","s","lazySetDelete","undefined","lazySetEach","onCleanup","cleanup","onDispose","owner","Q","Owner$1","disposed","B","S","D","K","T","U","catch","error","silent","parent","deep","symbol","context","E","observer","ownerPrev","OWNER","observerPrev","OBSERVER","setOwner","setObserver","castError","SuperRoot$1","Owner","super","BATCH","SUPER_OWNER","SuperRoot","setBatch","M","resolve","batch$1","async","Promise","r","isObservableFrozen$1","isUntracked$2","SchedulerSync","A1","A2","N","queue","F","ObservableClass","options","equals","A","L","Scheduler","I","J","sync","Math","max","ObservablesArray","P","R","observablesLength","empty","observable","index","indexOf","ObservablesSet","sizePrev","Observer$1","H","run","Memo$1","Observer","Observable","G","statusPrev","memo$1","isObservableFrozen","isUntracked","memo","Memo","boolean$1","cleanup$1","Context$1","symbolOrContext","Context","disposed$1","Scheduler$1","A3","queueMicrotask","finally","effect","Effect$1","suspense","init","suspended","effect$1","Effect","resolved","Root$1","V","A0","DUMMY_INDEX","Root","CacheKeyed$1","A5","A6","A7","A8","A9","forEach","mapped","AA","O","map","AB","results","resultsCached","resultsUncached","cached","MappedRoot","from","isObservable$1","getFunction","isObservable","Suspense$3","SYMBOL_SUSPENSE$1","A4","force","suspendedPrev","suspendedNext","notifyOwner","notifyObserver","notifySuspense","notifyRoot","root","suspense$1","when","Suspense","condition","boolean","CacheUnkeyed$1","pooled","AC","AD","poolable","cacheNext","leftovers","outer","isDuplicate","pop","$index","$value","isStore$1","untrack","warmup$1","fallback","_switch","warmup","ternary$1","valueTrue","valueFalse","isBatching$1","SchedulerAsync","isObservableWritable$1","target$1","readonly$1","isObservableWritable","root$1","DisposableMap","SelectedObservable","AE","AF","AG","selector$1","sourceValue","selectedValue","valuePrev","valueNext","selected","StoreMap","AH","StoreCleanable","listen","StoreKeys","StoreValues","StoreHas","StoreProperty","AI","AJ","StoreListenersRegular","AK","AL","AM","AN","traversed","traverse","AO","AP","listener","StoreScheduler","reset","StoreListenersRoots","rootsSet","store","AQ","AR","flushRegular","flushRoots","AS","isBatching","setTimeout","NODES","WeakMap","SPECIAL_SYMBOLS","UNREACTIVE_KEYS","STORE_TRAPS","isListenable","getNodeExisting","getNodeKeys","getNodeValues","String","getter","AT","property","getNodeProperty","getNodeObservable","listenable","proxiable","isProxiable","prototype","getTarget","setter","AU","hadProperty","getNode","deleteProperty","descriptor","descriptorPrev","getOwnPropertyDescriptor","isEqualDescriptor","enumerable","getNodeHas","ownKeys","STORE_UNTRACK_TRAPS","gettersAndSetters","getGettersAndSetters","getNodeFromStore","propertyNode","isStore","getPrototypeOf","getStore","on","targets","selectors","filter","disposers","selector","inited","disposer","_onRoots","reconcile","getType","reconcileInner","next","uprev","unext","prevKeys","nextKeys","prevValue","nextValue","prevType","nextType","reconcileOuter","getUntracked","unwrap","store$1","suspended$1","tick$1","tryCatch$1","$","untracked","_with$1","CONTEXTS_DATA","DIRECTIVES","SYMBOL_TEMPLATE_ACCESSOR","SYMBOLS_DIRECTIVES","wrapElement$1","element","createComment","document","createHTMLNode","createElement","createSVGNode","createElementNS","createText","createTextNode","assign","castArray","_indexOf","isError","isFunctionReactive","isNil","isString","isSVG","isSVGElement","svgRe","svgCache","includes","test","isTruthy","useResolved","resolveFunction","isResolvable","useEventListener","event","handler","useEffect","$$","addEventListener","removeEventListener","useAbortController$1","signals","controller","AbortController","abort","some","signal","aborted","useCleanup","useAbortSignal$1","useAbortController","useScheduler$1","loop","once","cancel","schedule","tickId","executed","useSuspended","work","tick","dispose","useAnimationFrame$1","useScheduler","cancelAnimationFrame","requestAnimationFrame","useAnimationLoop$1","SuspenseContext","create","count","active","useMemo","increment","nr","decrement","wrap","data","SuspenseContext$1","SuspenseManager$1","suspenses","change","counter","counterNext","suspend","unsuspend","useRenderEffect$1","useResource$1","fetcher","pending","latest","SuspenseManager","resourcePending","resourceRejected","resourceResolved","resourceFunction","resource","useRenderEffect","useCheapDisposed","onPending","onResolve","result","onReject","exception","isPromise","then","fetch","useReadonly","useFetch$1","request","useResource","useAbortSignal","useIdleCallback$1","cancelIdleCallback","requestIdleCallback","useIdleLoop$1","useInterval$1","ms","clearInterval","setInterval","usePromise$1","promise","useTimeout$1","clearTimeout","useCheapDisposed$1","useMicrotask$1","runWithOwner","_with","dummyNode","beforeDummyWrapper","afterDummyWrapper","diff$1","nextSibling","Node","bLength","removable","aEnd","bEnd","aStart","bStart","node","slice","append","removeChild","insertBefore","sequence","replaceChild","NOOP_CHILDREN","FragmentUtils","make","makeWithNode","makeWithFragment","fragment","fragmented","getChildrenFragmented","thiz","children","getChildren","pushFragment","pushValue","pushNode","replaceWithNode","replaceWithFragment","FragmentUtils$1","resolveChild","_dynamic","hasObservables","resolveArraysAndStatics","resolveClass","classes","split","Boolean","cls","DUMMY_RESOLVED","resolveArraysAndStaticsInner","setAttributeStatic","attributesBoolean","attributeCamelCasedRe","attributesCache","uppercaseRe","replace","char","toLowerCase","normalizeKeySvg","removeAttribute","setAttribute","setChildReplacementText","child","childPrev","nodeType","nodeValue","parentElement","textNode","setChildReplacement","setChildStatic","setChildReplacementFunction","setChild","fragmentOnly","dynamic","prevIsArray","prevLength","prevFirst","prevLast","prevSibling","appendChild","fragmentNext","childFragmentOnly","nextLength","childNodes","textContent","placeholder","diff","setClassStatic","className","classList","toggle","setClass","setClassBooleanStatic","keyPrev","setClassBoolean","keyNext","setClassesStatic","object","objectPrev","setClasses","objectNext","setEventStatic","delegatedEvents","onauxclick","onbeforeinput","onclick","ondblclick","onfocusin","onfocusout","oninput","onkeydown","onkeyup","onmousedown","onmouseup","startsWith","_value","delegated","composedPath","cancelBubble","delegate","endsWith","isCapture","capture","passive","setEvent","setHTML","innerHTML","setHTMLStatic","__html","setPropertyStatic","isBoolean","tagName","setProperty","setRef","flat","Infinity","flatten","useMicrotask","setStyleStatic","propertyNonDimensionalRe","propertyNonDimensionalCache","charCodeAt","style","removeProperty","setStyle","setStylesStatic","cssText","setStyles","setProp","isTemplateAccessor","setTemplateAccessor","directive","immediate","setDirective","creatElement","component","props","_children","__children","ref","rest","wrapElement","createNode","setProps","isNode","Dynamic$1","ErrorBoundary$1","tryCatch","For","unkeyed","CacheUnkeyed","CacheKeyed","array","_for","Fragment$1","useGuarded$1","guard","valueLast","guarded","If$1","ternary","truthy","useGuarded","useUntracked","cache","runWithSuperRoot","lockId","KeepAlive$1","id","ttl","lock","item","useRoot","useSuspense","hasLock","timeoutId","render$1","HTMLElement","Portal$1","mount","wrapper","portal","useBoolean","body","Element","render","metadata","Suspense$1","childrenSuspended","Switch","Switch$1","Case","Default","Switch$2","Ternary$1","jsx","createDirective$1","Provider","register","COMPONENT_RE","SYMBOL_COLD_COMPONENT","SYMBOL_HOT_COMPONENT","SYMBOL_HOT_ID","SOURCES","hmr$1","accept","createHotComponent","path","source","createHotComponentDeep","hot","onAccept","module","default","console","cold","n","e","u","h","p","registry","html","components","html$1","lazy$1","fetcherOnce","called","preload","reject","renderToString$1","Portal","template$1","safePropertyRe","checkValidProperty","makeActionsWithNodesAndTemplate","actionsWithNodes","accessor","method","targetNode","makeAccessor","makeNodePath","prevPath","prevNode","parentNode","previousSibling","makeNodePathProperties","properties","parts","reverse","part","nsi","makeReviverVariables","actionsWithPaths","paths","action","nodePath","targetNodePath","makeReviverPaths","makeReviverVariablesData","assignments","variableId","datum","find","variable","assignment","otherCurrent","otherNext","splice","makeActionsWithPaths","reviver","actions","variables","makeReviverActions","Function","join","apis","makeReviver","clone","cloneNode","makeComponent","defaultValue","valueContext","ReactiveRoot","c","checked","onClick","TextInput","onEnter","promisifyRequest","oncomplete","onsuccess","onabort","onerror","createStore","dbName","storeName","indexedDB","open","onupgradeneeded","createObjectStore","dbp","txMode","db","transaction","objectStore","defaultGetStoreFunc","defaultGetStore","appendStyle","styleTag","head","newStyle","customElements","define","connectedCallback","display","disconnectedCallback","neptuneIdbStore","createIdbStore","createPersistentObject","persistentObject","customStore","put","idbSet","res","idbGet","Uint8Array","Uint16Array","buffer","parse","g","__heap_base","memory","byteLength","grow","ceil","sa","lastIndexOf","idx","k","ri","ie","ai","ss","se","ip","d","re","es","ee","els","ele","ls","le","ln","eval","f","WebAssembly","compile","Buffer","atob","instantiate","exports","betterParse","src","imports","imp","declaration","importClause","trim","namedImportOpener","namedImportCloser","namedImport","namedImports","commaIndex","namespace","isExport","destructurifyImp","v","removeFromString","string","start","end","insertIntoString","newString","urlImport","baseUrl","existingUrls","pluginStore","pluginStoreReady","enabled","getPluginById","disablePlugin","onUnload","togglePlugin","enablePlugin","plugin","runPlugin","persistentStorage","persistentStorageReady","pluginData","manifest","storage","Settings","code","config","plugins","moduleId","generatedImports","transform","offset","exp","startIndex","endIndex","newExport","fromIndex","quartzStore","random","substring","generatedImport","addImport","globalStoreID","mod","import","btoa","quartz","JSON","stringify","installPlugin","unshift","removePlugin","log","findIndex","del","fetchPluginFromURL","url","parsedURL","json","hash","main","text","author","description","reloadPlugin","pluginWasEnabled","hasOwnProperty","installPluginFromURL","message","messageError","update","querySelector","interceptors","intercept","types","cb","uninterceptors","unintercept","handleIntercept","observations","MutationObserver","records","changedElems","record","removedNodes","SVGElement","elem","obs","matches","querySelectorAll","startObserving","observe","subtree","childList","attributes","stopObserving","disconnect","sel","entry","unobs","now","pageNotFoundSelector","replacePage","page","neptunePage","insertAdjacentElement","registerRoute","payload","pathname","pageNotFound","unob","getElementsByClassName","getTabs","hookContextMenu","menuType","contextMenuItem","contextMenuLabel","innerText","parentClasses","contextMenuWrapper","keyCode","click","showModal","modal","showReleaseNotes","header","getElementsByTagName","replaceChildren","tab","color","windowObject","patcher","utils","registerTab","unobservers","addTab","tabs","remove","makeInactive","preventDefault","router","removeRouteHandler","voby","webpackObject","exfiltratedStore","patchedPush","patchedPrepareAction","getModulesFromWpRequire","wpRequire","fromEntries","m","loaded","window","val","patcher.before","arg","patcher.after","resp","found","possiblyPrepareAction","toUpperCase","builtAction","act","__proto__","dispatch","rej","orig","shouldDispatch","interceptor","parseManifest","importLocalPlugin","fileHandle","showOpenFilePicker","file","getFile","content","PluginCard","If","enabledPlugins","selectedTab","pluginToImport","TabButton","neptune","originalDefineProperty","freeze","delayHandler","unref","clearDelayHandler","getElementById","location","reload"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,111,113,114,115]}